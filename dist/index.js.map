{"version":3,"file":"index.js","sources":["../src/constants/ActionTypes.js","../src/state/_common/request.js","../src/state/App/selectors.js","../src/state/_common/helpers.js","../src/state/_common/selectors.js","../src/state/Areas/AreaTreeLevels/selectors.js","../src/state/Areas/AreaTrees/selectors.js","../src/state/Areas/selectors.js","../src/state/AreaRelations/selectors.js","../src/state/Attributes/selectors.js","../src/state/AttributeSets/selectors.js","../src/state/Cases/selectors.js","../src/state/Components/selectors.js","../src/state/_common/recomputeHelpers.js","../src/state/Data/AttributeRelations/selectors.js","../src/state/Data/AttributeDataSources/selectors.js","../src/state/Data/AttributeData/selectors.js","../src/state/Data/Components/selectors.js","../src/state/Data/SpatialRelations/selectors.js","../src/state/Data/SpatialDataSources/selectors.js","../src/state/Data/SpatialData/selectors.js","../src/state/Data/helpers.js","../src/state/Data/selectors.js","../src/state/LayerTemplates/selectors.js","../src/state/LayerTrees/selectors.js","../src/state/Maps/selectorHelpers.js","../src/state/Styles/selectors.js","../src/state/Selections/selectors.js","../src/state/Maps/selectors.js","../src/state/Periods/selectors.js","../src/state/Places/selectors.js","../src/state/Scenarios/selectors.js","../src/state/Scopes/selectors.js","../src/state/Screens/selectors.js","../src/state/Tags/selectors.js","../src/state/Users/selectors.js","../src/state/Views/selectors.js","../src/state/Windows/selectors.js","../src/state/Select.js","../src/state/_common/actions.js","../src/state/App/actions.js","../src/state/Areas/AreaTreeLevels/actions.js","../src/state/Areas/AreaTrees/actions.js","../src/state/Areas/actions.js","../src/state/AreaRelations/actions.js","../src/state/Attributes/actions.js","../src/state/AttributeSets/actions.js","../src/state/Cases/actions.js","../src/state/Components/actions.js","../src/state/Data/AttributeRelations/actions.js","../src/state/Data/AttributeDataSources/actions.js","../src/state/Data/AttributeData/actions.js","../src/state/Data/Components/helpers.js","../src/state/Data/Components/actions.js","../src/state/Data/SpatialRelations/actions.js","../src/state/Data/SpatialDataSources/actions.js","../src/state/Data/SpatialData/actions.js","../src/state/Data/constants.js","../src/state/Data/actions.js","../src/state/LayerTemplates/actions.js","../src/state/LayerTrees/actions.js","../src/state/Styles/actions.js","../src/state/Selections/actions.js","../src/state/Maps/actions.js","../src/state/Periods/actions.js","../src/state/Places/actions.js","../src/state/Scenarios/actions.js","../src/state/Scopes/actions.js","../src/state/Screens/actions.js","../src/state/Tags/actions.js","../src/state/Users/actions.js","../src/state/Views/actions.js","../src/state/Windows/actions.js","../src/state/Action.js","../src/components/AppContainer.js","../src/components/dataComponents/CartesianChart.js","../src/components/maps/Map.js","../src/components/maps/MapSet.js","../src/components/Screens.js","../src/components/User.js","../src/components/WindowsContainer.js","../src/components/connects.js","../src/components/MountWrapper.js","../src/state/_common/reducers.js","../src/state/_activeMetadata/constants.js","../src/state/_activeMetadata/actions.js","../src/state/App/reducers.js","../src/state/Areas/AreaTreeLevels/reducers.js","../src/state/Areas/AreaTrees/reducers.js","../src/state/Areas/reducers.js","../src/state/AreaRelations/reducers.js","../src/state/Attributes/reducers.js","../src/state/AttributeSets/reducers.js","../src/state/Cases/reducers.js","../src/state/Components/reducers.js","../src/state/Data/AttributeRelations/reducers.js","../src/state/Data/AttributeDataSources/reducers.js","../src/state/Data/AttributeData/reducers.js","../src/state/Data/Components/reducers.js","../src/state/Data/SpatialRelations/reducers.js","../src/state/Data/SpatialDataSources/reducers.js","../src/state/Data/SpatialData/reducers.js","../src/state/Data/reducers.js","../src/state/LayerTemplates/reducers.js","../src/state/LayerTrees/reducers.js","../src/state/Maps/reducers.js","../src/state/Periods/reducers.js","../src/state/Places/reducers.js","../src/state/Scenarios/reducers.js","../src/state/Scopes/reducers.js","../src/state/Screens/reducers.js","../src/state/Selections/reducers.js","../src/state/Styles/reducers.js","../src/state/Tags/reducers.js","../src/state/Users/reducers.js","../src/state/Views/reducers.js","../src/state/Windows/reducers.js","../src/index.js"],"sourcesContent":["import {utils} from '@gisatcz/ptr-utils';\n\nexport default utils.deepKeyMirror({\n\tAPP: {\n\t\tSET_KEY: null,\n\t\tSET_BASE_URL: null,\n\t\tSET_LOCAL_CONFIGURATION: null,\n\t\tUPDATE_LOCAL_CONFIGURATION: null,\n\t\tRECEIVE_CONFIGURATION: null,\n\t},\n\n\tAREAS: {\n\t\tAREA_TREE_LEVELS: {\n\t\t\tADD: null,\n\t\t\tADD_UNRECEIVED: null,\n\t\t\tENSURE: {\n\t\t\t\tERROR: null,\n\t\t\t},\n\t\t\tINDEX: {\n\t\t\t\tADD: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t},\n\t\t\tLOAD: {\n\t\t\t\tERROR: null,\n\t\t\t\tREQUEST: null,\n\t\t\t},\n\t\t\tSET_ACTIVE_KEY: null,\n\t\t\tUSE: {\n\t\t\t\tINDEXED: {\n\t\t\t\t\tCLEAR: null,\n\t\t\t\t\tREGISTER: null,\n\t\t\t\t},\n\t\t\t\tKEYS: {\n\t\t\t\t\tCLEAR: null,\n\t\t\t\t\tREGISTER: null,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tAREA_TREES: {\n\t\t\tADD: null,\n\t\t\tADD_UNRECEIVED: null,\n\t\t\tENSURE: {\n\t\t\t\tERROR: null,\n\t\t\t},\n\t\t\tINDEX: {\n\t\t\t\tADD: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t},\n\t\t\tLOAD: {\n\t\t\t\tERROR: null,\n\t\t\t\tREQUEST: null,\n\t\t\t},\n\t\t\tSET_ACTIVE_KEY: null,\n\t\t\tUSE: {\n\t\t\t\tINDEXED: {\n\t\t\t\t\tCLEAR: null,\n\t\t\t\t\tREGISTER: null,\n\t\t\t\t},\n\t\t\t\tKEYS: {\n\t\t\t\t\tCLEAR: null,\n\t\t\t\t\tREGISTER: null,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t},\n\n\tAREA_RELATIONS: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tENSURE: {\n\t\t\tERROR: null,\n\t\t},\n\t\tINDEX: {\n\t\t\tADD: null,\n\t\t\tCLEAR_ALL: null,\n\t\t},\n\t\tUSE: {\n\t\t\tINDEXED: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t},\n\t},\n\n\tATTRIBUTES: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tDELETE: null,\n\t\tMARK_DELETED: null,\n\t\tEDITED: {\n\t\t\tREMOVE: null,\n\t\t\tREMOVE_ACTIVE: null,\n\t\t\tREMOVE_PROPERTY: null,\n\t\t\tUPDATE: null,\n\t\t},\n\t\tENSURE: {\n\t\t\tERROR: null,\n\t\t},\n\t\tINDEX: {\n\t\t\tADD: null,\n\t\t\tCLEAR_ALL: null,\n\t\t\tCLEAR_INDEX: null,\n\t\t},\n\t\tLOAD: {\n\t\t\tERROR: null,\n\t\t\tREQUEST: null,\n\t\t},\n\t\tSET_ACTIVE_KEY: null,\n\t\tSET_ACTIVE_KEYS: null,\n\t\tUPDATE_STORE: null,\n\t\tUSE: {\n\t\t\tINDEXED: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tKEYS: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t},\n\t},\n\n\tATTRIBUTE_SETS: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tDELETE: null,\n\t\tMARK_DELETED: null,\n\t\tEDITED: {\n\t\t\tREMOVE: null,\n\t\t\tREMOVE_ACTIVE: null,\n\t\t\tREMOVE_PROPERTY: null,\n\t\t\tUPDATE: null,\n\t\t},\n\t\tENSURE: {\n\t\t\tERROR: null,\n\t\t},\n\t\tINDEX: {\n\t\t\tADD: null,\n\t\t\tCLEAR_ALL: null,\n\t\t\tCLEAR_INDEX: null,\n\t\t},\n\t\tLOAD: {\n\t\t\tERROR: null,\n\t\t\tREQUEST: null,\n\t\t},\n\t\tSET_ACTIVE_KEY: null,\n\t\tSET_ACTIVE_KEYS: null,\n\t\tUPDATE_STORE: null,\n\t\tUSE: {\n\t\t\tINDEXED: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tKEYS: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t},\n\t},\n\n\tCASES: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tDELETE: null,\n\t\tMARK_DELETED: null,\n\t\tEDITED: {\n\t\t\tREMOVE: null,\n\t\t\tREMOVE_ACTIVE: null,\n\t\t\tREMOVE_PROPERTY: null,\n\t\t\tUPDATE: null,\n\t\t},\n\t\tENSURE: {\n\t\t\tERROR: null,\n\t\t},\n\t\tINDEX: {\n\t\t\tADD: null,\n\t\t\tCLEAR_ALL: null,\n\t\t\tCLEAR_INDEX: null,\n\t\t},\n\t\tLOAD: {\n\t\t\tERROR: null,\n\t\t\tREQUEST: null,\n\t\t},\n\t\tSET_ACTIVE_KEY: null,\n\t\tSET_ACTIVE_KEYS: null,\n\t\tUPDATE_STORE: null,\n\t\tUSE: {\n\t\t\tINDEXED: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tKEYS: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t},\n\t},\n\n\tCOMMON: {\n\t\tDATA: {\n\t\t\tCLEANUP_ON_LOGOUT: null,\n\t\t\tSET_OUTDATED: null,\n\t\t},\n\t\tEDITED: {\n\t\t\tREMOVE_PROPERTY_VALUES: null,\n\t\t},\n\t},\n\n\tCOMPONENTS: {\n\t\tSET: null,\n\t\tUPDATE: null,\n\t\tUPDATE_STORE: null,\n\t},\n\n\tDATA: {\n\t\tATTRIBUTE_DATA: {\n\t\t\tADD: null,\n\t\t\tADD_WITH_INDEX: null,\n\t\t\tADD_WITH_SPATIAL_INDEX: null,\n\t\t\tUPDATE: null,\n\t\t\tUPDATE_STORE: null,\n\t\t\tINDEX: {\n\t\t\t\tADD: null,\n\t\t\t\tREMOVE: null,\n\t\t\t},\n\t\t\tSPATIAL_INDEX: {\n\t\t\t\tADD: null,\n\t\t\t\tREMOVE: null,\n\t\t\t},\n\t\t},\n\t\tATTRIBUTE_DATA_SOURCES: {\n\t\t\tADD: null,\n\t\t\tUPDATE_STORE: null,\n\t\t\tINDEX: {\n\t\t\t\tADD: null,\n\t\t\t},\n\t\t},\n\t\tATTRIBUTE_RELATIONS: {\n\t\t\tADD: null,\n\t\t\tUPDATE_STORE: null,\n\t\t\tINDEX: {\n\t\t\t\tADD: null,\n\t\t\t},\n\t\t},\n\t\tCOMPONENTS: {\n\t\t\tCOMPONENT: {\n\t\t\t\tSET: {\n\t\t\t\t\tATTRIBUTE_KEYS: null,\n\t\t\t\t},\n\t\t\t\tUSE: {\n\t\t\t\t\tCLEAR: null,\n\t\t\t\t\tREGISTER: null,\n\t\t\t\t},\n\t\t\t},\n\t\t\tADD_COMPONENTS: null,\n\t\t},\n\t\tSPATIAL_DATA: {\n\t\t\tADD: null,\n\t\t\tADD_WITH_INDEX: null,\n\t\t\tINDEX: {\n\t\t\t\tADD: null,\n\t\t\t\tREMOVE: null,\n\t\t\t},\n\t\t},\n\t\tSPATIAL_DATA_SOURCES: {\n\t\t\tADD: null,\n\t\t\tINDEX: {\n\t\t\t\tADD: null,\n\t\t\t},\n\t\t},\n\t\tSPATIAL_RELATIONS: {\n\t\t\tADD: null,\n\t\t\tINDEX: {\n\t\t\t\tADD: null,\n\t\t\t},\n\t\t},\n\t\tUPDATE: null,\n\t},\n\n\tLAYER_TEMPLATES: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tDELETE: null,\n\t\tMARK_DELETED: null,\n\t\tEDITED: {\n\t\t\tREMOVE: null,\n\t\t\tREMOVE_ACTIVE: null,\n\t\t\tREMOVE_PROPERTY: null,\n\t\t\tUPDATE: null,\n\t\t},\n\t\tENSURE: {\n\t\t\tERROR: null,\n\t\t},\n\t\tINDEX: {\n\t\t\tADD: null,\n\t\t\tCLEAR_INDEX: null,\n\t\t\tCLEAR_ALL: null,\n\t\t},\n\t\tLOAD: {\n\t\t\tERROR: null,\n\t\t\tREQUEST: null,\n\t\t},\n\t\tSET_ACTIVE_KEY: null,\n\t\tSET_ACTIVE_KEYS: null,\n\t\tUPDATE_STORE: null,\n\t\tUSE: {\n\t\t\tINDEXED: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tKEYS: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t},\n\t},\n\n\tLAYER_TREES: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tDELETE: null,\n\t\tMARK_DELETED: null,\n\t\tEDITED: {\n\t\t\tREMOVE: null,\n\t\t\tREMOVE_PROPERTY: null,\n\t\t\tUPDATE: null,\n\t\t},\n\t\tENSURE: {\n\t\t\tERROR: null,\n\t\t},\n\t\tINDEX: {\n\t\t\tADD: null,\n\t\t\tCLEAR_INDEX: null,\n\t\t\tCLEAR_ALL: null,\n\t\t},\n\t\tLOAD: {\n\t\t\tERROR: null,\n\t\t\tREQUEST: null,\n\t\t},\n\t\tUPDATE_STORE: null,\n\t\tUSE: {\n\t\t\tINDEXED: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tKEYS: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t},\n\t},\n\n\tMAPS: {\n\t\tSET: {\n\t\t\tREMOVE_MAP: null,\n\t\t\tSET_ACTIVE_MAP_KEY: null,\n\t\t\tSET_BACKGROUND_LAYER: null,\n\t\t\tSET_LAYERS: null,\n\t\t\tUSE: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tVIEW: {\n\t\t\t\tSET: null,\n\t\t\t\tUPDATE: null,\n\t\t\t},\n\t\t},\n\t\tMAP: {\n\t\t\tLAYERS: {\n\t\t\t\tADD: null,\n\t\t\t\tADD_TO_INDEX: null,\n\t\t\t\tREMOVE_LAYER: null,\n\t\t\t\tSET_OPTION: null,\n\t\t\t\tSET_RENDER_AS: null,\n\t\t\t\tSET_STYLE: null,\n\t\t\t\tSET_STYLE_KEY: null,\n\t\t\t},\n\t\t\tSET_BACKGROUND_LAYER: null,\n\t\t\tUSE: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tVIEWPORT: {\n\t\t\t\tSET: null,\n\t\t\t},\n\t\t\tVIEW: {\n\t\t\t\tSET: null,\n\t\t\t\tUPDATE: null,\n\t\t\t},\n\t\t},\n\t\tSET_ACTIVE_MAP_KEY: null,\n\t\tUPDATE: null,\n\t},\n\n\tPERIODS: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tDELETE: null,\n\t\tMARK_DELETED: null,\n\t\tEDITED: {\n\t\t\tREMOVE: null,\n\t\t\tREMOVE_ACTIVE: null,\n\t\t\tREMOVE_PROPERTY: null,\n\t\t\tUPDATE: null,\n\t\t},\n\t\tENSURE: {\n\t\t\tERROR: null,\n\t\t},\n\t\tINDEX: {\n\t\t\tADD: null,\n\t\t\tCLEAR_ALL: null,\n\t\t\tCLEAR_INDEX: null,\n\t\t},\n\t\tLOAD: {\n\t\t\tERROR: null,\n\t\t\tREQUEST: null,\n\t\t},\n\t\tSET_ACTIVE_KEY: null,\n\t\tSET_ACTIVE_KEYS: null,\n\t\tUPDATE_STORE: null,\n\t\tUSE: {\n\t\t\tINDEXED: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tKEYS: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t},\n\t},\n\n\tPLACES: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tDELETE: null,\n\t\tMARK_DELETED: null,\n\t\tEDITED: {\n\t\t\tREMOVE: null,\n\t\t\tREMOVE_ACTIVE: null,\n\t\t\tREMOVE_PROPERTY: null,\n\t\t\tUPDATE: null,\n\t\t},\n\t\tENSURE: {\n\t\t\tERROR: null,\n\t\t},\n\t\tINDEX: {\n\t\t\tADD: null,\n\t\t\tCLEAR_INDEX: null,\n\t\t\tCLEAR_ALL: null,\n\t\t},\n\t\tLOAD: {\n\t\t\tERROR: null,\n\t\t\tREQUEST: null,\n\t\t},\n\t\tSET_ACTIVE_KEY: null,\n\t\tSET_ACTIVE_KEYS: null,\n\t\tUPDATE_STORE: null,\n\t\tUSE: {\n\t\t\tINDEXED: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tKEYS: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t},\n\t},\n\n\tSCENARIOS: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tDELETE: null,\n\t\tMARK_DELETED: null,\n\t\tEDITED: {\n\t\t\tREMOVE: null,\n\t\t\tREMOVE_ACTIVE: null,\n\t\t\tREMOVE_PROPERTY: null,\n\t\t\tUPDATE: null,\n\t\t},\n\t\tENSURE: {\n\t\t\tERROR: null,\n\t\t},\n\t\tINDEX: {\n\t\t\tADD: null,\n\t\t\tCLEAR_INDEX: null,\n\t\t\tCLEAR_ALL: null,\n\t\t},\n\t\tLOAD: {\n\t\t\tERROR: null,\n\t\t\tREQUEST: null,\n\t\t},\n\t\tSET_ACTIVE_KEY: null,\n\t\tSET_ACTIVE_KEYS: null,\n\t\tUPDATE_STORE: null,\n\t\tUSE: {\n\t\t\tINDEXED: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tKEYS: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t},\n\t},\n\n\tSCOPES: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tDELETE: null,\n\t\tMARK_DELETED: null,\n\t\tEDITED: {\n\t\t\tREMOVE: null,\n\t\t\tREMOVE_ACTIVE: null,\n\t\t\tREMOVE_PROPERTY: null,\n\t\t\tUPDATE: null,\n\t\t},\n\t\tENSURE: {\n\t\t\tERROR: null,\n\t\t},\n\t\tINDEX: {\n\t\t\tADD: null,\n\t\t\tCLEAR_INDEX: null,\n\t\t\tCLEAR_ALL: null,\n\t\t},\n\t\tLOAD: {\n\t\t\tERROR: null,\n\t\t\tREQUEST: null,\n\t\t},\n\t\tSET_ACTIVE_KEY: null,\n\t\tUPDATE_STORE: null,\n\t\tUSE: {\n\t\t\tINDEXED: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tKEYS: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t},\n\t},\n\n\tSCREENS: {\n\t\tADD: null,\n\t\tCLOSE: null,\n\t\tOPEN: null,\n\t\tREMOVE: null,\n\t\tREMOVE_ALL: null,\n\t\tRETRACT: null,\n\t\tSETS: {\n\t\t\tADD: null,\n\t\t\tREMOVE: null,\n\t\t},\n\t\tTOP_HISTORY: null,\n\t\tUPDATE: null,\n\t},\n\n\tSELECTIONS: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tSET_ACTIVE_KEY: null,\n\t\tSET: {\n\t\t\tFEATURE_KEYS_FILTER: {\n\t\t\t\tKEYS: null,\n\t\t\t},\n\t\t},\n\t\tCLEAR: {\n\t\t\tFEATURE_KEYS_FILTER: null,\n\t\t},\n\t},\n\n\tSTYLES: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tDELETE: null,\n\t\tMARK_DELETED: null,\n\t\tEDITED: {\n\t\t\tREMOVE: null,\n\t\t\tREMOVE_ACTIVE: null,\n\t\t\tREMOVE_PROPERTY: null,\n\t\t\tUPDATE: null,\n\t\t},\n\t\tENSURE: {\n\t\t\tERROR: null,\n\t\t},\n\t\tINDEX: {\n\t\t\tADD: null,\n\t\t\tCLEAR_INDEX: null,\n\t\t\tCLEAR_ALL: null,\n\t\t},\n\t\tLOAD: {\n\t\t\tERROR: null,\n\t\t\tREQUEST: null,\n\t\t},\n\t\tSET_ACTIVE_KEY: null,\n\t\tSET_ACTIVE_KEYS: null,\n\t\tUPDATE_STORE: null,\n\t\tUSE: {\n\t\t\tINDEXED: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tKEYS: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t},\n\t},\n\n\tTAGS: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tDELETE: null,\n\t\tMARK_DELETED: null,\n\t\tEDITED: {\n\t\t\tREMOVE: null,\n\t\t\tREMOVE_ACTIVE: null,\n\t\t\tREMOVE_PROPERTY: null,\n\t\t\tUPDATE: null,\n\t\t},\n\t\tENSURE: {\n\t\t\tERROR: null,\n\t\t},\n\t\tINDEX: {\n\t\t\tADD: null,\n\t\t\tCLEAR_INDEX: null,\n\t\t\tCLEAR_ALL: null,\n\t\t},\n\t\tLOAD: {\n\t\t\tERROR: null,\n\t\t\tREQUEST: null,\n\t\t},\n\t\tSET_ACTIVE_KEY: null,\n\t\tSET_ACTIVE_KEYS: null,\n\t\tUPDATE_STORE: null,\n\t\tUSE: {\n\t\t\tINDEXED: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tKEYS: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t},\n\t},\n\n\tUSERS: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tGROUPS: {\n\t\t\tADD: null,\n\t\t\tADD_UNRECEIVED: null,\n\t\t\tINDEX: {\n\t\t\t\tADD: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t},\n\t\t\tUSE: {\n\t\t\t\tINDEXED: {\n\t\t\t\t\tCLEAR: null,\n\t\t\t\t\tREGISTER: null,\n\t\t\t\t},\n\t\t\t\tKEYS: {\n\t\t\t\t\tCLEAR: null,\n\t\t\t\t\tREGISTER: null,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tSET_ACTIVE_KEY: null,\n\t\tCURRENT: {\n\t\t\tREQUEST: null,\n\t\t},\n\t\tLOGIN: {\n\t\t\tREQUEST: null,\n\t\t},\n\t\tINDEX: {\n\t\t\tADD: null,\n\t\t\tCLEAR_ALL: null,\n\t\t},\n\t\tUSE: {\n\t\t\tINDEXED: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tKEYS: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t},\n\t},\n\n\tVIEWS: {\n\t\tADD: null,\n\t\tADD_UNRECEIVED: null,\n\t\tDELETE: null,\n\t\tMARK_DELETED: null,\n\t\tEDITED: {\n\t\t\tREMOVE: null,\n\t\t\tREMOVE_ACTIVE: null,\n\t\t\tREMOVE_PROPERTY: null,\n\t\t\tUPDATE: null,\n\t\t},\n\t\tENSURE: {\n\t\t\tERROR: null,\n\t\t},\n\t\tINDEX: {\n\t\t\tADD: null,\n\t\t\tCLEAR_INDEX: null,\n\t\t\tCLEAR_ALL: null,\n\t\t},\n\t\tLOAD: {\n\t\t\tERROR: null,\n\t\t\tREQUEST: null,\n\t\t},\n\t\tSET_ACTIVE_KEY: null,\n\t\tUPDATE_STORE: null,\n\t\tUSE: {\n\t\t\tINDEXED: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tCLEAR_ALL: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t\tKEYS: {\n\t\t\t\tCLEAR: null,\n\t\t\t\tREGISTER: null,\n\t\t\t},\n\t\t},\n\t},\n\n\tWINDOWS: {\n\t\tADD: null,\n\t\tOPEN: null,\n\t\tREMOVE: null,\n\t\tSETS: {\n\t\t\tADD: null,\n\t\t\tREMOVE: null,\n\t\t},\n\t\tTOP: null,\n\t\tUPDATE: null,\n\t},\n});\n","import _ from 'lodash';\nimport _fetch from 'isomorphic-fetch';\nimport path from 'path';\nimport queryString from 'query-string';\n\nconst TTL = 5;\nconst DATAPATH = 'data';\n\n/**\n * Fetch implementation used by this module.\n *\n * It can be useful in tests to override this using `setFetch` fn.\n */\nlet fetch = _fetch;\n\n/**\n * Set different fetch implementation. Useful in tests.\n */\nexport function setFetch(_fetch) {\n\tfetch = _fetch;\n}\n\n/**\n * Reset fetch implementation to default one.\n */\nexport function resetFetch() {\n\tfetch = _fetch;\n}\n\n/**\n * Request helper. Creates an request to backend.\n * @param localConfig\n * @param apiPath - path to backend endpoint (hostname taken from config)\n * @param method - HTTP method\n * @param query - url query as object\n * @param payload - payload as object\n * @param ttl - (optional) number of tries\n * @param dataPath - (optional) [default: \"data\"] Path where should data be. If response object does not have data on \"dataPath\", then return Error.\n * @returns response or error\n */\nexport default function request(\n\tlocalConfig,\n\tapiPath,\n\tmethod,\n\tquery,\n\tpayload,\n\tttl,\n\tdataPath\n) {\n\tif (_.isUndefined(ttl)) ttl = TTL;\n\tif (_.isUndefined(dataPath)) dataPath = DATAPATH;\n\tlet url =\n\t\tlocalConfig.apiBackendProtocol +\n\t\t'://' +\n\t\tpath.join(localConfig.apiBackendHost, localConfig.apiBackendPath, apiPath);\n\tif (query) {\n\t\turl += '?' + queryString.stringify(query);\n\t}\n\n\treturn fetch(url, {\n\t\tmethod: method,\n\t\tcredentials: 'include',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tAccept: 'application/json',\n\t\t},\n\t\tbody: payload ? JSON.stringify(payload) : null,\n\t}).then(\n\t\tresponse => {\n\t\t\tlet contentType = response.headers.get('Content-type');\n\t\t\tif (\n\t\t\t\tresponse.ok &&\n\t\t\t\tcontentType &&\n\t\t\t\tcontentType.indexOf('application/json') !== -1\n\t\t\t) {\n\t\t\t\treturn response.json().then(body => {\n\t\t\t\t\tif (dataPath === null || (dataPath && _.get(body, dataPath))) {\n\t\t\t\t\t\treturn body;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error('no data returned');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthrow new Error('response error');\n\t\t\t}\n\t\t},\n\t\terror => {\n\t\t\tif (ttl - 1) {\n\t\t\t\trequest(localConfig, apiPath, method, query, payload, ttl - 1);\n\t\t\t} else {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\t);\n}\n","import {createSelector} from 'reselect';\nimport _ from 'lodash';\n\nimport {createObserver as createRecomputeObserver} from '@jvitela/recompute';\n\nconst getKey = state => state.app.key;\nconst getCompleteConfiguration = state => state.app.configuration;\nconst getCompleteLocalConfiguration = state => state.app?.localConfiguration;\n\nconst getCompleteLocalConfigurationObserver = createRecomputeObserver(\n\tgetCompleteLocalConfiguration\n);\n\nconst getConfiguration = createSelector(\n\t[getCompleteConfiguration, (state, path) => path],\n\t(configuration, path) => _.get(configuration, path, null)\n);\n\nconst getLocalConfiguration = createSelector(\n\t[getCompleteLocalConfiguration, (state, path) => path],\n\t(localConfiguration, path) => _.get(localConfiguration, path, null)\n);\n\nexport default {\n\tgetKey,\n\tgetConfiguration,\n\tgetCompleteConfiguration,\n\tgetLocalConfiguration,\n\tgetCompleteLocalConfiguration,\n\tgetCompleteLocalConfigurationObserver,\n};\n","import createCachedSelector from 're-reselect';\nimport {\n\tfind as _find,\n\thead as _head,\n\tisEqual as _isEqual,\n\tisEmpty as _isEmpty,\n\tisNumber as _isNumber,\n\tisObject as _isObject,\n\treduce as _reduce,\n\tsortBy as _sortBy,\n\ttail as _tail,\n} from 'lodash';\n\n/**\n * Return index for given filter and order\n * @param indexes {Array} list of indexes\n * @param filter {Object}\n * @param order {Array}\n */\nconst getIndex = createCachedSelector(\n\t[\n\t\tindexes => indexes,\n\t\t(indexes, filter) => filter,\n\t\t(indexes, filter, order) => order,\n\t],\n\t(indexes, filter, order) => {\n\t\tif (indexes) {\n\t\t\tconst index = _find(indexes, index =>\n\t\t\t\tisCorrespondingIndex(index, filter, order)\n\t\t\t);\n\t\t\treturn index ? index : null;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n)((indexes, filter, order) => {\n\treturn `${JSON.stringify(filter)}${JSON.stringify(order)}`;\n});\n\n/**\n * Remove duplicate indexes from given indexes. Returns new Array.\n * @param {Array} indexes Array of indexes where can index duplicate.\n * @returns {Array} unique indexes\n */\nfunction getUniqueIndexes(indexes) {\n\tif (!_isEmpty(indexes)) {\n\t\treturn indexes.reduce((uniqueIndexes, index) => {\n\t\t\tif (\n\t\t\t\t_find(\n\t\t\t\t\tuniqueIndexes,\n\t\t\t\t\ti => i && isCorrespondingIndex(index, i.filter, i.order)\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn uniqueIndexes;\n\t\t\t}\n\n\t\t\treturn [...uniqueIndexes, index];\n\t\t}, []);\n\t} else {\n\t\treturn null;\n\t}\n}\n\n/**\n * Remove index from given indexes that fit to filter and order.\n * If index does not exists under filter, same instance of indexes has return.\n * @param indexes {Array} Array of indexes\n * @param filter {Object}\n * @param order {Array}\n * @return {Array} New instance of indexes\n */\nfunction removeIndex(indexes = [], filter, order) {\n\tif (indexes && !_isEmpty(indexes)) {\n\t\tconst clearedIndexes = _reduce(\n\t\t\tindexes,\n\t\t\t(acc, index) => {\n\t\t\t\tconst indexToBeCleared = isCorrespondingIndex(index, filter, order);\n\t\t\t\tif (indexToBeCleared) {\n\t\t\t\t\treturn acc;\n\t\t\t\t} else {\n\t\t\t\t\treturn [...acc, index];\n\t\t\t\t}\n\t\t\t},\n\t\t\t[]\n\t\t);\n\n\t\tif (clearedIndexes.length === indexes.length) {\n\t\t\treturn indexes;\n\t\t} else {\n\t\t\treturn clearedIndexes;\n\t\t}\n\t} else {\n\t\treturn indexes;\n\t}\n}\n\n/**\n * Create set of updated indexes state based on current state and given indexUpdate.\n * It produce updated indexes state in case of existing index for given filter and order.\n * If index with filter and order is not in the state yet, its add to indexes state.\n * @param state {Object}\n * @param filter {Object}\n * @param order {Array}\n * @param indexUpdate {Array}\n * @param changedOn {string}\n * @param indexesPath {string} name of a property where indexes are stored\n */\nfunction getUpdatedIndexes(\n\tstate,\n\tfilter,\n\torder,\n\tindexUpdate,\n\tchangedOn,\n\tindexesPath = 'indexes'\n) {\n\tlet indexes = [];\n\tlet selectedIndex = {};\n\n\tif (state[indexesPath]) {\n\t\tstate[indexesPath].forEach(index => {\n\t\t\tif (_isEqual(index.filter, filter) && _isEqual(index.order, order)) {\n\t\t\t\tselectedIndex = index;\n\t\t\t} else {\n\t\t\t\tindexes.push(index);\n\t\t\t}\n\t\t});\n\t}\n\n\tlet index;\n\tif (indexUpdate.length) {\n\t\tindex = {...selectedIndex.index};\n\t\tindexUpdate.forEach((model, i) => {\n\t\t\tif (model.key) {\n\t\t\t\tindex[i] = model.key;\n\t\t\t} else {\n\t\t\t\t//spatial data by spatialDataSourceKey, levels and tiles\n\t\t\t\t//update spatialDataSourceKey\n\t\t\t\tfor (const [level, dataByTiles] of Object.entries(model)) {\n\t\t\t\t\tif (index.hasOwnProperty(level) && index[level]) {\n\t\t\t\t\t\t//update data on level\n\t\t\t\t\t\tindex[level] = {...index[level], ...dataByTiles};\n\t\t\t\t\t} else {\n\t\t\t\t\t\tindex[level] = {...dataByTiles};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tselectedIndex = {\n\t\tfilter: selectedIndex.filter || filter,\n\t\torder: selectedIndex.order || order,\n\t\tchangedOn: changedOn,\n\t\tindex: index || selectedIndex.index,\n\t};\n\tindexes.push(selectedIndex);\n\n\treturn indexes;\n}\n\n/**\n * Extend object \"currentByDataSourceKey\" by \"update\". Return new instance.\n * @param {Object} currentByDataSourceKey\n * @param {Object} update\n * @return {Object}\n */\nfunction getUpdatedByDataSourceKey(currentByDataSourceKey, update = {}) {\n\tlet updated = {...currentByDataSourceKey};\n\tfor (const [key, values] of Object.entries(update)) {\n\t\tif (updated.hasOwnProperty(key)) {\n\t\t\tupdated = {\n\t\t\t\t...updated,\n\t\t\t\t[key]: {\n\t\t\t\t\t...updated[key],\n\t\t\t\t\t...values,\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\tupdated = {\n\t\t\t\t...updated,\n\t\t\t\t[key]: {\n\t\t\t\t\t...values,\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\t}\n\treturn updated;\n}\n\n/**\n * True, if index.filter object and index.order array are deeply equal to given filter and order\n * @param index {Object} existing index\n * @param index.filter {Object}\n * @param index.order {Array}\n * @param filter {Object}\n * @param order {Array}\n * @return {boolean}\n */\nfunction isCorrespondingIndex(index, filter, order) {\n\treturn (\n\t\t_isEqual(index.filter || null, filter || null) &&\n\t\t_isEqual(index.order || null, order || null)\n\t);\n}\n\n/**\n * Check if filter fits given filter.\n * Not tested now.\n * Needs farther discusion. It will not be possible test item on complicated geometry filter.\n * @param {*} filter\n * @param {*} item\n * @returns {Boolean}\n */\nfunction itemFitFilter(filter, item) {\n\t// null filter fit\n\tif (filter === null) {\n\t\treturn true;\n\t}\n\n\tconst entries = Object.entries(filter);\n\n\treturn entries.every(([key, value]) => {\n\t\tconst itemHasFilterKey = item.data && item.data.hasOwnProperty(key);\n\t\tconst itemHasFilterLinkKey =\n\t\t\titem.data && item.data.hasOwnProperty(`${key}Key`);\n\t\tif (itemHasFilterKey) {\n\t\t\t//apply condition\n\t\t\t//\"column0\": \"hleda se rovnost\",\n\t\t\t//\"column1\": null,\n\t\t\tif (item.data && item.data[key] === value) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// \"column2\": {\n\t\t\t// \t\"like\": \"hleda se podobnost, castecny vyskyt\"\n\t\t\t// },\n\t\t\tif (_isObject(value) && value['like']) {\n\t\t\t\t//now we dont deal like filter, refrest indexes\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// \"column3\": {\n\t\t\t// \t\"in\": [\"existuje\", \"v\", \"poli\", \"prvku\"]\n\t\t\t// },\n\t\t\tif (_isObject(value) && value['in']) {\n\t\t\t\treturn value.in.includes(item.data[key]);\n\t\t\t}\n\n\t\t\t// \"column4\": {\n\t\t\t// \t\"notin\": [\"neexistuje\", \"v\", \"poli\", \"prvku\"]\n\t\t\t// }\n\t\t\tif (_isObject(value) && value['notin']) {\n\t\t\t\treturn !value.notin.includes(item.data[key]);\n\t\t\t}\n\t\t}\n\n\t\t//check if filter contains linking like scopeKey, viewKey, ...\n\t\tif (itemHasFilterLinkKey) {\n\t\t\tif (item.data && item.data[`${key}Key`] === value) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\t//if to filter fit return false\n\t\treturn false;\n\t});\n}\n\n/**\n * Merge stores active keys with filter by active and filter\n * @param activeKeys {Object} {activeScopeKey: 'bbb', activePlaceKeys: ['ddd', 'eee'], ...}\n * @param filterByActive {Object} {scope: true, place: true, ...}\n * @param filter {Object} {scopeKey: 'aaa', placeKey: {in: ['fff']}, ...}\n * @return {Object} merged object which looks like this {scopeKey: 'aaa', placeKey: {in: ['bbb', 'ccc']}, ...}\n */\nfunction mergeFilters(activeKeys, filterByActive, filter) {\n\tif (activeKeys && filterByActive) {\n\t\tlet activeKeysFilter = {};\n\t\tif (filterByActive.application) {\n\t\t\tif (activeKeys.activeApplicationKey) {\n\t\t\t\tactiveKeysFilter.applicationKey = activeKeys.activeApplicationKey;\n\t\t\t}\n\t\t}\n\t\tif (filterByActive.case) {\n\t\t\tif (activeKeys.activeCaseKey) {\n\t\t\t\tactiveKeysFilter.caseKey = activeKeys.activeCaseKey;\n\t\t\t} else if (activeKeys.activeCaseKeys) {\n\t\t\t\tactiveKeysFilter.caseKey = {in: activeKeys.activeCaseKeys};\n\t\t\t}\n\t\t}\n\t\tif (filterByActive.scope) {\n\t\t\tif (activeKeys.activeScopeKey) {\n\t\t\t\tactiveKeysFilter.scopeKey = activeKeys.activeScopeKey;\n\t\t\t}\n\t\t}\n\t\tif (filterByActive.scenario) {\n\t\t\tif (activeKeys.activeScenarioKey) {\n\t\t\t\tactiveKeysFilter.scenarioKey = activeKeys.activeScenarioKey;\n\t\t\t} else if (activeKeys.activeScenarioKeys) {\n\t\t\t\tactiveKeysFilter.scenarioKey = {in: activeKeys.activeScenarioKeys};\n\t\t\t}\n\t\t}\n\t\tif (filterByActive.place) {\n\t\t\tif (activeKeys.activePlaceKey) {\n\t\t\t\tactiveKeysFilter.placeKey = activeKeys.activePlaceKey;\n\t\t\t} else if (activeKeys.activePlaceKeys) {\n\t\t\t\tactiveKeysFilter.placeKey = {in: activeKeys.activePlaceKeys};\n\t\t\t}\n\t\t}\n\t\tif (filterByActive.period) {\n\t\t\tif (activeKeys.activePeriodKey) {\n\t\t\t\tactiveKeysFilter.periodKey = activeKeys.activePeriodKey;\n\t\t\t} else if (activeKeys.activePeriodKeys) {\n\t\t\t\tactiveKeysFilter.periodKey = {in: activeKeys.activePeriodKeys};\n\t\t\t}\n\t\t}\n\t\tif (filterByActive.attribute) {\n\t\t\tif (activeKeys.activeAttributeKey) {\n\t\t\t\tactiveKeysFilter.attributeKey = activeKeys.activeAttributeKey;\n\t\t\t} else if (activeKeys.activeAttributeKeys) {\n\t\t\t\tactiveKeysFilter.attributeKey = {in: activeKeys.activeAttributeKeys};\n\t\t\t}\n\t\t}\n\t\tif (filterByActive.layerTemplate) {\n\t\t\tif (activeKeys.activeLayerTemplateKey) {\n\t\t\t\tactiveKeysFilter.layerTemplateKey = activeKeys.activeLayerTemplateKey;\n\t\t\t}\n\t\t}\n\t\tif (filterByActive.areaTreeLevel) {\n\t\t\tif (activeKeys.activeAreaTreeLevelKey) {\n\t\t\t\tactiveKeysFilter.areaTreeLevelKey = activeKeys.activeAreaTreeLevelKey;\n\t\t\t}\n\t\t}\n\n\t\tconst finalFilter = {...activeKeysFilter, ...filter};\n\t\treturn _isEmpty(finalFilter) ? null : finalFilter;\n\t} else {\n\t\treturn filter;\n\t}\n}\n\n/**\n * Merge metadata defined by key with metadata keys defined by filterByActive\n * @param definedKeys {Object}\n * @param activeKeys {Object}\n * @return {Object|null}\n */\nfunction mergeMetadataKeys(definedKeys, activeKeys) {\n\tif (definedKeys && activeKeys) {\n\t\treturn {...activeKeys, ...definedKeys};\n\t} else {\n\t\treturn definedKeys || activeKeys || null;\n\t}\n}\n\n/**\n * It converts modifiers from metadataKeys: [\"A\", \"B\"] to metadataKey: {in: [\"A\", \"B\"]}\n * @param modifiers {Object}\n * @return {Object|null}\n */\nfunction convertModifiersToRequestFriendlyFormat(modifiers) {\n\tif (modifiers) {\n\t\tlet modifiersForRequest = {};\n\t\tif (modifiers.scopeKey) {\n\t\t\tmodifiersForRequest.scopeKey = modifiers.scopeKey;\n\t\t}\n\n\t\tif (modifiers.placeKeys) {\n\t\t\tmodifiersForRequest.placeKey = {in: modifiers.placeKeys};\n\t\t} else if (modifiers.placeKey) {\n\t\t\tmodifiersForRequest.placeKey = modifiers.placeKey;\n\t\t}\n\n\t\tif (modifiers.caseKeys) {\n\t\t\tmodifiersForRequest.caseKey = {in: modifiers.caseKeys};\n\t\t} else if (modifiers.caseKey) {\n\t\t\tmodifiersForRequest.caseKey = modifiers.caseKey;\n\t\t}\n\n\t\tif (modifiers.scenarioKeys) {\n\t\t\tmodifiersForRequest.scenarioKey = {in: modifiers.scenarioKeys};\n\t\t} else if (modifiers.scenarioKey) {\n\t\t\tmodifiersForRequest.scenarioKey = modifiers.scenarioKey;\n\t\t}\n\n\t\tif (modifiers.periodKeys) {\n\t\t\tmodifiersForRequest.periodKey = {in: modifiers.periodKeys};\n\t\t} else if (modifiers.periodKey) {\n\t\t\tmodifiersForRequest.periodKey = modifiers.periodKey;\n\t\t}\n\n\t\tif (modifiers.applicationKey) {\n\t\t\tmodifiersForRequest.applicationKey = modifiers.applicationKey;\n\t\t}\n\n\t\treturn !_isEmpty(modifiersForRequest) ? modifiersForRequest : null;\n\t} else {\n\t\treturn null;\n\t}\n}\n\n/**\n * Check if given input is natural number\n * @param input\n * @return {boolean}\n */\nfunction isNaturalNumber(input) {\n\treturn _isNumber(input) && input > 0 && input % 1 === 0;\n}\n\n/**\n * @param interval {Object}\n * @return {boolean}\n */\nfunction isInterval(interval) {\n\treturn isNaturalNumber(interval?.start) && isNaturalNumber(interval?.length);\n}\n\n/**\n * Return only intervals which really are intervals\n * @param intervals {Array}\n * @return {Array}\n */\nfunction getValidIntervals(intervals) {\n\treturn intervals.filter(interval => isInterval(interval));\n}\n\n/**\n * Return sorted intervals\n * @param intervals {Array}\n * @return {Array}\n */\nfunction getSortedValidIntervals(intervals) {\n\treturn _sortBy(getValidIntervals(intervals), ['start', 'length']);\n}\n\n/**\n * @param earlier {Object} interval\n * @param later {Object} interval\n * @return {boolean}\n */\nfunction areIntervalsOverlappedOrSubsequent(earlier, later) {\n\tif (isInterval(earlier) && isInterval(later)) {\n\t\treturn later.start <= earlier.start + earlier.length;\n\t} else {\n\t\treturn false;\n\t}\n}\n\n/**\n * Merge relevant intervals together\n * @param intervals {Array}\n * @return {Array}\n */\nfunction mergeIntervals(intervals) {\n\tconst sortedIntervals = getSortedValidIntervals(intervals);\n\tif (sortedIntervals.length === 0) {\n\t\treturn null;\n\t}\n\n\t//merge intervals\n\treturn _tail(sortedIntervals).reduce(\n\t\t(mergedIntervals, interval) => {\n\t\t\tconst last = mergedIntervals.pop();\n\t\t\tif (areIntervalsOverlappedOrSubsequent(last, interval)) {\n\t\t\t\t//merge last & current\n\t\t\t\tconst end = Math.max(\n\t\t\t\t\tlast.start + last.length,\n\t\t\t\t\tinterval.start + interval.length\n\t\t\t\t);\n\t\t\t\treturn [\n\t\t\t\t\t...mergedIntervals,\n\t\t\t\t\t{\n\t\t\t\t\t\tstart: last.start,\n\t\t\t\t\t\tlength: end - last.start,\n\t\t\t\t\t},\n\t\t\t\t];\n\t\t\t} else {\n\t\t\t\t//add both\n\t\t\t\treturn [...mergedIntervals, last, interval];\n\t\t\t}\n\t\t},\n\t\t[_head(sortedIntervals)]\n\t);\n}\n\n/**\n * Add keys to index\n * @param index {Object}\n * @param models {Object} Collection of models\n * @param start {Number}\n * @return {Object} index\n */\nfunction registerModelsToIndex(index, models, start) {\n\tif (models?.length && index && start > -1) {\n\t\tmodels.forEach((model, i) => {\n\t\t\tindex[start + i] = model.key;\n\t\t});\n\t\treturn index;\n\t} else {\n\t\treturn index;\n\t}\n}\n\nexport default {\n\tconvertModifiersToRequestFriendlyFormat,\n\tremoveIndex,\n\tgetIndex,\n\tgetUniqueIndexes,\n\tgetUpdatedIndexes,\n\tgetUpdatedByDataSourceKey,\n\tmergeFilters,\n\tmergeMetadataKeys,\n\tisCorrespondingIndex,\n\titemFitFilter,\n\tregisterModelsToIndex,\n\n\t// intervals\n\tareIntervalsOverlappedOrSubsequent,\n\tisInterval,\n\tisNaturalNumber,\n\tgetValidIntervals,\n\tgetSortedValidIntervals,\n\tmergeIntervals,\n};\n","import {createSelector} from 'reselect';\nimport {\n\tcreateSelector as createRecomputeSelector,\n\tcreateObserver as createRecomputeObserver,\n} from '@jvitela/recompute';\nimport createCachedSelector from 're-reselect';\nimport {\n\tdifference as _difference,\n\teach as _each,\n\tfind as _find,\n\tget as _get,\n\tisEqual as _isEqual,\n\tisEmpty as _isEmpty,\n\tmap as _map,\n\tpick as _pick,\n\tpickBy as _pickBy,\n\treduce as _reduce,\n} from 'lodash';\nimport commonHelpers from './helpers';\n\nconst getActiveKey = getSubstate => {\n\treturn state => getSubstate(state).activeKey;\n};\n\nconst getActiveKeys = getSubstate => {\n\treturn state => getSubstate(state).activeKeys;\n};\n\nconst getAllByKey = getSubstate => {\n\treturn state => getSubstate(state).byKey;\n};\n\nconst getKeysInUse = getSubstate => {\n\treturn state => getSubstate(state).inUse?.keys;\n};\n\nconst getIndexesInUse = getSubstate => {\n\treturn state => getSubstate(state).inUse?.indexes;\n};\n\nconst getEditedAllAsObject = getSubstate => {\n\treturn state => getSubstate(state).editedByKey;\n};\n\nconst getIndexes = getSubstate => {\n\treturn state => getSubstate(state).indexes;\n};\n\n/**\n * Get indexes value from given state on given path.\n * Optional param indexPath has default value \"indexes\". Call with:\n * state {Object}\n * indexPath {string}\n * @param getSubstate {function}\n * @return {Object} index\n */\nconst getIndexesByPath = getSubstate => {\n\treturn (state, indexPath = 'indexes') => _get(getSubstate(state), indexPath);\n};\n\n/**\n * Get all but removed models in byKey\n * @param getSubstate {function}\n * @returns {Object} all models except removed from by key\n */\nconst getAllNotRemovedAsObject = getSubstate => {\n\treturn createSelector([getAllByKey(getSubstate)], byKey => {\n\t\tif (byKey) {\n\t\t\treturn _pickBy(byKey, item => !item.hasOwnProperty('removed'));\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t});\n};\n\nconst getAllAsObject = getAllNotRemovedAsObject;\n\n/**\n * Get all but removed models as a collection\n * @param getSubstate {function}\n * @returns {Array|null} all models except removed as a collection\n */\nconst getAll = getSubstate => {\n\treturn createSelector([getAllAsObject(getSubstate)], byKey => {\n\t\treturn byKey ? Object.values(byKey) : null;\n\t});\n};\n\n/**\n * Get active model\n * @param getSubstate {func}\n * @return {Object} Active model\n */\nconst getActive = getSubstate => {\n\treturn createSelector(\n\t\t[getAllAsObject(getSubstate), getActiveKey(getSubstate)],\n\t\t(models, activeKey) => {\n\t\t\treturn models?.[activeKey] || null;\n\t\t}\n\t);\n};\n\n/**\n * Get active models\n * @param getSubstate {func}\n * @return {Array} A collection of active models\n */\nconst getActiveModels = getSubstate => {\n\treturn createSelector(\n\t\t[getAllAsObject(getSubstate), getActiveKeys(getSubstate)],\n\t\t(models, activeKeys) => {\n\t\t\tlet activeModels = [];\n\t\t\tif (models && !_isEmpty(models) && activeKeys && !_isEmpty(activeKeys)) {\n\t\t\t\tactiveKeys.map(key => {\n\t\t\t\t\tlet model = models[key];\n\t\t\t\t\tif (model) {\n\t\t\t\t\t\tactiveModels.push(model);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn activeModels.length ? activeModels : null;\n\t\t}\n\t);\n};\n\n/**\n * Get model with given key. Call with:\n * state {Object}\n * key {string} model key\n * @param getSubstate {function}\n * @return {Object} selected model\n */\nconst getByKey = getSubstate => {\n\treturn createCachedSelector(\n\t\t[getAllAsObject(getSubstate), (state, key) => key],\n\t\t(allData, key) => {\n\t\t\tif (key && allData && !_isEmpty(allData) && allData[key]) {\n\t\t\t\treturn allData[key];\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t)((state, key) => key);\n};\n\n/**\n * Get models by given keys. Call with:\n * state {Object}\n * keys {Array} model keys\n * @param getSubstate {function}\n * @return {Object} selected models\n */\nconst getByKeysAsObject = getSubstate => {\n\treturn createCachedSelector(\n\t\t[getAllAsObject(getSubstate), (state, keys) => keys],\n\t\t(allData, keys) => {\n\t\t\tif (keys && keys.length && allData && !_isEmpty(allData)) {\n\t\t\t\tlet data = _pick(allData, keys);\n\t\t\t\treturn _isEmpty(data) ? null : data;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t)((state, keys) => `${keys}`);\n};\n\n/**\n * Get models by given keys. Call with:\n * state {Object}\n * keys {Array} model keys\n * @param getSubstate {function}\n * @return {Array} selected models\n */\nconst getByKeys = getSubstate => {\n\treturn createCachedSelector([getByKeysAsObject(getSubstate)], asObject => {\n\t\tif (asObject) {\n\t\t\treturn Object.values(asObject);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t})((state, keys) => `${keys}`);\n};\n\n/**\n * Get model's data by given keys. Call with:\n * state {Object}\n * keys {Array} model keys\n * @param getSubstate {function}\n * @return {Object} selected model data\n */\nconst getDataByKey = getSubstate => {\n\treturn createSelector([getByKey(getSubstate)], model => {\n\t\treturn model?.data || null;\n\t});\n};\n\n/**\n * True, if current user or guest has a permission to delete the model. Call with:\n * state {Object}\n * key {string}\n * @param getSubstate {function}\n * @return {bool}\n */\nconst getDeletePermissionByKey = getSubstate => {\n\treturn createSelector([getByKey(getSubstate)], model => {\n\t\treturn (\n\t\t\tmodel?.permissions?.activeUser?.delete ||\n\t\t\tmodel?.permissions?.guest?.delete ||\n\t\t\tfalse\n\t\t);\n\t});\n};\n\n/**\n * True, if current user or guest has a permission to update the model. Call with:\n * state {Object}\n * key {string}\n * @param getSubstate {function}\n * @return {bool}\n */\nconst getUpdatePermissionByKey = getSubstate => {\n\treturn createSelector([getByKey(getSubstate)], model => {\n\t\treturn (\n\t\t\tmodel?.permissions?.activeUser?.update ||\n\t\t\tmodel?.permissions?.guest?.update ||\n\t\t\tfalse\n\t\t);\n\t});\n};\n\n/**\n * Get all edited models. Call with:\n * state {Object}\n * @param getSubstate {function}\n * @return {Object}\n */\nconst getEditedAll = getSubstate => {\n\treturn createSelector([getEditedAllAsObject(getSubstate)], editedAsObject => {\n\t\treturn editedAsObject ? Object.values(editedAsObject) : null;\n\t});\n};\n\n/**\n * Get active edited model. Call with:\n * state {Object}\n * @param getSubstate {function}\n * @return {Object} edited active model\n */\nconst getEditedActive = getSubstate => {\n\treturn createSelector(\n\t\t[getEditedAllAsObject(getSubstate), getActiveKey(getSubstate)],\n\t\t(models, activeKey) => {\n\t\t\treturn models?.[activeKey] || null;\n\t\t}\n\t);\n};\n\n/**\n * Get edited model with given key. Call with:\n * state {Object}\n * key {string} model key\n * @param getSubstate {function}\n * @return {Object} edited model\n */\nconst getEditedByKey = getSubstate => {\n\treturn createCachedSelector(\n\t\t[getEditedAllAsObject(getSubstate), (state, key) => key],\n\t\t(allData, key) => {\n\t\t\tif (key && allData && !_isEmpty(allData) && allData[key]) {\n\t\t\t\treturn allData[key];\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t)((state, key) => key);\n};\n\n/**\n * Get edited model's data by given key. Call with:\n * state {Object}\n * keys {Array} model keys\n * @param getSubstate {function}\n * @return {Object} edited model data\n */\nconst getEditedDataByKey = getSubstate => {\n\treturn createSelector([getEditedByKey(getSubstate)], model => {\n\t\treturn model?.data || null;\n\t});\n};\n\n/**\n * Get edited models keys. Call with:\n * state {Object}\n * @param getSubstate {function}\n * @return {Array} edited keys\n */\nconst getEditedKeys = getSubstate => {\n\treturn createSelector([getEditedAllAsObject(getSubstate)], edited => {\n\t\tif (edited && !_isEmpty(edited)) {\n\t\t\treturn Object.keys(edited);\n\t\t}\n\t\treturn null;\n\t});\n};\n\n/**\n * Get whole index by given filter and order. Call with:\n * state {Object}\n * filter {Object}\n * order {Array}\n * @param getSubstate {function}\n * @return {Object} index\n */\nconst getIndex = getSubstate => {\n\treturn createSelector(\n\t\t[\n\t\t\tgetIndexes(getSubstate),\n\t\t\t(state, filter) => filter,\n\t\t\t(state, filter, order) => order,\n\t\t],\n\t\t(indexes, filter, order) => {\n\t\t\treturn commonHelpers.getIndex(indexes, filter, order);\n\t\t}\n\t);\n};\n\n/**\n * Get whole index by given filter and order and optional indexPath. Call with:\n * state {Object}\n * indexPath {string} [optional]\n * filter {Object}\n * order {Array}\n * @param getSubstate {function}\n * @return {Object} index\n */\nconst getIndexByPath = getSubstate => {\n\treturn createSelector(\n\t\t[\n\t\t\tgetIndexesByPath(getSubstate),\n\t\t\t(state, indexPath, filter) => filter,\n\t\t\t(state, indexPath, filter, order) => order,\n\t\t],\n\t\t(indexes, filter, order) => {\n\t\t\treturn commonHelpers.getIndex(indexes, filter, order);\n\t\t}\n\t);\n};\n\n/**\n * Get changeOn of filtered index\n * state {Object}\n * filter {Object}\n * order {Array}\n * @param getSubstate {function}\n * @return {string}\n */\nconst getIndexChangedOn = getSubstate => {\n\treturn createSelector([getIndex(getSubstate)], index => {\n\t\treturn index?.changedOn || null;\n\t});\n};\n\n/**\n * Get indexes page. Call with:\n * state {Object}\n * filter {Object}\n * order {Array}\n * start {number} from 1 to n. Default 1.\n * length {number} from 1 to n. If no length specified, then is equal to total\n * @param getSubstate {function}\n * @return {Object} {7: 'key1', 8: null, ...}\n */\nconst getIndexPage = getSubstate => {\n\treturn createSelector(\n\t\t[\n\t\t\tgetIndex(getSubstate),\n\t\t\t(state, filter, order, start) => start,\n\t\t\t(state, filter, order, start, length) => length,\n\t\t],\n\t\t(index, start, length) => {\n\t\t\tif (index?.index && start && length) {\n\t\t\t\tlet indexed = {};\n\t\t\t\tfor (let o = start; o < start + length && o <= index.count; o++) {\n\t\t\t\t\tlet key = index.index[o];\n\t\t\t\t\tindexed[o] = key ? key : null;\n\t\t\t\t}\n\t\t\t\treturn indexed;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t);\n};\n\n/**\n * Get indexed models. Call with:\n * state {Object}\n * filterByActive {Object}\n * filter {Object}\n * order {Array}\n * start {number} from 1 to n. Default 1.\n * length {number} from 1 to n. If no length specified, then is equal to total\n * @param getSubstate {function}\n * @return {Array} collection of models\n */\nconst getIndexed = getSubstate => {\n\treturn createCachedSelector(\n\t\t[\n\t\t\tgetAllAsObject(getSubstate),\n\t\t\tgetIndexes(getSubstate),\n\t\t\tgetAllActiveKeys,\n\t\t\t(state, filterByActive) => filterByActive,\n\t\t\t(state, filterByActive, filter) => filter,\n\t\t\t(state, filterByActive, filter, order) => order,\n\t\t\t(state, filterByActive, filter, order, start) => start,\n\t\t\t(state, filterByActive, filter, order, start, length) => length,\n\t\t],\n\t\t(\n\t\t\tmodels,\n\t\t\tindexes,\n\t\t\tactiveKeys,\n\t\t\tfilterByActive,\n\t\t\tfilter,\n\t\t\torder,\n\t\t\tstart,\n\t\t\tlength\n\t\t) => {\n\t\t\tif (models && indexes) {\n\t\t\t\tlet mergedFilter = commonHelpers.mergeFilters(\n\t\t\t\t\tactiveKeys,\n\t\t\t\t\tfilterByActive,\n\t\t\t\t\tfilter\n\t\t\t\t);\n\t\t\t\tlet index = commonHelpers.getIndex(indexes, mergedFilter, order);\n\t\t\t\tif (index?.index) {\n\t\t\t\t\tlet indexedModels = [];\n\t\t\t\t\tstart = start || 1;\n\t\t\t\t\tlength = length || index.count;\n\n\t\t\t\t\tlet end = Math.min(start + length - 1, index.count);\n\t\t\t\t\tfor (let i = start; i <= end; i++) {\n\t\t\t\t\t\tlet modelKey = index.index[i];\n\t\t\t\t\t\tif (modelKey) {\n\t\t\t\t\t\t\tlet indexedModel = models[modelKey];\n\t\t\t\t\t\t\tif (indexedModel) {\n\t\t\t\t\t\t\t\tindexedModels.push(indexedModel);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tindexedModels.push({key: modelKey});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tindexedModels.push(null);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn indexedModels.length ? indexedModels : null;\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t)((state, filterByActive, filter, order, start, length) => {\n\t\treturn `${JSON.stringify(filterByActive)}:${JSON.stringify(\n\t\t\tfilter\n\t\t)}:${JSON.stringify(order)}:${start}:${length}`;\n\t});\n};\n\n/**\n * Get count of indexed items. Call with:\n * state {Object}\n * filter {Object}\n * order {Array}\n * @param getSubstate {function}\n * @return {number}\n */\nconst getIndexTotal = getSubstate => {\n\treturn createSelector([getIndex(getSubstate)], index => {\n\t\tif (index?.count > -1) {\n\t\t\treturn index.count;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t});\n};\n\n/**\n * Find all indexes in store where item fit their filter.\n * state {Object}\n * item {Object}\n * @param {func} getSubstate\n * @return {Array}\n */\nconst getIndexesByFilteredItem = getSubstate => {\n\treturn createSelector(\n\t\t[getIndexes(getSubstate), (state, item) => item],\n\t\t(indexes, item) => {\n\t\t\tif (!_isEmpty(indexes)) {\n\t\t\t\treturn indexes.filter(index =>\n\t\t\t\t\tcommonHelpers.itemFitFilter(index.filter, item)\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t);\n};\n\n/**\n * Compare keys with loaded models and return which keys need to be loaded\n * state {Object}\n * keys {Array}\n * @param getSubstate {function}\n * @return {Array} keys to load\n */\nconst getKeysToLoad = getSubstate => {\n\treturn createSelector(\n\t\t[getAllAsObject(getSubstate), (state, keys) => keys],\n\t\t(models, keys) => {\n\t\t\tif (keys && keys.length) {\n\t\t\t\tif (!models) {\n\t\t\t\t\treturn keys;\n\t\t\t\t} else {\n\t\t\t\t\tconst filteredKeys = keys.filter(\n\t\t\t\t\t\tkey => !models[key] || models[key].outdated\n\t\t\t\t\t);\n\t\t\t\t\treturn filteredKeys.length ? filteredKeys : null;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t);\n};\n\n/**\n * Get a list of keys used by given component\n * state {Object}\n * componentKey {string}\n * @param getSubstate {function}\n * @return {Array} used keys\n */\nconst getUsedKeysForComponent = getSubstate => {\n\treturn createCachedSelector(\n\t\t[getKeysInUse(getSubstate), (state, componentKey) => componentKey],\n\t\t(usedKeys, componentKey) => {\n\t\t\treturn usedKeys &&\n\t\t\t\tcomponentKey &&\n\t\t\t\tusedKeys[componentKey] &&\n\t\t\t\tusedKeys[componentKey].length\n\t\t\t\t? usedKeys[componentKey]\n\t\t\t\t: null;\n\t\t}\n\t)((state, componentKey) => `${componentKey}`);\n};\n\n/**\n * True, if all given keys are registered for given component\n * state {Object}\n * componentKey {string}\n * keys {Array}\n * @param getSubstate {function}\n * @return {boolean}\n */\nconst haveAllKeysRegisteredUse = getSubstate => {\n\treturn createCachedSelector(\n\t\t[getUsedKeysForComponent(getSubstate), (state, componentKey, keys) => keys],\n\t\t(usedKeys, keys) => {\n\t\t\tif (usedKeys && keys?.length) {\n\t\t\t\tconst notIncluded = _difference(keys, usedKeys);\n\t\t\t\treturn !notIncluded.length;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t)((state, componentKey, keys) => `${componentKey}_${keys}`);\n};\n\n/**\n * Return all used index pages for given substate\n * @param getSubstate {function}\n * @return {Array} a collection of used pages {filter: Object, order: Array, uses: [{start: number, length: number}]}\n */\nconst getUsedIndexPages = getSubstate => {\n\treturn createSelector(\n\t\t[getIndexesInUse(getSubstate), getAllActiveKeys],\n\t\t(indexedDataUses, activeKeys) => {\n\t\t\tlet groupedUses = [];\n\t\t\tlet finalUsedIndexes = [];\n\t\t\tif (!_isEmpty(indexedDataUses)) {\n\t\t\t\t_each(indexedDataUses, usedIndexes => {\n\t\t\t\t\tusedIndexes.forEach(usedIndex => {\n\t\t\t\t\t\tlet mergedFilter = commonHelpers.mergeFilters(\n\t\t\t\t\t\t\tactiveKeys,\n\t\t\t\t\t\t\tusedIndex.filterByActive,\n\t\t\t\t\t\t\tusedIndex.filter\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tlet existingIndex = _find(groupedUses, use => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t_isEqual(use.filter, mergedFilter) &&\n\t\t\t\t\t\t\t\t_isEqual(use.order, usedIndex.order)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (existingIndex) {\n\t\t\t\t\t\t\texistingIndex.inUse.push({\n\t\t\t\t\t\t\t\tstart: usedIndex.start,\n\t\t\t\t\t\t\t\tlength: usedIndex.length,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tgroupedUses.push({\n\t\t\t\t\t\t\t\tfilter: mergedFilter,\n\t\t\t\t\t\t\t\torder: usedIndex.order,\n\t\t\t\t\t\t\t\tinUse: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tstart: usedIndex.start,\n\t\t\t\t\t\t\t\t\t\tlength: usedIndex.length,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (!_isEmpty(groupedUses)) {\n\t\t\t\t_each(groupedUses, groupedUse => {\n\t\t\t\t\tif (groupedUse?.inUse?.length) {\n\t\t\t\t\t\tconst uses = commonHelpers.mergeIntervals(groupedUse.inUse);\n\t\t\t\t\t\tif (uses) {\n\t\t\t\t\t\t\tfinalUsedIndexes.push({\n\t\t\t\t\t\t\t\tfilter: groupedUse.filter,\n\t\t\t\t\t\t\t\torder: groupedUse.order,\n\t\t\t\t\t\t\t\tuses,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn finalUsedIndexes.length ? finalUsedIndexes : null;\n\t\t}\n\t);\n};\n\n/**\n * Return used index page for given substate, filter & order. Call with:\n * filter {Object}\n * order {Array}\n * @param getSubstate {function}\n * @return {Object} used page {filter: Object, order: Array, uses: [{start: number, length: number}]}\n */\nconst getUsedIndexPage = getSubstate => {\n\treturn createCachedSelector(\n\t\tgetUsedIndexPages(getSubstate),\n\t\t(state, filter) => filter,\n\t\t(state, filter, order) => order,\n\t\t(usedIndexPages, filter, order) => {\n\t\t\tif (usedIndexPages) {\n\t\t\t\treturn _find(usedIndexPages, {filter, order});\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t)((state, filter, order) => {\n\t\tlet stringOrder = JSON.stringify(order);\n\t\tlet stringFilter = JSON.stringify(\n\t\t\t_map(filter, (value, key) => {\n\t\t\t\treturn `${key}:${value}`;\n\t\t\t}).sort()\n\t\t);\n\t\treturn `${stringOrder}:${stringFilter}`;\n\t});\n};\n\n/**\n * Return all uses with active dependency. Call with:\n * filterByActive {Object}\n * @param getSubstate {function}\n * @return {Array} a collection of used pages {filter: Object, order: Array, uses: [{start: number, length: number}]}\n */\nconst getUsesWithActiveDependency = getSubstate => {\n\treturn createSelector(\n\t\t[\n\t\t\tgetIndexesInUse(getSubstate),\n\t\t\tgetAllActiveKeys,\n\t\t\t(state, filterByActive) => filterByActive,\n\t\t],\n\t\t/**\n\t\t * @param indexedDataUses {Object} inUse.indexes\n\t\t * @param activeKeys {Object} active keys of all metadata\n\t\t * @param filterByActive {Object} given metadata type active key for filtering (e.g. {scope: true})\n\t\t */\n\t\t(indexedDataUses, activeKeys, filterByActive) => {\n\t\t\tlet groupedUses = []; // uses grouped by filter\n\t\t\tlet usedIndexes = [];\n\n\t\t\tif (filterByActive && !_isEmpty(indexedDataUses)) {\n\t\t\t\t// loop through components\n\t\t\t\t_map(indexedDataUses, componentUsedIndexes => {\n\t\t\t\t\t// loop through uses for component\n\t\t\t\t\t_map(componentUsedIndexes, usedIndex => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t_reduce(\n\t\t\t\t\t\t\t\tfilterByActive,\n\t\t\t\t\t\t\t\t(accumulator, value, index) =>\n\t\t\t\t\t\t\t\t\taccumulator &&\n\t\t\t\t\t\t\t\t\tvalue &&\n\t\t\t\t\t\t\t\t\tusedIndex.filterByActive &&\n\t\t\t\t\t\t\t\t\tusedIndex.filterByActive[index],\n\t\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t// if usedIndex.filterByActive has all the properties of filterByActive\n\n\t\t\t\t\t\t\tlet mergedFilter = commonHelpers.mergeFilters(\n\t\t\t\t\t\t\t\tactiveKeys,\n\t\t\t\t\t\t\t\tusedIndex.filterByActive,\n\t\t\t\t\t\t\t\tusedIndex.filter\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tlet existingIndex = _find(groupedUses, use => {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t_isEqual(use.filter, mergedFilter) &&\n\t\t\t\t\t\t\t\t\t_isEqual(use.order, usedIndex.order)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (existingIndex) {\n\t\t\t\t\t\t\t\texistingIndex.inUse.push({\n\t\t\t\t\t\t\t\t\tstart: usedIndex.start,\n\t\t\t\t\t\t\t\t\tlength: usedIndex.length,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tgroupedUses.push({\n\t\t\t\t\t\t\t\t\tfilter: mergedFilter,\n\t\t\t\t\t\t\t\t\torder: usedIndex.order,\n\t\t\t\t\t\t\t\t\tinUse: [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tstart: usedIndex.start,\n\t\t\t\t\t\t\t\t\t\t\tlength: usedIndex.length,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\t// loop through uses grouped by filter and merge intervals\n\t\t\t\tif (!_isEmpty(groupedUses)) {\n\t\t\t\t\t_map(groupedUses, groupedUse => {\n\t\t\t\t\t\tif (groupedUse?.inUse?.length) {\n\t\t\t\t\t\t\tconst uses = commonHelpers.mergeIntervals(groupedUse.inUse);\n\t\t\t\t\t\t\tif (uses) {\n\t\t\t\t\t\t\t\tusedIndexes.push({\n\t\t\t\t\t\t\t\t\tfilter: groupedUse.filter,\n\t\t\t\t\t\t\t\t\torder: groupedUse.order,\n\t\t\t\t\t\t\t\t\tuses,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn usedIndexes.length ? usedIndexes : null;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t);\n};\n\n/**\n * Get all data from substore which should be saved (to the view for instance)\n * @param getSubstate {function}\n * @return {Object} substore state to save\n */\nconst getStateToSave = getSubstate => {\n\treturn state => {\n\t\tconst activeKey = getSubstate(state).activeKey;\n\t\tif (activeKey) {\n\t\t\treturn {activeKey};\n\t\t}\n\n\t\tconst activeKeys = getSubstate(state).activeKeys;\n\t\tif (activeKeys) {\n\t\t\treturn {activeKeys};\n\t\t}\n\n\t\treturn {};\n\t};\n};\n\n/* \t--- Selectors across stores --------------------------------------------- */\n\n/**\n * Get activeKey/activeKeys from all relevant substores\n * @param state {Object}\n * @return {Object}\n */\nconst getAllActiveKeys = createSelector(\n\t[\n\t\tstate => state.scopes?.activeKey,\n\t\tstate => state.cases?.activeKey,\n\t\tstate => state.cases?.activeKeys,\n\t\tstate => state.scenarios?.activeKey,\n\t\tstate => state.scenarios?.activeKeys,\n\t\tstate => state.places?.activeKey,\n\t\tstate => state.places?.activeKeys,\n\t\tstate => state.periods?.activeKey,\n\t\tstate => state.periods?.activeKeys,\n\t\tstate => state.attributes?.activeKey,\n\t\tstate => state.attributes?.activeKeys,\n\t\tstate => state.layerTemplates?.activeKey,\n\t\tstate => state.areas?.areaTreeLevels?.activeKey,\n\t\tstate => state.specific?.apps,\n\t\tstate => state.app?.key,\n\t],\n\t(\n\t\tactiveScopeKey,\n\t\tactiveCaseKey,\n\t\tactiveCaseKeys,\n\t\tactiveScenarioKey,\n\t\tactiveScenarioKeys,\n\t\tactivePlaceKey,\n\t\tactivePlaceKeys,\n\t\tactivePeriodKey,\n\t\tactivePeriodKeys,\n\t\tactiveAttributeKey,\n\t\tactiveAttributeKeys,\n\t\tactiveLayerTemplateKey,\n\t\tactiveAreaTreeLevelKey,\n\t\tapps,\n\t\tappKey\n\t) => {\n\t\tlet activeKeys = {\n\t\t\tactiveScopeKey: activeScopeKey || null,\n\t\t\tactiveCaseKey: activeCaseKey || null,\n\t\t\tactiveCaseKeys: activeCaseKeys || null,\n\t\t\tactiveScenarioKey: activeScenarioKey || null,\n\t\t\tactiveScenarioKeys: activeScenarioKeys || null,\n\t\t\tactivePlaceKey: activePlaceKey || null,\n\t\t\tactivePlaceKeys: activePlaceKeys || null,\n\t\t\tactivePeriodKey: activePeriodKey || null,\n\t\t\tactivePeriodKeys: activePeriodKeys || null,\n\t\t\tactiveAttributeKey: activeAttributeKey || null,\n\t\t\tactiveAttributeKeys: activeAttributeKeys || null,\n\t\t\tactiveLayerTemplateKey: activeLayerTemplateKey || null,\n\t\t\tactiveAreaTreeLevelKey: activeAreaTreeLevelKey || null,\n\t\t};\n\n\t\t// for BO usage\n\t\tif (apps) {\n\t\t\tactiveKeys.activeApplicationKey = apps.activeKey;\n\t\t} else if (appKey) {\n\t\t\tactiveKeys.activeApplicationKey = appKey;\n\t\t}\n\n\t\treturn activeKeys;\n\t}\n);\n\n/**\n * Get activeKey/activeKeys by filterByActive from all relevant substores\n * @param state {Object}\n * @param filterByActive {Object}\n * @return {Object}\n */\nconst getActiveKeysByFilterByActive = createCachedSelector(\n\t[getAllActiveKeys, (state, filterByActive) => filterByActive],\n\t(activeKeys, filterByActive) => {\n\t\tif (filterByActive && !_isEmpty(filterByActive)) {\n\t\t\tlet keys = {};\n\n\t\t\tif (filterByActive.scope && activeKeys.activeScopeKey) {\n\t\t\t\tkeys.scopeKey = activeKeys.activeScopeKey;\n\t\t\t}\n\t\t\tif (filterByActive.place) {\n\t\t\t\tif (activeKeys.activePlaceKey) {\n\t\t\t\t\tkeys.placeKey = activeKeys.activePlaceKey;\n\t\t\t\t} else if (activeKeys.activePlaceKeys) {\n\t\t\t\t\tkeys.placeKeys = activeKeys.activePlaceKeys;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (filterByActive.scenario) {\n\t\t\t\tif (activeKeys.activeScenarioKey) {\n\t\t\t\t\tkeys.scenarioKey = activeKeys.activeScenarioKey;\n\t\t\t\t} else if (activeKeys.activeScenarioKeys) {\n\t\t\t\t\tkeys.scenarioKeys = activeKeys.activeScenarioKeys;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (filterByActive.case) {\n\t\t\t\tif (activeKeys.activeCaseKey) {\n\t\t\t\t\tkeys.caseKey = activeKeys.activeCaseKey;\n\t\t\t\t} else if (activeKeys.activeCaseKeys) {\n\t\t\t\t\tkeys.caseKeys = activeKeys.activeCaseKeys;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (filterByActive.period) {\n\t\t\t\tif (activeKeys.activePeriodKey) {\n\t\t\t\t\tkeys.periodKey = activeKeys.activePeriodKey;\n\t\t\t\t} else if (activeKeys.activePeriodKeys) {\n\t\t\t\t\tkeys.periodKeys = activeKeys.activePeriodKeys;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (filterByActive.attribute) {\n\t\t\t\tif (activeKeys.activeAttributeKey) {\n\t\t\t\t\tkeys.attributeKey = activeKeys.activeAttributeKey;\n\t\t\t\t} else if (activeKeys.activeAttributeKeys) {\n\t\t\t\t\tkeys.attributeKeys = activeKeys.activeAttributeKeys;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (filterByActive.layerTemplate && activeKeys.activeLayerTemplateKey) {\n\t\t\t\tkeys.layerTemplateKey = activeKeys.activeLayerTemplateKey;\n\t\t\t}\n\t\t\tif (filterByActive.areaTreeLevel && activeKeys.activeAreaTreeLevelKey) {\n\t\t\t\tkeys.areaTreeLevelKey = activeKeys.activeAreaTreeLevelKey;\n\t\t\t}\n\t\t\tif (filterByActive.application && activeKeys.activeApplicationKey) {\n\t\t\t\tkeys.applicationKey = activeKeys.activeApplicationKey;\n\t\t\t}\n\n\t\t\treturn !_isEmpty(keys) ? keys : null;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n)((state, filterByActive) => JSON.stringify(filterByActive));\n\n/* \t--- Recompute observers -------------------------------------------------- */\n\n/**\n * Get activeKey/activeKeys by filterByActive from all relevant substores. Call with:\n * filterByActive {Object}\n * @return {Object}\n */\nconst getActiveKeysByFilterByActiveObserver = createRecomputeObserver(\n\t(state, filterByActive) =>\n\t\tgetActiveKeysByFilterByActive(state, filterByActive)\n);\n\n/**\n * Get all indexes from substore\n * @return {Object}\n */\nconst getIndexesObserver = createRecomputeObserver((state, getSubstate) =>\n\tgetIndexes(getSubstate)(state)\n);\n\n/* --- Recompute selectors -------------------------------------------------- */\n\n/**\n * Get whole index by given filter and order. Call with:\n * filter {Object}\n * order {Array}\n * @return {Object}\n */\nconst getIndex_recompute = getSubstate => {\n\treturn createRecomputeSelector((filter, order) => {\n\t\tconst indexes = getIndexesObserver(getSubstate);\n\t\tif (indexes) {\n\t\t\treturn commonHelpers.getIndex(indexes, filter, order);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t});\n};\n\n/**\n * Merge metadata modifiers with filter by active.\n * @param metadataModifiers {Object} {placeKey: \"uuid\", scopeKey: \"uuid\", ...}\n * @param filterByActive {Object} {place: true, case: true, ...}\n * @param {Object} Merged modifiers\n */\nconst getMergedModifiers_recompute = createRecomputeSelector(\n\t(metadataModifiers, filterByActive) => {\n\t\t// TODO at least a part is the same as in Maps/actions/layerUse?\n\n\t\t// modifiers defined by key\n\t\tlet metadataDefinedByKey = metadataModifiers ? {...metadataModifiers} : {};\n\n\t\t// Get actual metadata keys defined by filterByActive\n\t\tconst activeMetadataKeys = getActiveKeysByFilterByActiveObserver(\n\t\t\tfilterByActive\n\t\t);\n\n\t\t// Merge metadata, metadata defined by key have priority\n\t\treturn commonHelpers.mergeMetadataKeys(\n\t\t\tmetadataDefinedByKey,\n\t\t\tactiveMetadataKeys\n\t\t);\n\t}\n);\n\n/**\n * Merge metadata modifiers with filter by active and return it in request-like format\n * @param metadataModifiers {Object}\n * @param filterByActive {Object}\n * @return {Object} Merged modifiers in request-like format\n */\nconst getMergedModifiersInRequestFormat_recompute = createRecomputeSelector(\n\t(metadataModifiers, filterByActive) => {\n\t\tconst mergedMetadataKeys = getMergedModifiers_recompute(\n\t\t\tmetadataModifiers,\n\t\t\tfilterByActive\n\t\t);\n\n\t\t// It converts modifiers from metadataKeys: [\"A\", \"B\"] to metadataKey: {in: [\"A\", \"B\"]}\n\t\treturn commonHelpers.convertModifiersToRequestFriendlyFormat(\n\t\t\tmergedMetadataKeys\n\t\t);\n\t}\n);\n\n/**\n * Get common filter for data relations\n * @params componentState {Object}\n * @return {Object} relations filter\n */\nconst getCommmonDataRelationsFilterFromComponentState_recompute = createRecomputeSelector(\n\tcomponentState => {\n\t\tconst relationsFilter = {};\n\t\tconst modifiers = getMergedModifiersInRequestFormat_recompute(\n\t\t\tcomponentState?.metadataModifiers,\n\t\t\tcomponentState?.filterByActive\n\t\t);\n\t\tif (!_isEmpty(modifiers)) {\n\t\t\trelationsFilter.modifiers = modifiers;\n\t\t}\n\n\t\t// add layerTemplate od areaTreeLevelKey\n\t\tif (componentState?.layerTemplateKey) {\n\t\t\trelationsFilter.layerTemplateKey = componentState.layerTemplateKey;\n\t\t} else if (componentState?.areaTreeLevelKey) {\n\t\t\trelationsFilter.areaTreeLevelKey = componentState.areaTreeLevelKey;\n\t\t}\n\t\treturn relationsFilter;\n\t}\n);\n\nexport default {\n\tgetActive,\n\tgetActiveKey,\n\tgetActiveKeys,\n\tgetActiveModels,\n\tgetAll,\n\tgetAllAsObject,\n\tgetAllByKey,\n\n\tgetByKey,\n\tgetByKeysAsObject,\n\tgetByKeys,\n\n\tgetDataByKey,\n\tgetDeletePermissionByKey,\n\n\tgetEditedActive,\n\tgetEditedAll,\n\tgetEditedAllAsObject,\n\tgetEditedByKey,\n\tgetEditedDataByKey,\n\tgetEditedKeys,\n\n\tgetIndex,\n\tgetIndexByPath,\n\tgetIndexed,\n\tgetIndexes,\n\tgetIndexesByPath,\n\tgetIndexChangedOn,\n\tgetIndexPage,\n\tgetIndexTotal,\n\tgetIndexesByFilteredItem,\n\n\tgetKeysInUse,\n\tgetKeysToLoad,\n\n\tgetStateToSave,\n\n\tgetUpdatePermissionByKey,\n\tgetUsedIndexPage,\n\tgetUsedIndexPages,\n\tgetUsedKeysForComponent,\n\tgetUsesWithActiveDependency,\n\n\thaveAllKeysRegisteredUse,\n\n\t// selectors across stores\n\tgetActiveKeysByFilterByActive,\n\tgetAllActiveKeys,\n\n\t// recompute observers\n\tgetActiveKeysByFilterByActiveObserver,\n\tgetIndexesObserver,\n\n\t// recompute selectors\n\tgetIndex_recompute,\n\tgetCommmonDataRelationsFilterFromComponentState_recompute,\n\tgetMergedModifiers_recompute,\n\tgetMergedModifiersInRequestFormat_recompute,\n};\n","import common from '../../_common/selectors';\n\nconst getSubstate = state => state.areas.areaTreeLevels;\n\nconst getAll = common.getAll(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\nconst getActive = common.getActive(getSubstate);\n\nexport default {\n\tgetAll,\n\tgetAllAsObject,\n\tgetActiveKey,\n\tgetActive,\n\n\tgetSubstate,\n};\n","import {createSelector} from 'reselect';\nimport _ from 'lodash';\n\nimport common from '../../_common/selectors';\n\nconst getSubstate = state => state.areas.areaTrees;\n\nconst getAll = common.getAll(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\nconst getActive = common.getActive(getSubstate);\n\nexport default {\n\tgetAll,\n\tgetAllAsObject,\n\tgetActiveKey,\n\tgetActive,\n\n\tgetByKeys: common.getByKeys(getSubstate),\n\tgetByKeysAsObject: common.getByKeysAsObject(getSubstate),\n\n\tgetSubstate,\n};\n","import areaTreeLevels from './AreaTreeLevels/selectors';\nimport areaTrees from './AreaTrees/selectors';\n\nexport default {\n\tareaTreeLevels,\n\tareaTrees,\n};\n","import {createSelector} from 'reselect';\nimport createCachedSelector from 're-reselect';\nimport _ from 'lodash';\nimport common from '../_common/selectors';\n\nconst getSubstate = state => state.areaRelations;\nconst getAll = common.getAll(getSubstate);\n\n/**\n * @return {Array|null}\n */\nconst getAllData = createSelector([getAll], relations => {\n\tif (relations) {\n\t\treturn _.map(relations, relation => relation.data);\n\t} else {\n\t\treturn null;\n\t}\n});\n\n/**\n * @param state {Object}\n * @param filter {Object}\n * @returns {Array|null}\n */\nconst getFilteredData = createSelector(\n\t[getAllData, (state, filter) => filter],\n\t(relations, filter) => {\n\t\tif (relations && relations.length > 0 && filter && !_.isEmpty(filter)) {\n\t\t\treturn _.filter(relations, filter);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\n/**\n * @returns {Object}\n */\nconst getFilteredDataSourceKeysGroupedByLayerKey = createCachedSelector(\n\t[getAll, (state, layers) => layers],\n\t(relations, layers) => {\n\t\tif (relations && relations.length) {\n\t\t\tlet filteredGroupedByLayerKey = {};\n\n\t\t\t_.forEach(layers, layer => {\n\t\t\t\tlet filteredRelations = _.filter(relations, {data: layer.filter});\n\t\t\t\tif (filteredRelations.length) {\n\t\t\t\t\tfilteredGroupedByLayerKey[layer.key] = filteredRelations.map(\n\t\t\t\t\t\trelation => {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tspatialDataSourceKey: relation.data.spatialDataSourceKey,\n\t\t\t\t\t\t\t\tfidColumnName: relation.data.fidColumnName,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn !_.isEmpty(filteredGroupedByLayerKey)\n\t\t\t\t? filteredGroupedByLayerKey\n\t\t\t\t: null;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n)((state, layers) => JSON.stringify(layers));\n\nexport default {\n\tgetSubstate,\n\n\tgetFilteredData,\n\tgetFilteredDataSourceKeysGroupedByLayerKey,\n};\n","import common from '../_common/selectors';\n\nconst getSubstate = state => state.attributes;\n\nconst getAll = common.getAll(getSubstate);\nconst getActive = common.getActive(getSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\nconst getActiveKeys = common.getActiveKeys(getSubstate);\nconst getActiveModels = common.getActiveModels(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\n\nconst getByKey = common.getByKey(getSubstate);\nconst getByKeys = common.getByKeys(getSubstate);\nconst getByKeysAsObject = common.getByKeysAsObject(getSubstate);\n\nconst getDataByKey = common.getDataByKey(getSubstate);\nconst getDeletePermissionByKey = common.getDeletePermissionByKey(getSubstate);\n\nconst getEditedActive = common.getEditedActive(getSubstate);\nconst getEditedAll = common.getEditedAll(getSubstate);\nconst getEditedAllAsObject = common.getEditedAllAsObject(getSubstate);\nconst getEditedByKey = common.getEditedByKey(getSubstate);\nconst getEditedDataByKey = common.getEditedDataByKey(getSubstate);\nconst getEditedKeys = common.getEditedKeys(getSubstate);\n\nconst getIndexed = common.getIndexed(getSubstate);\n\nconst getUpdatePermissionByKey = common.getUpdatePermissionByKey(getSubstate);\nconst getUsedKeysForComponent = common.getUsedKeysForComponent(getSubstate);\n\nconst getStateToSave = common.getStateToSave(getSubstate);\n\nconst haveAllKeysRegisteredUse = common.haveAllKeysRegisteredUse(getSubstate);\n\nexport default {\n\tgetActive,\n\tgetActiveKey,\n\tgetActiveKeys,\n\tgetActiveModels,\n\tgetAll,\n\tgetAllAsObject,\n\n\tgetByKey,\n\tgetByKeys,\n\tgetByKeysAsObject,\n\n\tgetDataByKey,\n\tgetDeletePermissionByKey,\n\n\tgetEditedActive,\n\tgetEditedAll,\n\tgetEditedAllAsObject,\n\tgetEditedByKey,\n\tgetEditedDataByKey,\n\tgetEditedKeys,\n\n\tgetIndexed,\n\n\tgetUpdatePermissionByKey,\n\tgetUsedKeysForComponent,\n\n\tgetStateToSave,\n\tgetSubstate,\n\n\thaveAllKeysRegisteredUse,\n};\n","import common from '../_common/selectors';\n\nconst getSubstate = state => state.attributeSets;\n\nconst getAll = common.getAll(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\nconst getActiveKey = common.getActiveKeys(getSubstate);\nconst getActiveKeys = common.getActiveKeys(getSubstate);\nconst getActiveModels = common.getActiveModels(getSubstate);\nconst getActive = common.getActive(getSubstate);\n\nconst getByKey = common.getByKey(getSubstate);\nconst getByKeys = common.getByKeys(getSubstate);\nconst getByKeysAsObject = common.getByKeysAsObject(getSubstate);\nconst getDataByKey = common.getDataByKey(getSubstate);\nconst getDeletePermissionByKey = common.getDeletePermissionByKey(getSubstate);\n\nconst getEditedActive = common.getEditedActive(getSubstate);\nconst getEditedAll = common.getEditedAll(getSubstate);\nconst getEditedAllAsObject = common.getEditedAllAsObject(getSubstate);\nconst getEditedByKey = common.getEditedByKey(getSubstate);\nconst getEditedDataByKey = common.getEditedDataByKey(getSubstate);\nconst getEditedKeys = common.getEditedKeys(getSubstate);\n\nconst getIndexed = common.getIndexed(getSubstate);\n\nconst getStateToSave = common.getStateToSave(getSubstate);\n\nconst getUpdatePermissionByKey = common.getUpdatePermissionByKey(getSubstate);\nconst getUsedKeysForComponent = common.getUsedKeysForComponent(getSubstate);\n\nconst haveAllKeysRegisteredUse = common.haveAllKeysRegisteredUse(getSubstate);\n\nexport default {\n\tgetActive,\n\tgetActiveKey,\n\tgetActiveKeys,\n\tgetActiveModels,\n\tgetAll,\n\tgetAllAsObject,\n\n\tgetByKey,\n\tgetByKeys,\n\tgetByKeysAsObject,\n\tgetDataByKey,\n\tgetDeletePermissionByKey,\n\n\tgetEditedActive,\n\tgetEditedAll,\n\tgetEditedAllAsObject,\n\tgetEditedByKey,\n\tgetEditedDataByKey,\n\tgetEditedKeys,\n\n\tgetIndexed,\n\n\tgetStateToSave,\n\tgetSubstate,\n\n\tgetUpdatePermissionByKey,\n\tgetUsedKeysForComponent,\n\n\thaveAllKeysRegisteredUse,\n};\n","import common from '../_common/selectors';\n\nconst getSubstate = state => state.cases;\n\nconst getAll = common.getAll(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\nconst getActive = common.getActive(getSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\nconst getActiveKeys = common.getActiveKeys(getSubstate);\nconst getActiveModels = common.getActiveModels(getSubstate);\n\nconst getByKey = common.getByKey(getSubstate);\nconst getByKeys = common.getByKeys(getSubstate);\nconst getByKeysAsObject = common.getByKeysAsObject(getSubstate);\n\nconst getDataByKey = common.getDataByKey(getSubstate);\nconst getDeletePermissionByKey = common.getDeletePermissionByKey(getSubstate);\n\nconst getEditedActive = common.getEditedActive(getSubstate);\nconst getEditedAll = common.getEditedAll(getSubstate);\nconst getEditedAllAsObject = common.getEditedAllAsObject(getSubstate);\nconst getEditedByKey = common.getEditedByKey(getSubstate);\nconst getEditedDataByKey = common.getEditedDataByKey(getSubstate);\nconst getEditedKeys = common.getEditedKeys(getSubstate);\n\nconst getIndexed = common.getIndexed(getSubstate);\nconst getStateToSave = common.getStateToSave(getSubstate);\nconst getUpdatePermissionByKey = common.getUpdatePermissionByKey(getSubstate);\nconst getUsedKeysForComponent = common.getUsedKeysForComponent(getSubstate);\n\nconst haveAllKeysRegisteredUse = common.haveAllKeysRegisteredUse(getSubstate);\n\nexport default {\n\tgetActive,\n\tgetActiveKey,\n\tgetActiveKeys,\n\tgetActiveModels,\n\tgetAll,\n\tgetAllAsObject,\n\n\tgetByKey,\n\tgetByKeys,\n\tgetByKeysAsObject,\n\n\tgetDataByKey,\n\tgetDeletePermissionByKey,\n\n\tgetEditedActive,\n\tgetEditedAll,\n\tgetEditedAllAsObject,\n\tgetEditedByKey,\n\tgetEditedDataByKey,\n\tgetEditedKeys,\n\n\tgetIndexed,\n\n\tgetStateToSave,\n\tgetSubstate,\n\n\tgetUpdatePermissionByKey,\n\tgetUsedKeysForComponent,\n\n\thaveAllKeysRegisteredUse,\n};\n","import {createSelector} from 'reselect';\nimport {\n\tcreateObserver as createRecomputeObserver,\n\tcreateSelector as createRecomputeSelector,\n} from '@jvitela/recompute';\nimport {isEmpty as _isEmpty, get as _get} from 'lodash';\n\nconst getAllByKey = state => state.components;\nconst getAllByKeyObserver = createRecomputeObserver(getAllByKey);\n\n/**\n * @param state {Object}\n * @param componentKey {string}\n * @return {Object} component data\n */\nconst getByComponentKey = createSelector(\n\t[getAllByKey, (state, key) => key],\n\t(components, key) => {\n\t\tif (components && key && components[key]) {\n\t\t\treturn components[key];\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\n/**\n * @param componentKey {string}\n * @return {Object} component data\n */\nconst getByComponentKey_recompute = createRecomputeSelector(componentKey => {\n\tif (componentKey) {\n\t\tconst components = getAllByKeyObserver();\n\t\tif (!_isEmpty(components)) {\n\t\t\treturn components[componentKey] || null;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t} else {\n\t\treturn null;\n\t}\n});\n\n/**\n * Get value from given path\n * @param state {Object}\n * @param componentKey {string}\n * @param path {string}\n * @return {*} value\n */\nconst get = createSelector(\n\t[getByComponentKey, (state, key, path) => path],\n\t(componentState, path) => _get(componentState, path, null)\n);\n\nexport default {\n\tget,\n\tgetAllByKeyObserver,\n\tgetByComponentKey,\n\tgetByComponentKey_recompute,\n\n\tgetStateToSave: getAllByKey,\n\tgetSubstate: getAllByKey,\n};\n","import stringify from 'fast-stringify';\n\n// Use fast-stringify instead of default JSON.stringify to get cache key\nconst serialize = args => stringify(args);\n\nexport const recomputeSelectorOptions = {serialize};\n","import common from '../../_common/selectors';\nimport {\n\tcreateObserver as createRecomputeObserver,\n\tcreateSelector as createRecomputeSelector,\n} from '@jvitela/recompute';\nimport {forEach as _forEach, filter as _filter} from 'lodash';\nimport {recomputeSelectorOptions} from '../../_common/recomputeHelpers';\n\nconst getSubstate = state => state.data.attributeRelations;\n\nconst getIndex = common.getIndex(getSubstate);\nconst getIndex_recompute = common.getIndex_recompute(getSubstate);\n\n/**\n * It returns relation model for given key, if exists\n * @param key {string} relation key\n * @return {Object} attribute relation\n */\nconst getByKeyObserver = createRecomputeObserver((state, key) => {\n\treturn getSubstate(state)?.byKey?.[key] || null;\n});\n\n/**\n * It returns relation models for given keys\n * @param keys {Array} relation keys\n * @return {Array} A collection of relations\n */\nconst getByKeys = createRecomputeSelector(keys => {\n\tif (keys?.length) {\n\t\tlet relations = [];\n\t\tkeys.forEach(key => {\n\t\t\tconst relation = getByKeyObserver(key);\n\t\t\tif (relation) {\n\t\t\t\trelations.push(relation);\n\t\t\t}\n\t\t});\n\t\treturn relations.length ? relations : null;\n\t} else {\n\t\treturn null;\n\t}\n}, recomputeSelectorOptions);\n\n/**\n * It returns a collection of indexed relations for given filter\n * @param filter {Object}\n * @return {Array}\n */\nconst getIndexed = createRecomputeSelector(filter => {\n\tconst index = getIndex_recompute(filter, null);\n\tif (index?.index) {\n\t\t// filter only uuids (not true or false values of index)\n\t\tconst keys = _filter(\n\t\t\tObject.values(index.index),\n\t\t\tkey => typeof key === 'string'\n\t\t);\n\t\tif (keys?.length) {\n\t\t\treturn getByKeys(keys);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t} else {\n\t\treturn null;\n\t}\n}, recomputeSelectorOptions);\n\n/**\n * It returns key-value pairs, where the key is attribute data source key and the value is attribute key\n * @param filter {Object} attribute relation filter\n * @return {Object}\n */\nconst getFilteredAttributeDataSourceKeyAttributeKeyPairs = createRecomputeSelector(\n\tfilter => {\n\t\tconst relations = getIndexed(filter);\n\t\tif (relations) {\n\t\t\tconst pairs = {};\n\t\t\t_forEach(relations, relation => {\n\t\t\t\tpairs[relation.data.attributeDataSourceKey] =\n\t\t\t\t\trelation.data.attributeKey;\n\t\t\t});\n\t\t\treturn pairs;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t},\n\trecomputeSelectorOptions\n);\n\nexport default {\n\tgetByKeyObserver,\n\tgetByKeys,\n\tgetFilteredAttributeDataSourceKeyAttributeKeyPairs,\n\tgetIndexed,\n\tgetIndex,\n};\n","import {\n\tcreateSelector as createRecomputeSelector,\n\tcreateObserver as createRecomputeObserver,\n} from '@jvitela/recompute';\nimport common from '../../_common/selectors';\nimport {recomputeSelectorOptions} from '../../_common/recomputeHelpers';\n\nconst getSubstate = state => state.data.attributeDataSources;\n\nconst getIndex = common.getIndex(getSubstate);\nconst getIndex_recompute = common.getIndex_recompute(getSubstate);\n\n/**\n * It returns data source model for given key, if exists\n * @param key {string} data source key\n * @return {Object} attribute data source model\n */\nconst getByKeyObserver = createRecomputeObserver((state, key) => {\n\treturn getSubstate(state)?.byKey?.[key] || null;\n});\n\n/**\n * It returns data source models for given keys\n * @param keys {Array} data source keys\n * @return {Array} A collection of data source models\n */\nconst getByKeys = createRecomputeSelector(keys => {\n\tif (keys?.length) {\n\t\tlet dataSources = [];\n\t\tkeys.forEach(key => {\n\t\t\tconst dataSource = getByKeyObserver(key);\n\t\t\tif (dataSource) {\n\t\t\t\tdataSources.push(dataSource);\n\t\t\t}\n\t\t});\n\t\treturn dataSources.length ? dataSources : null;\n\t} else {\n\t\treturn null;\n\t}\n}, recomputeSelectorOptions);\n\n/**\n * It returns a collection of indexed data sources for given filter\n * @param filter {Object}\n * @return {Array}\n */\nconst getIndexed = createRecomputeSelector(filter => {\n\tconst index = getIndex_recompute(filter, null);\n\tif (index?.index) {\n\t\tlet keys = Object.values(index.index);\n\t\tif (keys?.length) {\n\t\t\treturn getByKeys(keys);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t} else {\n\t\treturn null;\n\t}\n}, recomputeSelectorOptions);\n\nexport default {\n\tgetByKeyObserver,\n\tgetByKeys,\n\tgetIndexed,\n\tgetIndex,\n\tgetIndex_recompute,\n};\n","import {\n\tisEmpty as _isEmpty,\n\tforEach as _forEach,\n\tforIn as _forIn,\n\tisNumber as _isNumber,\n} from 'lodash';\n\nimport {\n\tcreateObserver as createRecomputeObserver,\n\tcreateSelector as createRecomputeSelector,\n} from '@jvitela/recompute';\nimport common from '../../_common/selectors';\nimport commonHelpers from '../../_common/helpers';\nimport {recomputeSelectorOptions} from '../../_common/recomputeHelpers';\n\nconst getSubstate = state => state.data.attributeData;\n\nconst getIndex = common.getIndexByPath(getSubstate);\n\n// Recompute observers ---------------------------------------------------------\n\nconst getAllAsObjectObserver = createRecomputeObserver(\n\tstate => getSubstate(state).byDataSourceKey\n);\nconst getIndexesObserver = createRecomputeObserver(\n\tstate => getSubstate(state).indexes\n);\nconst getSpatialIndexesObserver = createRecomputeObserver(\n\tstate => getSubstate(state).spatialIndexes\n);\n\n/**\n * It returns all data for given datasource key\n * @param key {string} data source key\n * @returns {Object} Features as object (by feature key)\n */\nconst getByDataSourceKeyObserver = createRecomputeObserver((state, key) => {\n\treturn getSubstate(state)?.byDataSourceKey?.[key] || null;\n});\n\n/**\n * It returns whole index for given filter & order\n * @param {Object} filter\n * @param {Array} order\n * @return {Object} index\n */\nconst getIndex_recompute = createRecomputeSelector((filter, order) => {\n\tconst indexes = getIndexesObserver();\n\tif (indexes && !_isEmpty(indexes)) {\n\t\treturn commonHelpers.getIndex(indexes, filter, order);\n\t} else {\n\t\treturn null;\n\t}\n}, recomputeSelectorOptions);\n\n/**\n * It returns whole spatial index for given filter & order\n * @param {Object} filter\n * @param {Array} order\n * @return {Object} index\n */\nconst getSpatialIndex_recompute = createRecomputeSelector((filter, order) => {\n\tconst indexes = getSpatialIndexesObserver();\n\tif (indexes && !_isEmpty(indexes)) {\n\t\treturn commonHelpers.getIndex(indexes, filter, order);\n\t} else {\n\t\treturn null;\n\t}\n}, recomputeSelectorOptions);\n\n/**\n * It returns attributes data (an object containing featureKey-attributeValue pairs) grouped by data source key\n * @param dataSourceKeys {Array}\n * @return {Object}\n */\nconst getDataByDataSourceKeys = createRecomputeSelector(dataSourceKeys => {\n\tif (dataSourceKeys) {\n\t\tlet data = {};\n\t\t_forEach(dataSourceKeys, key => {\n\t\t\tconst attributes = getByDataSourceKeyObserver(key);\n\t\t\tif (attributes && !_isEmpty(attributes)) {\n\t\t\t\tdata[key] = attributes;\n\t\t\t}\n\t\t});\n\n\t\treturn !_isEmpty(data) ? data : null;\n\t} else {\n\t\treturn null;\n\t}\n}, recomputeSelectorOptions);\n\n/**\n * It returns attribute values for given feature key grouped by data source key\n * @param attributeDataSourceKeyAttributeKeyPairs {Object} key-value pairs, where the key is attribute data source key and the value is matching attribute key\n * @param featureKey {string | number}\n * @return {Object} attributeDataSource key - attribute value pairs\n */\nconst getAttributesByDataSourceKeysForFeatureKey = createRecomputeSelector(\n\t(attributeDataSourceKeyAttributeKeyPairs, featureKey) => {\n\t\tif (attributeDataSourceKeyAttributeKeyPairs && featureKey) {\n\t\t\tconst dataSourceKeys = Object.keys(\n\t\t\t\tattributeDataSourceKeyAttributeKeyPairs\n\t\t\t);\n\t\t\tconst dataByDataSourceKey = getDataByDataSourceKeys(dataSourceKeys);\n\t\t\tif (dataByDataSourceKey) {\n\t\t\t\tlet attributes = {};\n\t\t\t\t_forIn(dataByDataSourceKey, (dataSourceData, dataSourceKey) => {\n\t\t\t\t\tif (dataSourceData.hasOwnProperty(featureKey)) {\n\t\t\t\t\t\tconst value = dataSourceData[featureKey];\n\t\t\t\t\t\tconst attributeKey =\n\t\t\t\t\t\t\tattributeDataSourceKeyAttributeKeyPairs[dataSourceKey];\n\n\t\t\t\t\t\tif (attributeKey) {\n\t\t\t\t\t\t\tattributes[attributeKey] = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn !_isEmpty(attributes) ? attributes : null;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t},\n\trecomputeSelectorOptions\n);\n\n/**\n * It returns indexed feature keys grouped by attribute data source keys\n * @param {Object} filter\n * @param {number} level\n * @param {string} tile\n * @return {Object}\n */\nconst getSpatiallyIndexedFeatureKeysByDataSourceKeys = createRecomputeSelector(\n\t(filter, level, tile) => {\n\t\tconst spatialIndex = getSpatialIndex_recompute(filter, null);\n\t\tif (spatialIndex?.index && !_isEmpty(spatialIndex)) {\n\t\t\tconst featureKeysByDataSourceKeys = spatialIndex.index[level]?.[tile];\n\t\t\treturn featureKeysByDataSourceKeys || null;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t},\n\trecomputeSelectorOptions\n);\n\n/**\n * @param {Object} filter\n * @param {number} level\n * @param {string} tile\n * @param {string} dataSourceKey\n * @return {Array} indexed feature keys\n */\nconst isTileLoading = createRecomputeSelector((filter, level, tile) => {\n\tif (_isNumber(level) && tile) {\n\t\tconst index = getSpatialIndex_recompute(filter, null);\n\t\tif (index) {\n\t\t\tconst tileIndex = index?.index[level]?.[tile];\n\t\t\treturn tileIndex === true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\treturn false;\n\t}\n}, recomputeSelectorOptions);\n\nexport default {\n\tgetAllAsObjectObserver,\n\tgetByDataSourceKeyObserver,\n\tgetIndex,\n\tgetIndex_recompute,\n\tgetIndexesObserver,\n\tgetSpatialIndex_recompute,\n\tgetSpatialIndexesObserver,\n\tgetDataByDataSourceKeys,\n\tgetAttributesByDataSourceKeysForFeatureKey,\n\tgetSpatiallyIndexedFeatureKeysByDataSourceKeys,\n\tisTileLoading,\n\n\tgetSubstate,\n};\n","import {\n\tcreateObserver as createRecomputeObserver,\n\tcreateSelector as createRecomputeSelector,\n} from '@jvitela/recompute';\nimport createCachedSelector from 're-reselect';\nimport {\n\tisEmpty as _isEmpty,\n\tforIn as _forIn,\n\tisMatch as _isMatch,\n\tisNumber as _isNumber,\n\tincludes as _includes,\n} from 'lodash';\n\nimport commonHelpers from '../../_common/helpers';\nimport commonSelectors from '../../_common/selectors';\nimport attributeDataSelectors from '../AttributeData/selectors';\nimport attributeRelationsSelectors from '../AttributeRelations/selectors';\nimport componentsSelectors from '../../Components/selectors';\n\nconst getAllComponentsInUse = state => state.data.components.components.inUse;\nconst getComponentStateByKey = (state, key) =>\n\tstate.data.components.components.byKey[key] || null;\n\nconst getComponentStateByKeyObserver = createRecomputeObserver(\n\tgetComponentStateByKey\n);\n\n/**\n * Check if component is in use\n * @param state {Object}\n * @param componentKey {string}\n * @return {boolean}\n */\nconst isComponentInUse = createCachedSelector(\n\t[getAllComponentsInUse, (state, componentKey) => componentKey],\n\t(componentsInUse, componentKey) => {\n\t\tif (componentsInUse?.length && componentKey) {\n\t\t\treturn !!_includes(componentsInUse, componentKey);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n)((state, componentKey) => componentKey);\n\n/**\n * Check if component's filter by active matches give filterByActive\n * @param state {Object}\n * @param componentKey {string}\n * @param filterByActive {Object} {scope: true, place: true, ...}\n * @return {boolean}\n */\nconst componentMatchesFilterByActive = createCachedSelector(\n\t[\n\t\tgetComponentStateByKey,\n\t\t(state, componentKey, filterByActive) => filterByActive,\n\t],\n\t(componentState, filterByActive) => {\n\t\tif (componentState?.filterByActive && filterByActive) {\n\t\t\treturn _isMatch(componentState.filterByActive, filterByActive);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n)(\n\t(state, componentKey, filterByActive) =>\n\t\t`${componentKey}_${JSON.stringify(filterByActive)}`\n);\n\n/**\n * Get filter params which are specific for attribute data\n * @param componentKey {string}\n * @return {Object}\n */\nconst getAttributeDataFilterExtensionByComponentKey = createRecomputeSelector(\n\tcomponentKey => {\n\t\tconst componentState = getComponentStateByKeyObserver(componentKey);\n\n\t\tif (componentState) {\n\t\t\tconst {\n\t\t\t\tattributeFilter,\n\t\t\t\tdataSourceKeys,\n\t\t\t\tfeatureKeys,\n\t\t\t\tspatialFilter,\n\t\t\t} = componentState;\n\n\t\t\treturn {\n\t\t\t\t...(attributeFilter !== undefined && {attributeFilter}),\n\t\t\t\t...(dataSourceKeys !== undefined && {dataSourceKeys}),\n\t\t\t\t...(featureKeys !== undefined && {featureKeys}),\n\t\t\t\t...(spatialFilter !== undefined && {spatialFilter}),\n\t\t\t};\n\t\t} else {\n\t\t\treturn {};\n\t\t}\n\t}\n);\n\n/**\n * Get filter params which are common to both attributeRelations and attributeData\n * @param componentKey {string}\n * @return {{modifiers: Object, areaTreeLevelKey: string, layerTemplateKey: string, attributeKeys: Array}}\n */\nconst getCommonFilterByComponentKey = createRecomputeSelector(componentKey => {\n\tconst componentState = getComponentStateByKeyObserver(componentKey);\n\n\tif (componentState) {\n\t\tconst {\n\t\t\tareaTreeLevelKey,\n\t\t\tattributeKeys,\n\t\t\tfilterByActive,\n\t\t\tlayerTemplateKey,\n\t\t\tmetadataModifiers,\n\t\t} = componentState;\n\n\t\t// modifiers defined by key\n\t\tconst metadataDefinedByKey = metadataModifiers\n\t\t\t? {...metadataModifiers}\n\t\t\t: {};\n\n\t\tif (layerTemplateKey) {\n\t\t\tmetadataDefinedByKey[layerTemplateKey] = layerTemplateKey;\n\t\t} else if (areaTreeLevelKey) {\n\t\t\tmetadataDefinedByKey[areaTreeLevelKey] = areaTreeLevelKey;\n\t\t}\n\n\t\t// Get actual metadata keys defined by filterByActive\n\t\tconst activeMetadataKeys = filterByActive\n\t\t\t? commonSelectors.getActiveKeysByFilterByActiveObserver(filterByActive)\n\t\t\t: null;\n\n\t\t// Merge metadata, metadata defined by key have priority\n\t\tconst mergedMetadataKeys = commonHelpers.mergeMetadataKeys(\n\t\t\tmetadataDefinedByKey,\n\t\t\tactiveMetadataKeys\n\t\t);\n\n\t\t// Decouple modifiers from templates\n\t\tconst {\n\t\t\tareaTreeLevelKey: modifiedAreaTreeLevelKey,\n\t\t\tlayerTemplateKey: modifiedLayerTemplateKey,\n\t\t\t...modifiers\n\t\t} = mergedMetadataKeys;\n\n\t\t// It converts modifiers from metadataKeys: [\"A\", \"B\"] to metadataKey: {in: [\"A\", \"B\"]}\n\t\tconst modifiersForRequest = commonHelpers.convertModifiersToRequestFriendlyFormat(\n\t\t\tmodifiers\n\t\t);\n\n\t\treturn {\n\t\t\tmodifiers: modifiersForRequest,\n\t\t\t...(areaTreeLevelKey !== undefined && {areaTreeLevelKey}),\n\t\t\t...(layerTemplateKey !== undefined && {layerTemplateKey}),\n\t\t\t...(attributeKeys !== undefined && {attributeKeys}),\n\t\t};\n\t} else {\n\t\treturn {};\n\t}\n});\n\n/**\n * Select attribute data indexes by component key\n * @param componentKey {string}\n */\nconst getIndexForAttributeDataByComponentKey = createRecomputeSelector(\n\tcomponentKey => {\n\t\tconst componentState = getComponentStateByKeyObserver(componentKey);\n\n\t\tif (componentState) {\n\t\t\tconst {attributeOrder} = componentState;\n\n\t\t\tconst attributeDataFilterExtension = getAttributeDataFilterExtensionByComponentKey(\n\t\t\t\tcomponentKey\n\t\t\t);\n\n\t\t\tconst commonFilter = getCommonFilterByComponentKey(componentKey);\n\n\t\t\tconst attributeDataFilter = {\n\t\t\t\t...commonFilter,\n\t\t\t\t...attributeDataFilterExtension,\n\t\t\t};\n\n\t\t\tconst attributeDataIndex =\n\t\t\t\tattributeDataSelectors.getIndex_recompute(\n\t\t\t\t\tattributeDataFilter,\n\t\t\t\t\tattributeOrder\n\t\t\t\t) || [];\n\n\t\t\treturn !_isEmpty(attributeDataIndex) ? attributeDataIndex : null;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\n// Data selectors ------------------------------------------------------------------------------------------------------\n\n/**\n * General selector for assembling attribute data for component\n * @param componentKey {string}\n * @return {Array} A collection of features, where each feature has following format: {featureKey: string, data: {attributeKey: string|number|boolean|null}}\n */\nconst getData = createRecomputeSelector(componentKey => {\n\tconst componentState = getComponentStateByKeyObserver(componentKey);\n\tif (componentState) {\n\t\t// TODO cached selector for data of only relevant data sources needed!!!\n\t\tconst data = attributeDataSelectors.getAllAsObjectObserver();\n\t\tconst attributeKeys = componentState?.attributeKeys;\n\n\t\tif (!_isEmpty(data) && attributeKeys?.length) {\n\t\t\tconst attributeDataFilterExtension = getAttributeDataFilterExtensionByComponentKey(\n\t\t\t\tcomponentKey\n\t\t\t);\n\n\t\t\tconst commonFilter = getCommonFilterByComponentKey(componentKey);\n\n\t\t\tconst attributeFilter = {\n\t\t\t\t...commonFilter,\n\t\t\t\t...attributeDataFilterExtension,\n\t\t\t};\n\n\t\t\tconst attributeOrder = componentState.attributeOrder || null;\n\n\t\t\tconst relationsFilter = {\n\t\t\t\t...commonFilter,\n\t\t\t};\n\n\t\t\t// Get relations\n\t\t\tconst attributeRelations = attributeRelationsSelectors.getIndexed(\n\t\t\t\trelationsFilter\n\t\t\t);\n\n\t\t\tif (attributeRelations?.length) {\n\t\t\t\t// Get from relations, which data source is associated with which attribute\n\t\t\t\tlet attributeDsKeyAttributeKeyPairs = {};\n\t\t\t\tattributeRelations.forEach(relation => {\n\t\t\t\t\tattributeDsKeyAttributeKeyPairs[\n\t\t\t\t\t\trelation.data.attributeDataSourceKey\n\t\t\t\t\t] = relation.data.attributeKey;\n\t\t\t\t});\n\n\t\t\t\t// Find data index\n\t\t\t\t// TODO more sophisticated index with attributeFilter & attributeOrder\n\t\t\t\tconst attributeDataIndex = attributeDataSelectors.getIndex_recompute(\n\t\t\t\t\tattributeFilter,\n\t\t\t\t\tattributeOrder\n\t\t\t\t);\n\n\t\t\t\t// Get indexed features\n\t\t\t\tlet indexedFeatureKeysAsObject = attributeDataIndex?.index;\n\n\t\t\t\tif (\n\t\t\t\t\tindexedFeatureKeysAsObject &&\n\t\t\t\t\t!_isEmpty(indexedFeatureKeysAsObject)\n\t\t\t\t) {\n\t\t\t\t\tlet {start, length} = componentState;\n\t\t\t\t\tstart = start || 1;\n\t\t\t\t\tlength = length || attributeDataIndex.count;\n\t\t\t\t\tlet end = Math.min(start + length - 1, attributeDataIndex.count);\n\n\t\t\t\t\tlet finalFeaturesAsObject = [];\n\n\t\t\t\t\t// Loop through indexed features\n\t\t\t\t\tfor (let i = start; i <= end; i++) {\n\t\t\t\t\t\tconst featureKey = indexedFeatureKeysAsObject[i];\n\t\t\t\t\t\tif (featureKey) {\n\t\t\t\t\t\t\t// We don't know which feature is in which attribute DS\n\t\t\t\t\t\t\t// also there could be more attributes for the feature\n\t\t\t\t\t\t\t_forIn(\n\t\t\t\t\t\t\t\tattributeDsKeyAttributeKeyPairs,\n\t\t\t\t\t\t\t\t(attributeKey, attributeDsKey) => {\n\t\t\t\t\t\t\t\t\tlet value = data[attributeDsKey]?.[featureKey];\n\n\t\t\t\t\t\t\t\t\tif (value !== undefined) {\n\t\t\t\t\t\t\t\t\t\t// existing feature\n\t\t\t\t\t\t\t\t\t\tif (finalFeaturesAsObject[i - start]) {\n\t\t\t\t\t\t\t\t\t\t\tfinalFeaturesAsObject[i - start].data[\n\t\t\t\t\t\t\t\t\t\t\t\tattributeKey\n\t\t\t\t\t\t\t\t\t\t\t] = value;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t// new feature\n\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\t// TODO temporary fix for buggy BE values datatype\n\t\t\t\t\t\t\t\t\t\t\tvalue = isNaN(value)\n\t\t\t\t\t\t\t\t\t\t\t\t? value\n\t\t\t\t\t\t\t\t\t\t\t\t: _isNumber(value)\n\t\t\t\t\t\t\t\t\t\t\t\t? value\n\t\t\t\t\t\t\t\t\t\t\t\t: Number(value);\n\n\t\t\t\t\t\t\t\t\t\t\t// TODO format?\n\t\t\t\t\t\t\t\t\t\t\tfinalFeaturesAsObject[i - start] = {\n\t\t\t\t\t\t\t\t\t\t\t\tkey: featureKey,\n\t\t\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t[attributeKey]: value,\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// no feature key at index\n\t\t\t\t\t\t\tfinalFeaturesAsObject.push(null);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn finalFeaturesAsObject;\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t} else {\n\t\treturn null;\n\t}\n});\n\n/**\n * Specific selector to assembling the attribute data & settings of the cartesian chart\n * @param props {Object} component props\n * @param props.stateComponentKey {string} component key, needed for data assembling\n * @return {Object} Cartesian chart data & settings\n */\nconst getDataForCartesianChart = createRecomputeSelector(props => {\n\tconst componentSettings = componentsSelectors.getByComponentKey_recompute(\n\t\tprops.stateComponentKey\n\t);\n\tconst chartSettings = {...componentSettings, ...props};\n\tconst data = getData(props.stateComponentKey);\n\n\treturn {\n\t\tdata: data || [],\n\t\t...chartSettings,\n\t};\n});\n\nexport default {\n\tcomponentMatchesFilterByActive,\n\n\tgetAllComponentsInUse,\n\tgetAttributeDataFilterExtensionByComponentKey,\n\tgetCommonFilterByComponentKey,\n\tgetComponentStateByKey,\n\tgetComponentStateByKeyObserver,\n\tgetIndexForAttributeDataByComponentKey,\n\n\tisComponentInUse,\n\n\t// Data selectors\n\tgetData,\n\tgetDataForCartesianChart,\n};\n","import common from '../../_common/selectors';\n\nconst getSubstate = state => state.data.spatialRelations;\n\nconst getIndex = common.getIndex(getSubstate);\n\nexport default {\n\tgetIndex,\n};\n","import {isEmpty as _isEmpty} from 'lodash';\nimport {\n\tcreateSelector as createRecomputeSelector,\n\tcreateObserver as createRecomputeObserver,\n} from '@jvitela/recompute';\n\nimport common from '../../_common/selectors';\nimport createCachedSelector from 're-reselect';\nimport commonHelpers from '../../_common/helpers';\nimport {recomputeSelectorOptions} from '../../_common/recomputeHelpers';\n\nconst getSubstate = state => state.data.spatialDataSources;\n\nconst getIndex = common.getIndex(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\n\nconst getIndexesObserver = createRecomputeObserver(state =>\n\tcommon.getIndexes(getSubstate)(state)\n);\n\n/**\n * It returns data source model for given key, if exists\n * @param key {string} data source key\n * @return {Object} Data source\n */\nconst getByKeyObserver = createRecomputeObserver((state, key) => {\n\treturn getSubstate(state)?.byKey?.[key] || null;\n});\n\n/**\n * It returns data source models for given keys, if exist\n * @param keys {Array} data source keys\n * @return {Array} A collection of data sources\n */\nconst getByKeys = createRecomputeSelector(keys => {\n\tif (keys?.length) {\n\t\tlet dataSources = [];\n\t\tkeys.forEach(key => {\n\t\t\tconst dataSource = getByKeyObserver(key);\n\t\t\tif (dataSource) {\n\t\t\t\tdataSources.push(dataSource);\n\t\t\t}\n\t\t});\n\t\treturn dataSources.length ? dataSources : null;\n\t} else {\n\t\treturn null;\n\t}\n}, recomputeSelectorOptions);\n\n/**\n * It returns whole index for given filter and order\n * @param filter {Object} Filter object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @param order {Array}\n * @return index {Object}\n */\nconst getIndex_recompute = createRecomputeSelector((filter, order) => {\n\tconst indexes = getIndexesObserver();\n\tif (indexes) {\n\t\treturn commonHelpers.getIndex(indexes, filter, order);\n\t} else {\n\t\treturn null;\n\t}\n}, recomputeSelectorOptions);\n\n/**\n * It returns a collection of indexed data sources for given filter\n * @param filter {Object} Filter object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @return {Array}\n */\nconst getIndexed_recompute = createRecomputeSelector(filter => {\n\tconst index = getIndex_recompute(filter, null);\n\tif (index?.index) {\n\t\tlet keys = Object.values(index.index);\n\t\tif (keys) {\n\t\t\treturn getByKeys(keys);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t} else {\n\t\treturn null;\n\t}\n}, recomputeSelectorOptions);\n\n/**\n * It returns a collection of indexed data sources for given filter.\n * @param state {Object}\n * @param filter {Object} Filter object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @return {Array}\n */\nconst getIndexed = createCachedSelector(\n\t[getIndex, getAllAsObject],\n\t(index, dataSources) => {\n\t\tif (!_isEmpty(index) && index.index) {\n\t\t\tconst dataSourceKeys = Object.values(index.index);\n\t\t\tif (!_isEmpty(dataSourceKeys)) {\n\t\t\t\tlet filteredDataSources = [];\n\t\t\t\tdataSourceKeys.forEach(dataSourceKey => {\n\t\t\t\t\tconst dataSource = dataSources[dataSourceKey];\n\t\t\t\t\tif (dataSource) {\n\t\t\t\t\t\tfilteredDataSources.push(dataSource);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (filteredDataSources.length > 0) {\n\t\t\t\t\treturn filteredDataSources;\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n)((state, filter) => {\n\treturn `${JSON.stringify(filter)}`;\n});\n\nexport default {\n\tgetByKeys,\n\tgetByKeyObserver,\n\n\tgetIndexesObserver,\n\tgetIndexed,\n\tgetIndexed_recompute,\n\tgetIndex,\n\tgetIndex_recompute,\n};\n","import common from '../../_common/selectors';\nimport {\n\tcreateSelector as createRecomputeSelector,\n\tcreateObserver as createRecomputeObserver,\n} from '@jvitela/recompute';\nimport commonHelpers from '../../_common/helpers';\nimport {recomputeSelectorOptions} from '../../_common/recomputeHelpers';\nimport {isNumber as _isNumber} from 'lodash';\nconst getSubstate = state => state.data.spatialData;\n\nconst getIndex = common.getIndex(getSubstate);\n\nconst getIndexesObserver = createRecomputeObserver(state =>\n\tcommon.getIndexes(getSubstate)(state)\n);\n\n/**\n * It returns all data for given datasource key\n * @param key {string} data source key\n * @returns {Object} Features as object (by feature key)\n */\nconst getByDataSourceKeyObserver = createRecomputeObserver((state, key) => {\n\treturn getSubstate(state)?.byDataSourceKey?.[key] || null;\n});\n\n/**\n * It returns whole index for given filter & order\n * @param {Object} filter\n * @param {Array} order\n * @return {Object} index\n */\nconst getIndex_recompute = createRecomputeSelector((filter, order) => {\n\tconst indexes = getIndexesObserver();\n\tif (indexes) {\n\t\treturn commonHelpers.getIndex(indexes, filter, order);\n\t} else {\n\t\treturn null;\n\t}\n}, recomputeSelectorOptions);\n\n/**\n * @param {Object} filter\n * @param {number} level\n * @param {string} tile\n * @param {string} dataSourceKey\n * @return {Array} indexed feature keys\n */\nconst getIndexedFeatureKeys = createRecomputeSelector(\n\t(filter, level, tile, dataSourceKey) => {\n\t\tif (_isNumber(level) && tile && dataSourceKey) {\n\t\t\tconst index = getIndex_recompute(filter, null);\n\t\t\tconst featureKeys = index?.index[level]?.[tile]?.[dataSourceKey];\n\t\t\treturn featureKeys && featureKeys.length ? featureKeys : null;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t},\n\trecomputeSelectorOptions\n);\n/**\n * @param {Object} filter\n * @param {number} level\n * @param {string} tile\n * @param {string} dataSourceKey\n * @return {Array} indexed feature keys\n */\nconst isTileLoading = createRecomputeSelector((filter, level, tile) => {\n\tif (_isNumber(level) && tile) {\n\t\tconst index = getIndex_recompute(filter, null);\n\t\tif (index) {\n\t\t\tconst loading = index.index?.[level]?.[tile];\n\t\t\treturn loading === true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\treturn false;\n\t}\n}, recomputeSelectorOptions);\n\nexport default {\n\tgetByDataSourceKeyObserver,\n\tgetIndex,\n\tgetIndex_recompute,\n\tgetIndexesObserver,\n\tgetIndexedFeatureKeys,\n\tisTileLoading,\n};\n","import {\n\tisArray as _isArray,\n\tisFinite as _isFinite,\n\treduce as _reduce,\n} from 'lodash';\n\nimport {configDefaults} from '@gisatcz/ptr-core';\n\n/**\n * Determinate decimal precision of number\n * @param {Number} number\n * @returns {Number}\n */\nexport const precision = number => {\n\tif (!Number.isFinite(number)) {\n\t\treturn 0;\n\t}\n\tlet e = 1,\n\t\tp = 0;\n\twhile (Math.round(number * e) / e !== number) {\n\t\te *= 10;\n\t\tp++;\n\t}\n\n\treturn p;\n};\n\n/**\n * Finite numbers are transformed to the decimal format and to the string.\n * Example: 2e-2 -> \"0.02\"\n * Example: 0.02 -> \"0.02\"\n * @param {Number} number\n * @returns {string?}\n */\nconst getNumberInDecimalString = number => {\n\tif (!Number.isFinite(number)) {\n\t\treturn null;\n\t}\n\n\tconst numberPrecision = precision(number);\n\treturn number.toFixed(numberPrecision);\n};\n\n/**\n * Returns array of strings representing given tile\n * @param {Array|string} tile\n * @returns {Array}\n */\nexport const tileAsStringArray = tile => {\n\tif (\n\t\t_isArray(tile) &&\n\t\ttypeof tile[0] === 'string' &&\n\t\ttypeof tile[1] === 'string'\n\t) {\n\t\treturn tile;\n\t} else if (_isArray(tile)) {\n\t\tconst arrTile = tileAsArray(tile);\n\t\tif (arrTile) {\n\t\t\t// return arrTile.map(getNumberInDecimalString).join(',');\n\t\t\treturn arrTile.map(getNumberInDecimalString);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t} else {\n\t\treturn null;\n\t}\n};\n\n/**\n * Returns string representing given tile\n * @param {Array|string} tile\n * @returns {string}\n */\nexport const tileAsString = tile => {\n\tif (typeof tile === 'string') {\n\t\treturn tile;\n\t} else {\n\t\tconst stringTile = tileAsStringArray(tile);\n\t\treturn stringTile ? stringTile.join(',') : null;\n\t}\n};\n\n/**\n * Converts tile as a string to array\n * @param {Array|string} tile\n * @returns {Array} Tile defined by Numbers in array\n */\nexport const tileAsArray = tile => {\n\tif (\n\t\ttypeof tile === 'string' &&\n\t\ttile.split(',').length > 1 &&\n\t\ttile.split(',').every(i => _isFinite(parseFloat(i)))\n\t) {\n\t\treturn tile.split(',').map(parseFloat);\n\t} else if (\n\t\t_isArray(tile) &&\n\t\ttile.length !== 1 &&\n\t\ttile.every(i => _isFinite(parseFloat(i)))\n\t) {\n\t\treturn tile.map(parseFloat);\n\t} else if (_isArray(tile) && tile.length === 1) {\n\t\treturn tileAsArray(tile[0]);\n\t} else {\n\t\treturn null;\n\t}\n};\n\n/**\n * Compare wanted tiles from filter with already loaded or loading tiles and give array of missing tiles in string format\n * @param {Object} index Already loaded index\n * @param {Object} filter Required filter\n * @param {Array.<string|Array.<number>>} filter.tiles\n * @param {number} filter.level\n * @returns {Array?} Array of missing tiles in stringArray format\n */\nexport const getMissingTiles = (index, filter) => {\n\tif (index && index.index && filter && _isArray(filter.tiles)) {\n\t\t//index contains level\n\t\tif (index.index?.[filter.level]) {\n\t\t\tconst loadedTilesInIndex = _reduce(\n\t\t\t\tindex.index[filter.level],\n\t\t\t\t(acc, tileData, tileKey) => {\n\t\t\t\t\t//tileData === true means it is loading, so we mark them as not missing\n\t\t\t\t\tif (tileData) {\n\t\t\t\t\t\t//re-save tile as array to prevent negative zero\n\t\t\t\t\t\treturn [...acc, tileAsString(tileKey)];\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn acc;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t[]\n\t\t\t);\n\t\t\tconst missingTiles = filter.tiles.filter(\n\t\t\t\ttile => !loadedTilesInIndex.includes(tileAsString(tile))\n\t\t\t);\n\t\t\treturn missingTiles;\n\t\t} else {\n\t\t\t// no data for requested level\n\t\t\t// all tiles are missing\n\t\t\treturn filter.tiles.map(tile => tileAsStringArray(tile));\n\t\t}\n\t} else {\n\t\tif (_isArray(filter?.tiles)) {\n\t\t\t// all tiles are missing\n\t\t\treturn filter.tiles.map(tile => tileAsStringArray(tile));\n\t\t} else {\n\t\t\t//filter is not defined\n\t\t\treturn null;\n\t\t}\n\t}\n};\n\n/**\n * Central method for getting PAGE_SIZE from state or configDefaults.\n * @param {Object} localConfig Configuration with overrides\n * @return {Number}\n */\nexport function getPageSize(localConfig) {\n\tconst PAGE_SIZE =\n\t\tlocalConfig?.requestPageSize || configDefaults.requestPageSize;\n\treturn PAGE_SIZE;\n}\n","import {createSelector as createRecomputeSelector} from '@jvitela/recompute';\nimport {map as _map, forIn as _forIn, forEach as _forEach} from 'lodash';\nimport stringify from 'fast-stringify';\nimport {CacheFifo} from '@gisatcz/ptr-utils';\n\nimport attributeRelations from './AttributeRelations/selectors';\nimport attributeDataSources from './AttributeDataSources/selectors';\nimport attributeData from './AttributeData/selectors';\nimport components from './Components/selectors';\nimport spatialRelations from './SpatialRelations/selectors';\nimport spatialDataSources from './SpatialDataSources/selectors';\nimport spatialData from './SpatialData/selectors';\nimport {tileAsString} from './helpers';\nimport {recomputeSelectorOptions} from '../_common/recomputeHelpers';\n\nlet tilesCache = new CacheFifo(1000);\n\n/**\n * @param dataSourceKey {string} uuid\n * @param fidColumnName {string} name of property used as feature identifier\n * @param attributeDataSourceKeyAttributeKeyPairs {Object} key-value pairs, where key is attribute data source key and value is matching attribute key\n */\nconst getFeatures = createRecomputeSelector(\n\t(dataSourceKey, fidColumnName, attributeDataSourceKeyAttributeKeyPairs) => {\n\t\tconst data = spatialData.getByDataSourceKeyObserver(dataSourceKey);\n\t\tlet attributesByDataSourceKey = null;\n\n\t\tif (attributeDataSourceKeyAttributeKeyPairs) {\n\t\t\tattributesByDataSourceKey = attributeData.getDataByDataSourceKeys(\n\t\t\t\tObject.keys(attributeDataSourceKeyAttributeKeyPairs)\n\t\t\t);\n\t\t}\n\n\t\tif (data) {\n\t\t\treturn _map(data, (feature, key) => {\n\t\t\t\tlet properties = {\n\t\t\t\t\t[fidColumnName]: key, // TODO fix dependency on this in ptr-maps\n\t\t\t\t};\n\n\t\t\t\tif (attributesByDataSourceKey) {\n\t\t\t\t\t_forIn(\n\t\t\t\t\t\tattributesByDataSourceKey,\n\t\t\t\t\t\t(features, attributeDataSourceKey) => {\n\t\t\t\t\t\t\tconst attributeValue = features[key];\n\t\t\t\t\t\t\tif (attributeValue) {\n\t\t\t\t\t\t\t\tproperties[\n\t\t\t\t\t\t\t\t\tattributeDataSourceKeyAttributeKeyPairs[\n\t\t\t\t\t\t\t\t\t\tattributeDataSourceKey\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t] = attributeValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\ttype: 'Feature',\n\t\t\t\t\tkey,\n\t\t\t\t\tgeometry: feature.geometry,\n\t\t\t\t\tproperties,\n\t\t\t\t};\n\t\t\t});\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t},\n\trecomputeSelectorOptions\n);\n\n/**\n * Assemble vector data for single tile\n * @param dataSourceKey {string} uuid\n * @param fidColumnName {string} name of property used as feature identifier\n * @param level {number}\n * @param tile {Array} tile definition point\n * @param spatialRelationsFilter {Object} getSpatialRelationsFilterFromLayerState\n * @param attributeRelationsFilter {Object} getAttributeRelationsFilterFromLayerState\n * @param attributeDataSourceKeyAttributeKeyPairs {Object} key-value pairs, where key is attribute data source key and value is matching attribute key\n * @param styleKey {string} uuid\n * @param attributeDataFilter {Object} Filter object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @return {Object} populated tile (with feature's geometries and attributes)\n */\nconst getTile = createRecomputeSelector(\n\t(\n\t\tspatialDataSourceKey,\n\t\tfidColumnName,\n\t\tlevel,\n\t\ttile,\n\t\tspatialRelationsFilter,\n\t\tattributeRelationsFilter,\n\t\tattributeDataSourceKeyAttributeKeyPairs,\n\t\tstyleKey,\n\t\tattributeDataFilter\n\t) => {\n\t\t// Get all data for given key. It caused performance issues when the data was passed as a parameter\n\t\tconst spatialDataForDataSource = spatialData.getByDataSourceKeyObserver(\n\t\t\tspatialDataSourceKey\n\t\t);\n\n\t\tif (spatialDataForDataSource) {\n\t\t\tconst tileString = tileAsString(tile);\n\t\t\tconst cacheParams = {\n\t\t\t\tattributeRelationsFilter,\n\t\t\t\tattributeDataFilter,\n\t\t\t\tspatialRelationsFilter,\n\t\t\t\tlevel,\n\t\t\t\ttileString,\n\t\t\t\tspatialDataSourceKey,\n\t\t\t\tstyleKey,\n\t\t\t};\n\t\t\tconst indexedFeatureKeys = spatialData.getIndexedFeatureKeys(\n\t\t\t\tspatialRelationsFilter,\n\t\t\t\tlevel,\n\t\t\t\ttileString,\n\t\t\t\tspatialDataSourceKey\n\t\t\t);\n\t\t\tconst indexedFeatureKeysByAttributeDataSourceKeys = attributeData.getSpatiallyIndexedFeatureKeysByDataSourceKeys(\n\t\t\t\tattributeDataFilter,\n\t\t\t\tlevel,\n\t\t\t\ttileString\n\t\t\t);\n\t\t\tconst cacheKey = stringify({\n\t\t\t\tcacheParams,\n\t\t\t\tindexedFeatureKeys,\n\t\t\t\tindexedFeatureKeysByAttributeDataSourceKeys,\n\t\t\t});\n\t\t\tconst cache = tilesCache.findByKey(cacheKey);\n\t\t\tif (cache) {\n\t\t\t\treturn cache.data;\n\t\t\t} else {\n\t\t\t\tif (indexedFeatureKeys?.length) {\n\t\t\t\t\tlet features = [];\n\n\t\t\t\t\tindexedFeatureKeys.forEach(key => {\n\t\t\t\t\t\tlet properties = {\n\t\t\t\t\t\t\t[fidColumnName]: key,\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// TODO what if some geometries is missing\n\t\t\t\t\t\tconst geometry =\n\t\t\t\t\t\t\tspatialDataForDataSource[key]?.geometry ||\n\t\t\t\t\t\t\tspatialDataForDataSource[key]?.geometries?.[level];\n\n\t\t\t\t\t\tif (attributeDataSourceKeyAttributeKeyPairs) {\n\t\t\t\t\t\t\tconst attributes = attributeData.getAttributesByDataSourceKeysForFeatureKey(\n\t\t\t\t\t\t\t\tattributeDataSourceKeyAttributeKeyPairs,\n\t\t\t\t\t\t\t\tkey\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (attributes) {\n\t\t\t\t\t\t\t\tproperties = {...properties, ...attributes};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (geometry) {\n\t\t\t\t\t\t\tfeatures.push({\n\t\t\t\t\t\t\t\ttype: 'Feature',\n\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\tgeometry,\n\t\t\t\t\t\t\t\tproperties,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tconst data = {\n\t\t\t\t\t\tfeatures: features.length ? features : null,\n\t\t\t\t\t\ttile: tileString,\n\t\t\t\t\t\tlevel,\n\t\t\t\t\t};\n\n\t\t\t\t\ttilesCache.addOrUpdate({\n\t\t\t\t\t\tcacheKey,\n\t\t\t\t\t\tdata,\n\t\t\t\t\t});\n\n\t\t\t\t\treturn data;\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t},\n\trecomputeSelectorOptions\n);\n\n/**\n * Assemble vector data for all tiles\n * @param dataSourceKey {string} uuid\n * @param fidColumnName {string} name of property used as feature identifier\n * @param level {number}\n * @param tiles {Array} list of tiles definition points\n * @param spatialRelationsFilter {Object} getSpatialRelationsFilterFromLayerState\n * @param attributeRelationsFilter {Object} getAttributeRelationsFilterFromLayerState\n * @param attributeDataSourceKeyAttributeKeyPairs {Object} key-value pairs, where key is attribute data source key and value is matching attribute key\n * @param styleKey {string} uuid\n * @param attributeDataFilter {Object} Filter object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @return {Array} a collection of populated tiles (with feature's geometries and attributes)\n */\nconst getTiles = createRecomputeSelector(\n\t(\n\t\tdataSourceKey,\n\t\tfidColumnName,\n\t\tlevel,\n\t\ttiles,\n\t\tspatialRelationsFilter,\n\t\tattributeRelationsFilter,\n\t\tattributeDataSourceKeyAttributeKeyPairs,\n\t\tstyleKey,\n\t\tattributeDataFilter\n\t) => {\n\t\tif (tiles?.length) {\n\t\t\tlet populatedTiles = [];\n\t\t\t_forEach(tiles, tile => {\n\t\t\t\tconst populatedTile = getTile(\n\t\t\t\t\tdataSourceKey,\n\t\t\t\t\tfidColumnName,\n\t\t\t\t\tlevel,\n\t\t\t\t\ttile,\n\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\tattributeDataSourceKeyAttributeKeyPairs,\n\t\t\t\t\tstyleKey,\n\t\t\t\t\tattributeDataFilter\n\t\t\t\t);\n\t\t\t\tif (populatedTile) {\n\t\t\t\t\tpopulatedTiles.push(populatedTile);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn populatedTiles.length ? populatedTiles : null;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t},\n\trecomputeSelectorOptions\n);\n\nexport default {\n\tgetFeatures,\n\tgetTile,\n\tgetTiles,\n\n\tattributeData,\n\tattributeDataSources,\n\tattributeRelations,\n\tcomponents,\n\tspatialData,\n\tspatialDataSources,\n\tspatialRelations,\n};\n","import common from '../_common/selectors';\n\nconst getSubstate = state => state.layerTemplates;\n\nconst getActive = common.getActive(getSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\nconst getActiveKeys = common.getActiveKeys(getSubstate);\nconst getActiveModels = common.getActiveModels(getSubstate);\nconst getAll = common.getAll(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\n\nconst getByKey = common.getByKey(getSubstate);\nconst getByKeys = common.getByKeys(getSubstate);\nconst getByKeysAsObject = common.getByKeysAsObject(getSubstate);\n\nconst getDataByKey = common.getDataByKey(getSubstate);\nconst getDeletePermissionByKey = common.getDeletePermissionByKey(getSubstate);\n\nconst getEditedActive = common.getEditedActive(getSubstate);\nconst getEditedAll = common.getEditedAll(getSubstate);\nconst getEditedAllAsObject = common.getEditedAllAsObject(getSubstate);\nconst getEditedByKey = common.getEditedByKey(getSubstate);\nconst getEditedDataByKey = common.getEditedDataByKey(getSubstate);\nconst getEditedKeys = common.getEditedKeys(getSubstate);\n\nconst getIndexed = common.getIndexed(getSubstate);\nconst getStateToSave = common.getStateToSave(getSubstate);\nconst getUpdatePermissionByKey = common.getUpdatePermissionByKey(getSubstate);\nconst getUsedKeysForComponent = common.getUsedKeysForComponent(getSubstate);\nconst haveAllKeysRegisteredUse = common.haveAllKeysRegisteredUse(getSubstate);\n\nexport default {\n\tgetActive,\n\tgetActiveKey,\n\tgetActiveKeys,\n\tgetActiveModels,\n\tgetAll,\n\tgetAllAsObject,\n\n\tgetByKey,\n\tgetByKeys,\n\tgetByKeysAsObject,\n\n\tgetDataByKey,\n\tgetDeletePermissionByKey,\n\n\tgetEditedActive,\n\tgetEditedAll,\n\tgetEditedAllAsObject,\n\tgetEditedByKey,\n\tgetEditedDataByKey,\n\tgetEditedKeys,\n\n\tgetIndexed,\n\n\tgetStateToSave,\n\tgetSubstate,\n\n\tgetUpdatePermissionByKey,\n\tgetUsedKeysForComponent,\n\n\thaveAllKeysRegisteredUse,\n};\n","import common from '../_common/selectors';\nconst getSubstate = state => state.layerTrees;\n\nconst getActive = common.getActive(getSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\n\nconst getAll = common.getAll(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\n\nconst getByKey = common.getByKey(getSubstate);\nconst getByKeys = common.getByKeys(getSubstate);\nconst getByKeysAsObject = common.getByKeysAsObject(getSubstate);\n\nconst getDataByKey = common.getDataByKey(getSubstate);\nconst getEditedActive = common.getEditedActive(getSubstate);\nconst getEditedAll = common.getEditedAll(getSubstate);\nconst getEditedAllAsObject = common.getEditedAllAsObject(getSubstate);\nconst getEditedByKey = common.getEditedByKey(getSubstate);\nconst getEditedDataByKey = common.getEditedDataByKey(getSubstate);\nconst getEditedKeys = common.getEditedKeys(getSubstate);\n\nconst getIndexed = common.getIndexed(getSubstate);\n\nconst getDeletePermissionByKey = common.getDeletePermissionByKey(getSubstate);\nconst getUpdatePermissionByKey = common.getUpdatePermissionByKey(getSubstate);\nconst getUsedKeysForComponent = common.getUsedKeysForComponent(getSubstate);\nconst haveAllKeysRegisteredUse = common.haveAllKeysRegisteredUse(getSubstate);\n\nconst getStateToSave = common.getStateToSave(getSubstate);\n\nexport default {\n\tgetActive,\n\tgetActiveKey,\n\tgetAll,\n\tgetAllAsObject,\n\n\tgetByKey,\n\tgetByKeys,\n\tgetByKeysAsObject,\n\n\tgetDataByKey,\n\tgetDeletePermissionByKey,\n\n\tgetEditedActive,\n\tgetEditedAll,\n\tgetEditedAllAsObject,\n\tgetEditedByKey,\n\tgetEditedDataByKey,\n\tgetEditedKeys,\n\n\tgetIndexed,\n\n\tgetSubstate,\n\tgetStateToSave,\n\n\tgetUpdatePermissionByKey,\n\tgetUsedKeysForComponent,\n\n\thaveAllKeysRegisteredUse,\n};\n","import createCachedSelector from 're-reselect';\nimport _ from 'lodash';\nimport {map as mapUtils} from '@gisatcz/ptr-utils';\nimport {mapConstants} from '@gisatcz/ptr-core';\nimport {grid} from '@gisatcz/ptr-tile-grid';\n\n/* === HELPERS ======================================================================= */\n\n/**\n * Get background layer in 'layer' format\n */\nconst getBackgroundLayerAsLayer = createCachedSelector(\n\t[backgroundLayer => backgroundLayer],\n\tbackgroundLayer => {\n\t\tif (backgroundLayer) {\n\t\t\treturn {...backgroundLayer, key: 'pantherBackgroundLayer'};\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n)(backgroundLayer => JSON.stringify(backgroundLayer));\n\n/**\n * Merge background layer definition with layers to one collection\n */\nconst mergeBackgroundLayerWithLayers = createCachedSelector(\n\t[\n\t\tbackgroundLayer => getBackgroundLayerAsLayer(backgroundLayer),\n\t\t(backgroundLayer, layers) => layers,\n\t],\n\t(backgroundLayer, layers) => {\n\t\tlet finalLayers = layers || [];\n\n\t\tif (backgroundLayer) {\n\t\t\tfinalLayers = [backgroundLayer, ...finalLayers];\n\t\t}\n\n\t\treturn finalLayers.length ? finalLayers : null;\n\t}\n)(\n\t(backgroundLayer, layers) =>\n\t\t`${JSON.stringify(backgroundLayer)}_${JSON.stringify(layers)}`\n);\n\n/**\n * Merge given modifiers with layer's modifiers & given filterByActive with layer's filter by active and add it to the layer state\n *\n * @param layers {Object} layers state\n * @param metadataModifiers {Object} modifiers like scopeKey, placeKey\n * @param filterByActive {{scope: bool, place: bool, period: bool,  scenario: bool, case: bool}}\n * @return {Object} Final layer state definition\n */\nconst mergeModifiersAndFilterByActiveToLayerStructure = (\n\tlayers,\n\tmetadataModifiers,\n\tfilterByActive\n) => {\n\treturn layers.map(layer => {\n\t\tlet layerMetadataModifiers =\n\t\t\tlayer.metadataModifiers && metadataModifiers\n\t\t\t\t? {...metadataModifiers, ...layer.metadataModifiers}\n\t\t\t\t: metadataModifiers || layer.metadataModifiers || null;\n\t\tlet layerFilterByActive =\n\t\t\tlayer.filterByActive && filterByActive\n\t\t\t\t? {...filterByActive, ...layer.filterByActive}\n\t\t\t\t: filterByActive || layer.filterByActive || null;\n\n\t\treturn {\n\t\t\t...layer,\n\t\t\tmetadataModifiers: layerMetadataModifiers,\n\t\t\tfilterByActive: layerFilterByActive,\n\t\t};\n\t});\n};\n\n/**\n * It returns merged view from map and associated map set based on synced params\n * @param map {Object}\n * @param set {Object}\n * @return {Object|unknown} final map view\n */\nconst getView = (map, set) => {\n\tif (map) {\n\t\tif (set) {\n\t\t\tlet mapView = map.data?.view;\n\n\t\t\t// omit synced view params from map\n\t\t\tif (set.sync && !_.isEmpty(set.sync)) {\n\t\t\t\tmapView = _.omitBy(mapView, (viewValue, viewKey) => {\n\t\t\t\t\treturn set.sync[viewKey];\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlet mapSetView = set.data?.view;\n\t\t\treturn mapUtils.view.mergeViews(\n\t\t\t\tmapConstants.defaultMapView,\n\t\t\t\tmapSetView,\n\t\t\t\tmapView\n\t\t\t);\n\t\t} else {\n\t\t\tlet view = map.data?.view;\n\t\t\treturn mapUtils.view.mergeViews(mapConstants.defaultMapView, view);\n\t\t}\n\t} else {\n\t\treturn null;\n\t}\n};\n\n/**\n * Get zoom level of current view represented by mapWidth, mapHeight and boxRange.\n */\nconst getZoomLevel = createCachedSelector(\n\t[\n\t\tmapWidth => mapWidth,\n\t\t(mapWidth, mapHeight) => mapHeight,\n\t\t(mapWidth, mapHeight, boxRange) => boxRange,\n\t],\n\t(mapWidth, mapHeight, boxRange) => {\n\t\tconst viewportRange = mapUtils.view.getMapViewportRange(\n\t\t\tmapWidth,\n\t\t\tmapHeight\n\t\t);\n\t\tconst levelBoxRange = mapUtils.view.getNearestZoomLevelBoxRange(\n\t\t\tmapWidth,\n\t\t\tmapHeight,\n\t\t\tboxRange\n\t\t);\n\t\treturn grid.getLevelByViewport(levelBoxRange, viewportRange);\n\t}\n)((mapWidth, mapHeight, boxRange) => `${mapWidth}${mapHeight}${boxRange}`);\n\n/**\n * Get tiles intersected by map extent.\n * Map extent is represented by mapWidth, mapHeight, center and boxRange.\n */\nconst getTiles = createCachedSelector(\n\t[\n\t\tmapWidth => mapWidth,\n\t\t(mapWidth, mapHeight) => mapHeight,\n\t\t(mapWidth, mapHeight, center) => center,\n\t\t(mapWidth, mapHeight, center, boxRange) => boxRange,\n\t],\n\t(mapWidth, mapHeight, center, boxRange) => {\n\t\tif (mapWidth && mapHeight && center && boxRange) {\n\t\t\tconst levelBoxRange = mapUtils.view.getNearestZoomLevelBoxRange(\n\t\t\t\tmapWidth,\n\t\t\t\tmapHeight,\n\t\t\t\tboxRange\n\t\t\t);\n\t\t\tconst tileGrid = grid.getTileGrid(\n\t\t\t\tmapWidth,\n\t\t\t\tmapHeight,\n\t\t\t\tlevelBoxRange,\n\t\t\t\tcenter,\n\t\t\t\ttrue\n\t\t\t);\n\t\t\treturn tileGrid.flat(1);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n)(\n\t(mapWidth, mapHeight, center, boxRange) =>\n\t\t`${mapWidth}${mapHeight}${center?.lon}${center?.lat}${boxRange}`\n);\n\nexport default {\n\tgetBackgroundLayerAsLayer,\n\tgetTiles,\n\tgetView,\n\tgetZoomLevel,\n\tmergeBackgroundLayerWithLayers,\n\tmergeModifiersAndFilterByActiveToLayerStructure,\n};\n","import common from '../_common/selectors';\nimport {\n\tcreateObserver as createRecomputeObserver,\n\tcreateSelector as createRecomputeSelector,\n} from '@jvitela/recompute';\n\nconst getSubstate = state => state.styles;\n\nconst getActive = common.getActive(getSubstate);\nconst getActiveModels = common.getActiveModels(getSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\nconst getActiveKeys = common.getActiveKeys(getSubstate);\nconst getAll = common.getAll(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\n\nconst getByKey = common.getByKey(getSubstate);\nconst getByKeys = common.getByKeys(getSubstate);\nconst getByKeysAsObject = common.getByKeysAsObject(getSubstate);\n\nconst getDataByKey = common.getDataByKey(getSubstate);\n\nconst getEditedActive = common.getEditedActive(getSubstate);\nconst getEditedAll = common.getEditedAll(getSubstate);\nconst getEditedAllAsObject = common.getEditedAllAsObject(getSubstate);\nconst getEditedByKey = common.getEditedByKey(getSubstate);\nconst getEditedDataByKey = common.getEditedDataByKey(getSubstate);\nconst getEditedKeys = common.getEditedKeys(getSubstate);\n\nconst getIndexed = common.getIndexed(getSubstate);\n\nconst getStateToSave = common.getStateToSave(getSubstate);\n\nconst getDeletePermissionByKey = common.getDeletePermissionByKey(getSubstate);\nconst getUpdatePermissionByKey = common.getUpdatePermissionByKey(getSubstate);\nconst getUsedKeysForComponent = common.getUsedKeysForComponent(getSubstate);\nconst haveAllKeysRegisteredUse = common.haveAllKeysRegisteredUse(getSubstate);\n\nconst getByKeyObserver = createRecomputeObserver(getByKey);\n\nconst getDefinitionByKey = createRecomputeSelector(key => {\n\tconst style = getByKeyObserver(key);\n\treturn style?.data?.definition || null;\n});\n\nexport default {\n\tgetActive,\n\tgetActiveKey,\n\tgetActiveKeys,\n\tgetActiveModels,\n\tgetAll,\n\tgetAllAsObject,\n\tgetByKey,\n\tgetByKeys,\n\tgetByKeysAsObject,\n\n\tgetDataByKey,\n\tgetDeletePermissionByKey,\n\n\tgetEditedActive,\n\tgetEditedAll,\n\tgetEditedAllAsObject,\n\tgetEditedByKey,\n\tgetEditedDataByKey,\n\tgetEditedKeys,\n\n\tgetIndexed,\n\n\tgetStateToSave,\n\tgetSubstate,\n\n\tgetUpdatePermissionByKey,\n\tgetUsedKeysForComponent,\n\n\thaveAllKeysRegisteredUse,\n\n\t// recompute\n\tgetDefinitionByKey,\n};\n","import _ from 'lodash';\nimport common from '../_common/selectors';\nimport StyleSelectors from '../Styles/selectors';\nimport {createSelector} from 'reselect';\nimport {\n\tcreateSelector as createRecomputeSelector,\n\tcreateObserver as createRecomputeObserver,\n} from '@jvitela/recompute';\n\nconst getSubstate = state => state.selections;\nconst getActive = common.getActive(getSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\nconst getAll = common.getAll(getSubstate);\n\nconst getAllAsObjectWithStyles = createSelector(\n\t[getAllAsObject, StyleSelectors.getAllAsObject],\n\t(selections, allStyles) => {\n\t\tif (selections) {\n\t\t\tif (allStyles) {\n\t\t\t\tlet selectionsWithStyles = {};\n\t\t\t\t_.forIn(selections, (selection, key) => {\n\t\t\t\t\tconst styleKey = selection.data?.styleKey;\n\t\t\t\t\tif (styleKey && allStyles[styleKey]) {\n\t\t\t\t\t\tconst selectionStyle =\n\t\t\t\t\t\t\tallStyles[styleKey].data?.definition?.rules?.[0].styles?.[0]; // TODO get first style of first rule for now\n\t\t\t\t\t\tif (selectionStyle) {\n\t\t\t\t\t\t\tselectionsWithStyles[key] = {\n\t\t\t\t\t\t\t\t...selection,\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t...selection.data,\n\t\t\t\t\t\t\t\t\tstyle: selectionStyle,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tselectionsWithStyles[key] = selection;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tselectionsWithStyles[key] = selection;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn selectionsWithStyles;\n\t\t\t} else {\n\t\t\t\treturn selections;\n\t\t\t}\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\nconst getByKeyObserver = createRecomputeObserver(\n\t(state, key) => state.selections.byKey[key]\n);\n\nconst prepareSelectionByLayerStateSelected = createRecomputeSelector(\n\tlayerStateSelected => {\n\t\tlet populatedSelections = {};\n\t\t_.forIn(layerStateSelected, (value, key) => {\n\t\t\tlet selection = getByKeyObserver(key);\n\t\t\tlet selectionData = selection?.data;\n\n\t\t\tif (selectionData) {\n\t\t\t\tconst style = selectionData.style;\n\t\t\t\tconst hoveredStyle = selectionData.hoveredStyle || style;\n\t\t\t\tconst color = selectionData.color;\n\t\t\t\tconst hoveredColor = selectionData.hoveredColor || color;\n\n\t\t\t\tif (selectionData.featureKeysFilter) {\n\t\t\t\t\tpopulatedSelections[key] = {\n\t\t\t\t\t\tkeys: selectionData.featureKeysFilter.keys,\n\t\t\t\t\t};\n\t\t\t\t\tif (style) {\n\t\t\t\t\t\tpopulatedSelections[key].style = style;\n\t\t\t\t\t\tpopulatedSelections[key].hoveredStyle = hoveredStyle;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpopulatedSelections[key].style = {\n\t\t\t\t\t\t\toutlineColor: color,\n\t\t\t\t\t\t\toutlineWidth: 2,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tpopulatedSelections[key].hoveredStyle = {\n\t\t\t\t\t\t\toutlineColor: hoveredColor,\n\t\t\t\t\t\t\toutlineWidth: 2,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//TODO other selection types\n\t\t\t}\n\t\t});\n\n\t\treturn populatedSelections;\n\t}\n);\n\nexport default {\n\tgetActiveKey,\n\tgetActive,\n\tgetAll,\n\tgetAllAsObject,\n\n\tgetAllAsObjectWithStyles,\n\n\tprepareSelectionByLayerStateSelected,\n};\n","import {createSelector} from 'reselect';\nimport createCachedSelector from 're-reselect';\nimport {\n\tcreateSelector as createRecomputeSelector,\n\tcreateObserver as createRecomputeObserver,\n} from '@jvitela/recompute';\nimport {\n\tcompact as _compact,\n\tflatten as _flatten,\n\tisEmpty as _isEmpty,\n\tincludes as _includes,\n\tfind as _find,\n\tforEach as _forEach,\n} from 'lodash';\n\nimport {map as mapUtils} from '@gisatcz/ptr-utils';\nimport {mapConstants} from '@gisatcz/ptr-core';\n\nimport common from '../_common/selectors';\nimport commonHelpers from '../_common/helpers';\nimport {recomputeSelectorOptions} from '../_common/recomputeHelpers';\nimport selectorHelpers from './selectorHelpers';\n\nimport AppSelectors from '../App/selectors';\nimport DataSelectors from '../Data/selectors';\nimport SelectionsSelectors from '../Selections/selectors';\nimport StylesSelectors from '../Styles/selectors';\nimport helpers from './selectorHelpers';\n\n/* === SELECTORS ======================================================================= */\n\nconst getSubstate = state => state.maps;\n\nconst getAllMapSetsInUse = state => state.maps.inUse.sets;\nconst getAllMapsInUse = state => state.maps.inUse.maps;\nconst getActiveMapKey = state => state.maps.activeMapKey;\nconst getMapsAsObject = state => state.maps.maps;\nconst getMapSetsAsObject = state => state.maps.sets;\n\nconst getActiveMap = createSelector(\n\t[getMapsAsObject, getActiveMapKey],\n\t(maps, activeMapKey) => {\n\t\tif (maps && activeMapKey) {\n\t\t\treturn maps[activeMapKey];\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\nconst isMapSetInUse = createCachedSelector(\n\t[getAllMapSetsInUse, (state, mapSetKey) => mapSetKey],\n\t(mapSetsInUse, mapSetKey) => {\n\t\tif (mapSetsInUse.length && mapSetKey) {\n\t\t\treturn !!_includes(mapSetsInUse, mapSetKey);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n)((state, mapSetKey) => (mapSetKey ? mapSetKey : ''));\n\nconst isMapInUse = createCachedSelector(\n\t[getAllMapsInUse, (state, mapKey) => mapKey],\n\t(mapsInUse, mapKey) => {\n\t\tif (mapsInUse.length && mapKey) {\n\t\t\treturn !!_includes(mapsInUse, mapKey);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n)((state, mapKey) => (mapKey ? mapKey : ''));\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getMapByKey = createSelector(\n\t[getMapsAsObject, (state, key) => key],\n\t(maps, key) => {\n\t\treturn maps?.[key] || null;\n\t}\n);\n\n/**\n * @param state {Object}\n */\nconst getMapSets = createSelector([getMapSetsAsObject], sets => {\n\tif (sets && !_isEmpty(sets)) {\n\t\treturn Object.values(sets);\n\t} else {\n\t\treturn null;\n\t}\n});\n\n/**\n * @param state {Object}\n */\nconst getAllMapSetsMaps = createSelector([getMapSets], mapSets => {\n\tif (mapSets) {\n\t\treturn _flatten(mapSets.map(mapSet => mapSet.maps));\n\t} else {\n\t\treturn null;\n\t}\n});\n\n/**\n * @param state {Object}\n * @param setKey {string}\n */\nconst getMapSetByKey = createSelector(\n\t[getMapSetsAsObject, (state, key) => key],\n\t(sets, key) => {\n\t\treturn sets?.[key] || null;\n\t}\n);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getMapSetByMapKey = createSelector(\n\t[getMapSets, (state, mapKey) => mapKey],\n\t(sets, mapKey) => {\n\t\tif (sets && !_isEmpty(sets) && mapKey) {\n\t\t\treturn (\n\t\t\t\t_find(sets, set => set.maps && _includes(set.maps, mapKey)) || null\n\t\t\t);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\n/**\n * Get active map key for set. Either local, or global.\n *\n * @param state {Object}\n * @param setKey {string}\n */\nconst getMapSetActiveMapKey = createSelector(\n\t[getActiveMapKey, getMapSetByKey],\n\t(mapKey, set) => {\n\t\tif (set) {\n\t\t\tlet mapKeyInSet = _includes(set.maps, mapKey);\n\t\t\treturn set.activeMapKey || (mapKeyInSet && mapKey) || null;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\n/**\n * @param state {Object}\n * @param setKey {string}\n */\nconst getMapSetActiveMapView = createCachedSelector(\n\t[getMapSetActiveMapKey, getMapSetByKey, getMapsAsObject],\n\t(mapKey, set, maps) => {\n\t\tlet map = maps?.[mapKey];\n\t\tif (map) {\n\t\t\treturn selectorHelpers.getView(map, set);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n)((state, setKey) => setKey);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getViewByMapKey = createCachedSelector(\n\t[getMapByKey, getMapSetByMapKey],\n\tselectorHelpers.getView\n)((state, mapKey) => mapKey);\n\nconst getViewByMapKeyObserver = createRecomputeObserver(getViewByMapKey);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getViewportByMapKey = createCachedSelector([getMapByKey], map => {\n\treturn map?.data?.viewport || null;\n})((state, mapKey) => mapKey);\n\nconst getViewportByMapKeyObserver = createRecomputeObserver(\n\tgetViewportByMapKey\n);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getViewLimitsByMapKey = createCachedSelector(\n\t[getMapByKey, getMapSetByMapKey],\n\t(map, set) => {\n\t\tif (map) {\n\t\t\tif (set) {\n\t\t\t\tlet mapViewLimits = map.data?.viewLimits;\n\t\t\t\tlet mapSetViewLimits = set.data?.viewLimits;\n\t\t\t\treturn mapViewLimits || mapSetViewLimits || null;\n\t\t\t} else {\n\t\t\t\treturn map.data?.viewLimits || null;\n\t\t\t}\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n)((state, mapKey) => mapKey);\n\n/**\n * @param state {Object}\n * @param setKey {string}\n */\nconst getMapSetMapKeys = createSelector([getMapSetByKey], set => {\n\treturn set?.maps?.length ? set.maps : null;\n});\n\n/**\n * @param state {Object}\n * @param setKey {string}\n */\nconst getMapSetMaps = createSelector(\n\t[getMapsAsObject, getMapSetMapKeys],\n\t(maps, mapKeys) => {\n\t\tif (!_isEmpty(maps) && mapKeys?.length) {\n\t\t\treturn mapKeys.map(key => maps[key]);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\n/**\n * @param state {Object}\n * @param setKey {string}\n */\nconst getMapSetView = createSelector([getMapSetByKey], set => {\n\tif (set) {\n\t\treturn mapUtils.view.mergeViews(\n\t\t\tmapConstants.defaultMapView,\n\t\t\tset.data?.view\n\t\t);\n\t} else {\n\t\treturn null;\n\t}\n});\n\n/**\n * @param state {Object}\n * @param setKey {string}\n */\nconst getMapSetViewLimits = createSelector([getMapSetByKey], set => {\n\treturn set?.data?.viewLimits || null;\n});\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getMapBackgroundLayerStateByMapKey = createSelector(\n\t[getMapByKey],\n\tmap => {\n\t\treturn map?.data?.backgroundLayer || null;\n\t}\n);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getMapLayersStateByMapKey = createSelector([getMapByKey], map => {\n\treturn map?.data?.layers || null;\n});\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n * @param layerKey {string}\n */\nconst getMapLayerStateByMapKeyAndLayerKey = createSelector(\n\t[getMapLayersStateByMapKey, (state, mapKey, layerKey) => layerKey],\n\t(layers, layerKey) => {\n\t\tif (layers && layerKey) {\n\t\t\treturn layers.find(layer => layer.key === layerKey) || null;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getMapSetBackgroundLayerStateByMapKey = createSelector(\n\t[getMapSetByMapKey],\n\tset => {\n\t\treturn set?.data?.backgroundLayer || null;\n\t}\n);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getMapSetLayersStateByMapKey = createSelector(\n\t[getMapSetByMapKey],\n\tset => {\n\t\treturn set?.data?.layers || null;\n\t}\n);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getMapMetadataModifiersByMapKey = createSelector([getMapByKey], map => {\n\treturn map?.data?.metadataModifiers || null;\n});\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getMapSetMetadataModifiersByMapKey = createSelector(\n\t[getMapSetByMapKey],\n\tset => {\n\t\treturn set?.data?.metadataModifiers || null;\n\t}\n);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getMetadataModifiersByMapKey = createCachedSelector(\n\t[getMapMetadataModifiersByMapKey, getMapSetMetadataModifiersByMapKey],\n\t(mapModifiers, setModifiers) => {\n\t\tif (mapModifiers && setModifiers) {\n\t\t\treturn {...setModifiers, ...mapModifiers};\n\t\t} else {\n\t\t\treturn setModifiers || mapModifiers || null;\n\t\t}\n\t}\n)((state, mapKey) => mapKey);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getMapFilterByActiveByMapKey = createSelector([getMapByKey], map => {\n\treturn map?.data?.filterByActive || null;\n});\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getMapSetFilterByActiveByMapKey = createSelector(\n\t[getMapSetByMapKey],\n\tset => {\n\t\treturn set?.data?.filterByActive || null;\n\t}\n);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getFilterByActiveByMapKey = createCachedSelector(\n\t[getMapFilterByActiveByMapKey, getMapSetFilterByActiveByMapKey],\n\t(mapFilter, setFilter) => {\n\t\tif (mapFilter && setFilter) {\n\t\t\treturn {...mapFilter, ...setFilter};\n\t\t} else {\n\t\t\treturn setFilter || mapFilter || null;\n\t\t}\n\t}\n)((state, mapKey) => mapKey);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getBackgroundLayerStateByMapKey = createCachedSelector(\n\t[getMapBackgroundLayerStateByMapKey, getMapSetBackgroundLayerStateByMapKey],\n\t(mapBackgroundLayer, setBackgroundLayer) => {\n\t\treturn mapBackgroundLayer || setBackgroundLayer || null;\n\t}\n)((state, mapKey) => mapKey);\n\nconst getBackgroundLayerStateByMapKeyObserver = createRecomputeObserver(\n\tgetBackgroundLayerStateByMapKey\n);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n * @return {Object} Merged mapSetState with metadataModifiers and filterByActive.\n */\nconst getMapSetLayersStateWithModifiersByMapKey = createCachedSelector(\n\t[\n\t\tgetMapSetLayersStateByMapKey,\n\t\tgetMapSetMetadataModifiersByMapKey,\n\t\tgetMapSetFilterByActiveByMapKey,\n\t],\n\t(setLayers, metadataModifiers, mapSetFilterByActive) => {\n\t\tif (setLayers?.length) {\n\t\t\treturn selectorHelpers.mergeModifiersAndFilterByActiveToLayerStructure(\n\t\t\t\tsetLayers,\n\t\t\t\tmetadataModifiers,\n\t\t\t\tmapSetFilterByActive\n\t\t\t);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n)((state, mapKey) => mapKey);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n * @return {Object} Merged mapState with metadataModifiers and filterByActive.\n */\nconst getMapLayersStateWithModifiersByMapKey = createCachedSelector(\n\t[\n\t\tgetMapLayersStateByMapKey,\n\t\tgetMetadataModifiersByMapKey,\n\t\tgetFilterByActiveByMapKey,\n\t],\n\t(mapLayers, metadataModifiers, mapFilterByActive) => {\n\t\tif (mapLayers?.length) {\n\t\t\treturn selectorHelpers.mergeModifiersAndFilterByActiveToLayerStructure(\n\t\t\t\tmapLayers,\n\t\t\t\tmetadataModifiers,\n\t\t\t\tmapFilterByActive\n\t\t\t);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n)((state, mapKey) => mapKey);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n * @return {Object} Merged layer state from mapState and mapSetState with metadataModifiers and filterByActive.\n */\nconst getLayersStateByMapKey = createCachedSelector(\n\t[\n\t\tgetMapSetLayersStateWithModifiersByMapKey,\n\t\tgetMapLayersStateWithModifiersByMapKey,\n\t],\n\t(setLayers, mapLayers) => {\n\t\tif (mapLayers && setLayers) {\n\t\t\treturn [...setLayers, ...mapLayers];\n\t\t} else if (mapLayers) {\n\t\t\treturn mapLayers;\n\t\t} else if (setLayers) {\n\t\t\treturn setLayers;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n)((state, mapKey) => mapKey);\n\nconst getLayersStateByMapKeyObserver = createRecomputeObserver(\n\tgetLayersStateByMapKey\n);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n * @param layerKey {string}\n * @return {Object | null}\n */\nconst getLayerStateByLayerKeyAndMapKey = createSelector(\n\t[getLayersStateByMapKey, (state, mapKey, layerKey) => layerKey],\n\t(layers, layerKey) => {\n\t\tif (layers) {\n\t\t\tconst layer = _find(layers, layer => layer.key === layerKey);\n\t\t\treturn layer || null;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\n/**\n * @param state {Object}\n * @param mapKey {string}\n */\nconst getAllLayersStateByMapKey = createCachedSelector(\n\t[getBackgroundLayerStateByMapKey, getLayersStateByMapKey],\n\t(backgroundLayer, layers) => {\n\t\tif (layers || backgroundLayer) {\n\t\t\treturn selectorHelpers.mergeBackgroundLayerWithLayers(\n\t\t\t\tbackgroundLayer,\n\t\t\t\tlayers\n\t\t\t);\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n)((state, mapKey) => mapKey);\n\n/**\n * @param layerState {Object}\n */\nconst getSpatialRelationsFilterFromLayerState = createRecomputeSelector(\n\tlayerState => {\n\t\tif (layerState) {\n\t\t\t// TODO at least a part is the same as in Maps/actions/layerUse?\n\t\t\tconst layer = layerState;\n\n\t\t\t// modifiers defined by key\n\t\t\tlet metadataDefinedByKey = layer.metadataModifiers\n\t\t\t\t? {...layer.metadataModifiers}\n\t\t\t\t: {};\n\n\t\t\t// Get actual metadata keys defined by filterByActive\n\t\t\tconst activeMetadataKeys = common.getActiveKeysByFilterByActiveObserver(\n\t\t\t\tlayer.filterByActive\n\t\t\t);\n\n\t\t\t// Merge metadata, metadata defined by key have priority\n\t\t\tconst mergedMetadataKeys = commonHelpers.mergeMetadataKeys(\n\t\t\t\tmetadataDefinedByKey,\n\t\t\t\tactiveMetadataKeys\n\t\t\t);\n\n\t\t\tconst relationsFilter = {};\n\t\t\t// It converts modifiers from metadataKeys: [\"A\", \"B\"] to metadataKey: {in: [\"A\", \"B\"]}\n\t\t\trelationsFilter.modifiers = commonHelpers.convertModifiersToRequestFriendlyFormat(\n\t\t\t\tmergedMetadataKeys\n\t\t\t);\n\n\t\t\t// add layerTemplate od areaTreeLevelKey\n\t\t\tif (layer.layerTemplateKey) {\n\t\t\t\trelationsFilter.layerTemplateKey = layer.layerTemplateKey;\n\t\t\t} else if (layer.areaTreeLevelKey) {\n\t\t\t\trelationsFilter.areaTreeLevelKey = layer.areaTreeLevelKey;\n\t\t\t}\n\t\t\treturn relationsFilter;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t},\n\trecomputeSelectorOptions\n);\n\n/**\n * @param {string} mapKey\n * @param {number} mapWidth\n * @param {number} mapHeight\n * @return {{tiles: Array, level: number}}\n */\nconst getVisibleTilesByMapKey = createCachedSelector(\n\t[\n\t\tgetViewByMapKey,\n\t\t(state, mapKey, mapWidth) => mapWidth,\n\t\t(state, mapKey, mapWidth, mapHeight) => mapHeight,\n\t],\n\t(view, mapWidth, mapHeight) => {\n\t\tif (view?.center && view?.boxRange && mapWidth && mapHeight) {\n\t\t\tconst tiles = helpers.getTiles(\n\t\t\t\tmapWidth,\n\t\t\t\tmapHeight,\n\t\t\t\tview.center,\n\t\t\t\tview.boxRange\n\t\t\t);\n\t\t\tconst level = helpers.getZoomLevel(mapWidth, mapHeight, view.boxRange);\n\n\t\t\treturn {\n\t\t\t\ttiles,\n\t\t\t\tlevel,\n\t\t\t};\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n)((state, mapKey, mapWidth, mapHeight) => `${mapKey}_${mapWidth}_${mapHeight}`);\n\n/**\n * @param layerState {Object}\n */\nconst getAttributeDataFilterFromLayerState = createRecomputeSelector(\n\tlayerState => {\n\t\tif (layerState) {\n\t\t\tconst commonFilter = common.getCommmonDataRelationsFilterFromComponentState_recompute(\n\t\t\t\tlayerState\n\t\t\t);\n\t\t\tif (!_isEmpty(commonFilter)) {\n\t\t\t\tlet attributeFilter = {...commonFilter};\n\t\t\t\tconst attributeDataFilterExtension = {\n\t\t\t\t\t...(layerState?.options?.attributeFilter && {\n\t\t\t\t\t\tattributeFilter: layerState.options.attributeFilter,\n\t\t\t\t\t}),\n\t\t\t\t\t...(layerState?.options?.dataSourceKeys && {\n\t\t\t\t\t\tdataSourceKeys: layerState.options.dataSourceKeys,\n\t\t\t\t\t}),\n\t\t\t\t\t...(layerState?.options?.featureKeys && {\n\t\t\t\t\t\tfeatureKeys: layerState.options.featureKeys,\n\t\t\t\t\t}),\n\t\t\t\t\t...(layerState?.styleKey && {styleKey: layerState.styleKey}),\n\t\t\t\t};\n\n\t\t\t\treturn {...attributeFilter, ...attributeDataFilterExtension};\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t},\n\trecomputeSelectorOptions\n);\n\n/**\n * @param layerState {Object}\n */\nconst getAttributeRelationsFilterFromLayerState = createRecomputeSelector(\n\tlayerState => {\n\t\tif (layerState) {\n\t\t\tconst commonFilter = common.getCommmonDataRelationsFilterFromComponentState_recompute(\n\t\t\t\tlayerState\n\t\t\t);\n\t\t\tif (!_isEmpty(commonFilter)) {\n\t\t\t\tlet attributeFilter = {...commonFilter};\n\t\t\t\tif (layerState.styleKey) {\n\t\t\t\t\t// add styleKey\n\t\t\t\t\tattributeFilter.styleKey = layerState.styleKey;\n\t\t\t\t}\n\t\t\t\treturn attributeFilter;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t},\n\trecomputeSelectorOptions\n);\n\n/**\n * @param spatialDataSource {Object}\n * @param layerState {Object} layer definition from state or passed to the Map component\n * @param layerKey {string} layer unique identifier\n * @param attributeDataSourceKeyAttributeKeyPairs {Object} key-value pairs, where key is attribute data source key and value is matching attribute key\n * @param mapKey {string} map unique identifier\n * @param spatialRelationsFilter {Object} see getSpatialRelationsFilterFromLayerState\n * @param attributeRelationsFilter {Object} see getAttributeRelationsFilterFromLayerState\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n */\nconst getFinalLayerByDataSourceAndLayerState = createRecomputeSelector(\n\t(\n\t\tspatialDataSource,\n\t\tlayerState,\n\t\tlayerKey,\n\t\tattributeDataSourceKeyAttributeKeyPairs,\n\t\tmapKey,\n\t\tspatialRelationsFilter,\n\t\tattributeRelationsFilter,\n\t\tattributeDataFilter\n\t) => {\n\t\tlet {\n\t\t\tattribution,\n\t\t\tnameInternal,\n\t\t\ttype,\n\t\t\tfidColumnName,\n\t\t\tgeometryColumnName,\n\t\t\t...dataSourceOptions\n\t\t} = spatialDataSource?.data;\n\t\tlet {\n\t\t\tkey,\n\t\t\tname,\n\t\t\topacity,\n\t\t\tstyleKey,\n\t\t\tcrs,\n\t\t\toptions: layerStateOptions,\n\t\t} = layerState;\n\n\t\tlayerKey = layerKey || key;\n\n\t\tlet options = {...dataSourceOptions, ...layerStateOptions};\n\n\t\tif (type === 'wmts') {\n\t\t\toptions.url = dataSourceOptions.url || dataSourceOptions.urls?.[0];\n\t\t} else if (type === 'wms') {\n\t\t\tlet {url, params, configuration, ...rest} = dataSourceOptions;\n\t\t\tconst singleTile =\n\t\t\t\tconfiguration && configuration.hasOwnProperty('singleTile')\n\t\t\t\t\t? configuration.singleTile\n\t\t\t\t\t: false;\n\n\t\t\tconst styles = rest.styles;\n\n\t\t\tif (url && url.charAt(0) !== 'h') {\n\t\t\t\tconst localConfig = AppSelectors.getCompleteLocalConfigurationObserver();\n\t\t\t\turl = `${localConfig.apiBackendProtocol}://${localConfig.apiBackendHost}/${url}`;\n\t\t\t}\n\n\t\t\toptions = {\n\t\t\t\tparams: {\n\t\t\t\t\t...params,\n\t\t\t\t\t...(styles && {styles}),\n\t\t\t\t\t...(crs && {crs}),\n\t\t\t\t\tlayers: rest.layers.slice(2, -2),\n\t\t\t\t},\n\t\t\t\tsingleTile,\n\t\t\t\turl,\n\t\t\t};\n\t\t} else if (\n\t\t\ttype === 'vector' ||\n\t\t\ttype === 'tiledVector' ||\n\t\t\ttype === 'tiled-vector'\n\t\t) {\n\t\t\tlet features,\n\t\t\t\ttiles = null;\n\n\t\t\tif (type === 'vector') {\n\t\t\t\tfeatures = DataSelectors.getFeatures(\n\t\t\t\t\tspatialDataSource.key,\n\t\t\t\t\tfidColumnName,\n\t\t\t\t\tattributeDataSourceKeyAttributeKeyPairs\n\t\t\t\t);\n\t\t\t} else if (type === 'tiledVector' || type === 'tiled-vector') {\n\t\t\t\tconst view = getViewByMapKeyObserver(mapKey);\n\t\t\t\tconst viewport = getViewportByMapKeyObserver(mapKey);\n\t\t\t\tconst tileList = selectorHelpers.getTiles(\n\t\t\t\t\tviewport.width,\n\t\t\t\t\tviewport.height,\n\t\t\t\t\tview.center,\n\t\t\t\t\tview.boxRange\n\t\t\t\t);\n\t\t\t\tconst level = selectorHelpers.getZoomLevel(\n\t\t\t\t\tviewport.width,\n\t\t\t\t\tviewport.height,\n\t\t\t\t\tview.boxRange\n\t\t\t\t);\n\t\t\t\ttiles = DataSelectors.getTiles(\n\t\t\t\t\tspatialDataSource.key,\n\t\t\t\t\tfidColumnName,\n\t\t\t\t\tlevel,\n\t\t\t\t\ttileList,\n\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\tattributeDataSourceKeyAttributeKeyPairs,\n\t\t\t\t\tstyleKey,\n\t\t\t\t\tattributeDataFilter\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tlet selected = null;\n\t\t\tlet style = options?.style;\n\n\t\t\tif (options?.selected) {\n\t\t\t\tselected = SelectionsSelectors.prepareSelectionByLayerStateSelected(\n\t\t\t\t\toptions.selected\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (!style && styleKey) {\n\t\t\t\tstyle = StylesSelectors.getDefinitionByKey(styleKey);\n\t\t\t}\n\n\t\t\toptions = {\n\t\t\t\t...options,\n\t\t\t\t...(selected && {selected}),\n\t\t\t\t...(style && {style}),\n\t\t\t\t...(features && {features}),\n\t\t\t\t...(tiles && {tiles}),\n\t\t\t\tfidColumnName,\n\t\t\t\tgeometryColumnName,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tkey: layerKey + '_' + spatialDataSource.key,\n\t\t\tlayerKey,\n\t\t\topacity: opacity || opacity === 0 ? opacity : 1,\n\t\t\tname,\n\t\t\ttype,\n\t\t\toptions,\n\t\t};\n\t},\n\trecomputeSelectorOptions\n);\n\n/**\n * @param mapKey {string} map unique identifier\n * @param layerState {Object} layer definition in state (see getBackgroundLayerState) or passed to the Map component\n * @return {Array} It returns a list of end format definitions of the background layer (per data source). See: https://gisat.github.io/ > Architecture > System data types > Layers\n */\nconst getMapBackgroundLayer = createRecomputeSelector((mapKey, layerState) => {\n\tif (!layerState) {\n\t\tlayerState = getBackgroundLayerStateByMapKeyObserver(mapKey);\n\t}\n\n\tif (layerState) {\n\t\tif (layerState.type) {\n\t\t\treturn layerState;\n\t\t} else {\n\t\t\tconst layerKey = 'pantherBackgroundLayer';\n\t\t\tconst spatialDataSources = DataSelectors.spatialDataSources.getIndexed_recompute(\n\t\t\t\tlayerState\n\t\t\t);\n\t\t\tif (spatialDataSources) {\n\t\t\t\tconst layers = _compact(\n\t\t\t\t\tspatialDataSources.map(dataSource => {\n\t\t\t\t\t\tconst dataSourceType = dataSource?.data?.type;\n\n\t\t\t\t\t\t// TODO currently only wms or wmts is supported; add filterByActive & metadata modifiers to support vectors\n\t\t\t\t\t\tif (dataSourceType === 'wmts' || dataSourceType === 'wms') {\n\t\t\t\t\t\t\treturn getFinalLayerByDataSourceAndLayerState(\n\t\t\t\t\t\t\t\tdataSource,\n\t\t\t\t\t\t\t\tlayerState,\n\t\t\t\t\t\t\t\tlayerKey\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\treturn layers.length ? layers : null;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t} else {\n\t\treturn null;\n\t}\n}, recomputeSelectorOptions);\n\n/**\n * @param mapKey {string} map unique identifier\n * @param layerState {Object} layer definition in state (see getBackgroundLayerState) or passed to the Map component\n * @return {Array} It returns a list of end format definitions of the background layer (per data source). See: https://gisat.github.io/ > Architecture > System data types > Layers\n */\nconst getMapLayers = createRecomputeSelector((mapKey, layersState) => {\n\tif (!layersState) {\n\t\tlayersState = getLayersStateByMapKeyObserver(mapKey);\n\t}\n\n\tif (layersState) {\n\t\tlet finalLayers = [];\n\n\t\t_forEach(layersState, layerState => {\n\t\t\t// layer is already defined by the end format suitable for presentational map component\n\t\t\tif (layerState.type) {\n\t\t\t\tif (layerState.type === 'vector' && layerState.options?.selected) {\n\t\t\t\t\tlayerState = {\n\t\t\t\t\t\t...layerState,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t...layerState.options,\n\t\t\t\t\t\t\tselected: SelectionsSelectors.prepareSelectionByLayerStateSelected(\n\t\t\t\t\t\t\t\tlayerState.options.selected\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tfinalLayers.push(layerState);\n\t\t\t}\n\t\t\t// necessary to assemble data for the end format\n\t\t\telse {\n\t\t\t\tconst spatialRelationsFilter = getSpatialRelationsFilterFromLayerState(\n\t\t\t\t\tlayerState\n\t\t\t\t);\n\t\t\t\tconst attributeRelationsFilter = getAttributeRelationsFilterFromLayerState(\n\t\t\t\t\tlayerState\n\t\t\t\t);\n\t\t\t\tconst attributeDataFilter = getAttributeDataFilterFromLayerState(\n\t\t\t\t\tlayerState\n\t\t\t\t);\n\t\t\t\tconst spatialDataSources = DataSelectors.spatialDataSources.getIndexed_recompute(\n\t\t\t\t\tspatialRelationsFilter\n\t\t\t\t);\n\t\t\t\tconst attributeDataSourceKeyAttributeKeyPairs = DataSelectors.attributeRelations.getFilteredAttributeDataSourceKeyAttributeKeyPairs(\n\t\t\t\t\tattributeRelationsFilter\n\t\t\t\t);\n\t\t\t\tif (spatialDataSources) {\n\t\t\t\t\t_forEach(spatialDataSources, dataSource => {\n\t\t\t\t\t\tfinalLayers.push(\n\t\t\t\t\t\t\tgetFinalLayerByDataSourceAndLayerState(\n\t\t\t\t\t\t\t\tdataSource,\n\t\t\t\t\t\t\t\tlayerState,\n\t\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t\tattributeDataSourceKeyAttributeKeyPairs,\n\t\t\t\t\t\t\t\tmapKey,\n\t\t\t\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\t\t\t\tattributeDataFilter\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn finalLayers.length ? finalLayers : null;\n\t} else {\n\t\treturn null;\n\t}\n}, recomputeSelectorOptions);\n\nexport default {\n\tisMapInUse,\n\tisMapSetInUse,\n\n\tgetSubstate,\n\n\tgetActiveMapKey,\n\tgetActiveMap,\n\n\tgetAllLayersStateByMapKey,\n\tgetAllMapSetsMaps,\n\tgetAllMapsInUse,\n\tgetAllMapSetsInUse,\n\n\tgetAttributeDataFilterFromLayerState,\n\tgetAttributeRelationsFilterFromLayerState,\n\n\tgetBackgroundLayerStateByMapKey,\n\tgetFilterByActiveByMapKey,\n\tgetFinalLayerByDataSourceAndLayerState,\n\tgetLayerStateByLayerKeyAndMapKey,\n\tgetLayersStateByMapKey,\n\tgetMetadataModifiersByMapKey,\n\n\tgetMapBackgroundLayerStateByMapKey,\n\tgetMapBackgroundLayer,\n\tgetMapByKey,\n\tgetMapFilterByActiveByMapKey,\n\tgetMapLayerStateByMapKeyAndLayerKey,\n\tgetMapLayersStateByMapKey,\n\tgetMapLayers,\n\tgetMapLayersStateWithModifiersByMapKey,\n\tgetMapMetadataModifiersByMapKey,\n\n\tgetMapSetActiveMapKey,\n\tgetMapSetActiveMapView,\n\tgetMapSetBackgroundLayerStateByMapKey,\n\tgetMapSetByMapKey,\n\tgetMapSetByKey,\n\tgetMapSetFilterByActiveByMapKey,\n\tgetMapSetLayersStateByMapKey,\n\tgetMapSetLayersStateWithModifiersByMapKey,\n\tgetMapSetMetadataModifiersByMapKey,\n\tgetMapSetMapKeys,\n\tgetMapSetMaps,\n\tgetMapSets,\n\tgetMapSetView,\n\tgetMapSetViewLimits,\n\n\tgetVisibleTilesByMapKey,\n\tgetSpatialRelationsFilterFromLayerState,\n\n\tgetViewByMapKey,\n\tgetViewportByMapKey,\n\tgetViewLimitsByMapKey,\n};\n","import createCachedSelector from 're-reselect';\nimport {isEmpty as _isEmpty, pickBy as _pickBy} from 'lodash';\nimport moment from 'moment';\n\nimport common from '../_common/selectors';\n\nconst getSubstate = state => state.periods;\n\nconst getAll = common.getAll(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\nconst getActive = common.getActive(getSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\nconst getActiveKeys = common.getActiveKeys(getSubstate);\nconst getActiveModels = common.getActiveModels(getSubstate);\n\nconst getByKey = common.getByKey(getSubstate);\nconst getByKeys = common.getByKeys(getSubstate);\nconst getByKeysAsObject = common.getByKeysAsObject(getSubstate);\n\nconst getDataByKey = common.getDataByKey(getSubstate);\nconst getDeletePermissionByKey = common.getDeletePermissionByKey(getSubstate);\n\nconst getEditedActive = common.getEditedActive(getSubstate);\nconst getEditedAll = common.getEditedAll(getSubstate);\nconst getEditedAllAsObject = common.getEditedAllAsObject(getSubstate);\nconst getEditedByKey = common.getEditedByKey(getSubstate);\nconst getEditedDataByKey = common.getEditedDataByKey(getSubstate);\nconst getEditedKeys = common.getEditedKeys(getSubstate);\n\nconst getIndexed = common.getIndexed(getSubstate);\nconst getStateToSave = common.getStateToSave(getSubstate);\nconst getUpdatePermissionByKey = common.getUpdatePermissionByKey(getSubstate);\nconst getUsedKeysForComponent = common.getUsedKeysForComponent(getSubstate);\n\nconst haveAllKeysRegisteredUse = common.haveAllKeysRegisteredUse(getSubstate);\n\n/**\n * Both start and end time must be defined, otherwise all available periods are returned.\n */\n\n/**\n * Get periods which are between defined bounds\n * @param state {Object}\n * @param limitStart {string} moment-like time string\n * @param limitEnd {string} moment-like time string\n * @param {Object} Models\n */\nconst getAsObjectByFullPeriod = createCachedSelector(\n\t[\n\t\tgetAllAsObject,\n\t\t(state, limitStart) => limitStart,\n\t\t(state, limitStart, limitEnd) => limitEnd,\n\t],\n\t(periods, limitStart, limitEnd) => {\n\t\tif (periods && limitStart && limitEnd) {\n\t\t\tconst selectedPeriods = _pickBy(periods, period => {\n\t\t\t\tconst periodStart = period.data?.start;\n\t\t\t\tconst periodEnd = period.data?.end;\n\n\t\t\t\tif (periodStart && periodEnd) {\n\t\t\t\t\treturn (\n\t\t\t\t\t\tmoment(periodStart).isBetween(limitStart, limitEnd, null, '[]') &&\n\t\t\t\t\t\tmoment(periodEnd).isBetween(limitStart, limitEnd, null, '[]')\n\t\t\t\t\t);\n\t\t\t\t} else if (periodStart) {\n\t\t\t\t\treturn moment(periodStart).isBetween(\n\t\t\t\t\t\tlimitStart,\n\t\t\t\t\t\tlimitEnd,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\t'[]'\n\t\t\t\t\t);\n\t\t\t\t} else if (periodEnd) {\n\t\t\t\t\treturn moment(periodEnd).isBetween(limitStart, limitEnd, null, '[]');\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn _isEmpty(selectedPeriods) ? null : selectedPeriods;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n)((state, limitStart, limitEnd) => `${limitStart}_${limitEnd}`);\n\nexport default {\n\tgetActive,\n\tgetActiveKey,\n\tgetActiveKeys,\n\tgetActiveModels,\n\tgetAll,\n\tgetAllAsObject,\n\n\tgetByKey,\n\tgetByKeys,\n\tgetByKeysAsObject,\n\tgetAsObjectByFullPeriod,\n\n\tgetDataByKey,\n\tgetDeletePermissionByKey,\n\n\tgetEditedActive,\n\tgetEditedAll,\n\tgetEditedAllAsObject,\n\tgetEditedByKey,\n\tgetEditedDataByKey,\n\tgetEditedKeys,\n\n\tgetIndexed,\n\n\tgetStateToSave,\n\tgetSubstate,\n\n\tgetUpdatePermissionByKey,\n\tgetUsedKeysForComponent,\n\n\thaveAllKeysRegisteredUse,\n};\n","import {createSelector} from 'reselect';\nimport {map as mapUtils} from '@gisatcz/ptr-utils';\nimport common from '../_common/selectors';\n\nconst getSubstate = state => state.places;\n\nconst getAll = common.getAll(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\nconst getActiveKeys = common.getActiveKeys(getSubstate);\nconst getActive = common.getActive(getSubstate);\nconst getActiveModels = common.getActiveModels(getSubstate);\nconst getByKey = common.getByKey(getSubstate);\nconst getByKeys = common.getByKeys(getSubstate);\nconst getByKeysAsObject = common.getByKeysAsObject(getSubstate);\n\nconst getDataByKey = common.getDataByKey(getSubstate);\nconst getDeletePermissionByKey = common.getDeletePermissionByKey(getSubstate);\n\nconst getEditedActive = common.getEditedActive(getSubstate);\nconst getEditedAll = common.getEditedAll(getSubstate);\nconst getEditedAllAsObject = common.getEditedAllAsObject(getSubstate);\nconst getEditedByKey = common.getEditedByKey(getSubstate);\nconst getEditedDataByKey = common.getEditedDataByKey(getSubstate);\nconst getEditedKeys = common.getEditedKeys(getSubstate);\n\nconst getIndexed = common.getIndexed(getSubstate);\nconst getStateToSave = common.getStateToSave(getSubstate);\nconst getUpdatePermissionByKey = common.getUpdatePermissionByKey(getSubstate);\nconst getUsedKeysForComponent = common.getUsedKeysForComponent(getSubstate);\n\nconst haveAllKeysRegisteredUse = common.haveAllKeysRegisteredUse(getSubstate);\n\nexport default {\n\tgetAll,\n\tgetAllAsObject,\n\tgetActiveKey,\n\tgetActiveKeys,\n\tgetActive,\n\tgetActiveModels,\n\n\tgetByKey,\n\tgetByKeys,\n\tgetByKeysAsObject,\n\n\tgetDataByKey,\n\tgetDeletePermissionByKey,\n\n\tgetEditedActive,\n\tgetEditedAll,\n\tgetEditedAllAsObject,\n\tgetEditedByKey,\n\tgetEditedDataByKey,\n\tgetEditedKeys,\n\n\tgetIndexed,\n\n\tgetStateToSave,\n\tgetSubstate,\n\n\tgetUpdatePermissionByKey,\n\tgetUsedKeysForComponent,\n\n\thaveAllKeysRegisteredUse,\n};\n","import common from '../_common/selectors';\n\nconst getSubstate = state => state.scenarios;\n\nconst getAll = common.getAll(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\nconst getActiveKeys = common.getActiveKeys(getSubstate);\nconst getActive = common.getActive(getSubstate);\nconst getActiveModels = common.getActiveModels(getSubstate);\n\nconst getByKey = common.getByKey(getSubstate);\nconst getByKeys = common.getByKeys(getSubstate);\nconst getByKeysAsObject = common.getByKeysAsObject(getSubstate);\n\nconst getDataByKey = common.getDataByKey(getSubstate);\nconst getDeletePermissionByKey = common.getDeletePermissionByKey(getSubstate);\n\nconst getEditedActive = common.getEditedActive(getSubstate);\nconst getEditedAll = common.getEditedAll(getSubstate);\nconst getEditedAllAsObject = common.getEditedAllAsObject(getSubstate);\nconst getEditedByKey = common.getEditedByKey(getSubstate);\nconst getEditedDataByKey = common.getEditedDataByKey(getSubstate);\nconst getEditedKeys = common.getEditedKeys(getSubstate);\n\nconst getIndexed = common.getIndexed(getSubstate);\n\nconst getStateToSave = common.getStateToSave(getSubstate);\n\nconst getUpdatePermissionByKey = common.getUpdatePermissionByKey(getSubstate);\nconst getUsedKeysForComponent = common.getUsedKeysForComponent(getSubstate);\n\nconst haveAllKeysRegisteredUse = common.haveAllKeysRegisteredUse(getSubstate);\n\nexport default {\n\tgetActive,\n\tgetActiveModels,\n\tgetActiveKey,\n\tgetActiveKeys,\n\tgetAll,\n\tgetAllAsObject,\n\tgetByKey,\n\tgetByKeys,\n\tgetByKeysAsObject,\n\tgetDataByKey,\n\tgetDeletePermissionByKey,\n\n\tgetEditedActive,\n\tgetEditedAll,\n\tgetEditedAllAsObject,\n\tgetEditedByKey,\n\tgetEditedDataByKey,\n\tgetEditedKeys,\n\n\tgetIndexed,\n\n\tgetStateToSave,\n\tgetSubstate,\n\n\tgetUpdatePermissionByKey,\n\tgetUsedKeysForComponent,\n\n\thaveAllKeysRegisteredUse,\n};\n","import {createSelector} from 'reselect';\nimport common from '../_common/selectors';\n\nconst getSubstate = state => state.scopes;\n\nconst getAll = common.getAll(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\nconst getActive = common.getActive(getSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\n\nconst getByKey = common.getByKey(getSubstate);\nconst getByKeys = common.getByKeys(getSubstate);\nconst getByKeysAsObject = common.getByKeysAsObject(getSubstate);\n\nconst getDataByKey = common.getDataByKey(getSubstate);\n\nconst getEditedActive = common.getEditedActive(getSubstate);\nconst getEditedAll = common.getEditedAll(getSubstate);\nconst getEditedAllAsObject = common.getEditedAllAsObject(getSubstate);\nconst getEditedByKey = common.getEditedByKey(getSubstate);\nconst getEditedDataByKey = common.getEditedDataByKey(getSubstate);\nconst getEditedKeys = common.getEditedKeys(getSubstate);\n\nconst getDeletePermissionByKey = common.getDeletePermissionByKey(getSubstate);\nconst getUpdatePermissionByKey = common.getUpdatePermissionByKey(getSubstate);\nconst getUsedKeysForComponent = common.getUsedKeysForComponent(getSubstate);\n\nconst getIndexed = common.getIndexed(getSubstate);\n\nconst getStateToSave = common.getStateToSave(getSubstate);\n\nconst haveAllKeysRegisteredUse = common.haveAllKeysRegisteredUse(getSubstate);\n\nconst getActiveScopeConfiguration = createSelector([getActive], scope => {\n\treturn scope?.data?.configuration || null;\n});\n\nexport default {\n\tgetActive,\n\tgetActiveKey,\n\tgetActiveScopeConfiguration,\n\tgetAll,\n\tgetAllAsObject,\n\n\tgetByKey,\n\tgetByKeys,\n\tgetByKeysAsObject,\n\tgetDataByKey,\n\tgetDeletePermissionByKey,\n\n\tgetEditedActive,\n\tgetEditedAll,\n\tgetEditedAllAsObject,\n\tgetEditedByKey,\n\tgetEditedDataByKey,\n\tgetEditedKeys,\n\n\tgetIndexed,\n\n\tgetStateToSave,\n\tgetSubstate,\n\n\tgetUpdatePermissionByKey,\n\tgetUsedKeysForComponent,\n\n\thaveAllKeysRegisteredUse,\n};\n","import _ from 'lodash';\nimport {createSelector} from 'reselect';\n\nconst getAllScreensAsObject = state => state.screens.screens;\nconst getAllSetsAsObject = state => state.screens.sets;\n\n/**\n * @param state {Object}\n * @param key {string} set key\n */\nconst getSetByKey = createSelector(\n\t[getAllSetsAsObject, (state, key) => key],\n\t/**\n\t * @param sets {Object} all sets as object\n\t * @param key {string} set key\n\t * @return {Object | null} selected object\n\t */\n\t(sets, key) => {\n\t\tif (sets && !_.isEmpty(sets) && key && sets[key]) {\n\t\t\treturn sets[key];\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\n/**\n * @param state {Object}\n * @param key {string} set key\n */\nconst getScreensBySetKey = createSelector(\n\t[getSetByKey, getAllScreensAsObject],\n\t/**\n\t * @param set {Object} set\n\t * @param screens {Object} all screens as object\n\t * @return {null | Object} selected screen\n\t */\n\t(set, screens) => {\n\t\tif (set) {\n\t\t\tlet setScreens = {};\n\t\t\t_.each(set.orderBySpace, lineage => {\n\t\t\t\tsetScreens[lineage] = screens[lineage];\n\t\t\t});\n\t\t\treturn setScreens;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\n/**\n * @param state {Object}\n * @param screenLineage {string}\n */\nconst getSetKeyByScreenLineage = createSelector(\n\t[getAllSetsAsObject, (state, screenLineage) => screenLineage],\n\t/**\n\t * @param sets {Object} all sets as object\n\t * @param lineage {string}\n\t * @return {string | null} screen set key\n\t */\n\t(sets, lineage) => {\n\t\tlet setKey = null;\n\n\t\t_.forIn(sets, (value, key) => {\n\t\t\tif (_.includes(value.orderByHistory, lineage)) {\n\t\t\t\tsetKey = key;\n\t\t\t}\n\t\t});\n\n\t\treturn setKey;\n\t}\n);\n\n/**\n * @param state {Object}\n * @param screenLineage {string}\n */\nconst getScreenByLineage = createSelector(\n\t[getAllScreensAsObject, (state, lineage) => lineage],\n\t/**\n\t * @param screens {object} all screens as object\n\t * @param lineage {string}\n\t * @return {Object | null} screen\n\t */\n\t(screens, lineage) => {\n\t\tif (screens && !_.isEmpty(screens) && lineage && screens[lineage]) {\n\t\t\treturn screens[lineage];\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\nexport default {\n\tgetScreenByLineage,\n\tgetScreensBySetKey,\n\tgetSetByKey,\n\tgetSetKeyByScreenLineage,\n};\n","import common from '../_common/selectors';\n\nconst getSubstate = state => state.tags;\n\nconst getActive = common.getActive(getSubstate);\nconst getActiveModels = common.getActiveModels(getSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\nconst getActiveKeys = common.getActiveKeys(getSubstate);\nconst getAll = common.getAll(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\n\nconst getByKey = common.getByKey(getSubstate);\nconst getByKeys = common.getByKeys(getSubstate);\nconst getByKeysAsObject = common.getByKeysAsObject(getSubstate);\n\nconst getDataByKey = common.getDataByKey(getSubstate);\n\nconst getEditedActive = common.getEditedActive(getSubstate);\nconst getEditedAll = common.getEditedAll(getSubstate);\nconst getEditedAllAsObject = common.getEditedAllAsObject(getSubstate);\nconst getEditedByKey = common.getEditedByKey(getSubstate);\nconst getEditedDataByKey = common.getEditedDataByKey(getSubstate);\nconst getEditedKeys = common.getEditedKeys(getSubstate);\n\nconst getIndexed = common.getIndexed(getSubstate);\n\nconst getStateToSave = common.getStateToSave(getSubstate);\n\nconst getDeletePermissionByKey = common.getDeletePermissionByKey(getSubstate);\nconst getUpdatePermissionByKey = common.getUpdatePermissionByKey(getSubstate);\nconst getUsedKeysForComponent = common.getUsedKeysForComponent(getSubstate);\nconst haveAllKeysRegisteredUse = common.haveAllKeysRegisteredUse(getSubstate);\n\nexport default {\n\tgetActive,\n\tgetActiveKey,\n\tgetActiveKeys,\n\tgetActiveModels,\n\tgetAll,\n\tgetAllAsObject,\n\tgetByKey,\n\tgetByKeys,\n\tgetByKeysAsObject,\n\n\tgetDataByKey,\n\tgetDeletePermissionByKey,\n\n\tgetEditedActive,\n\tgetEditedAll,\n\tgetEditedAllAsObject,\n\tgetEditedByKey,\n\tgetEditedDataByKey,\n\tgetEditedKeys,\n\n\tgetIndexed,\n\n\tgetStateToSave,\n\tgetSubstate,\n\n\tgetUpdatePermissionByKey,\n\tgetUsedKeysForComponent,\n\n\thaveAllKeysRegisteredUse,\n};\n","import {createSelector} from 'reselect';\nimport createCachedSelector from 're-reselect';\nimport _ from 'lodash';\n\nimport common from '../_common/selectors';\nimport ScopeSelectors from '../Scopes/selectors';\n\nconst DEFAULT_CATEGORY = 'metadata';\n\nconst getSubstate = state => state.users;\nconst getGroupsSubstate = state => state.users.groups;\n\nconst getAll = common.getAll(getSubstate);\nconst getGroups = common.getAll(getGroupsSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\nconst getActive = common.getActive(getSubstate);\nconst getByKey = common.getByKey(getSubstate);\n\nconst isLoggedIn = state => !!state.users.activeKey;\nconst isAdmin = state => state.users.isAdmin;\n\nconst getById = createSelector(\n\t[getAll, (state, userId) => userId],\n\t(users, userId) => {\n\t\tif ((users, userId)) {\n\t\t\treturn users.find(user => user.id === userId);\n\t\t}\n\t\treturn false;\n\t}\n);\n\nconst isAdminGroupMember = createSelector([getActive], user => {\n\tif (user) {\n\t\treturn _.includes(user.groups, 1);\n\t}\n\treturn false;\n});\n\nconst getActiveUserPermissions = createSelector([getActive], user => {\n\tif (user && user.permissions) {\n\t\treturn user.permissions;\n\t} else {\n\t\treturn null;\n\t}\n});\n\nconst isAdminOrAdminGroupMember = createSelector(\n\t[isAdmin, isAdminGroupMember],\n\t(isAdmin, isAdminGroupMember) => {\n\t\treturn isAdmin || isAdminGroupMember;\n\t}\n);\n\nconst getGroupKeysForActiveUser = createSelector([getActive], activeUser => {\n\tif (activeUser && activeUser.groups) {\n\t\treturn activeUser.groups;\n\t} else {\n\t\treturn [];\n\t}\n});\n\nconst hasActiveUserPermissionToCreate = createSelector(\n\t[\n\t\tgetActiveUserPermissions,\n\t\t(state, type) => type,\n\t\t(state, type, category) => category,\n\t],\n\t(permissions, type, category = DEFAULT_CATEGORY) => {\n\t\treturn (\n\t\t\ttype &&\n\t\t\tpermissions &&\n\t\t\tpermissions[category] &&\n\t\t\tpermissions[category][type] &&\n\t\t\tpermissions[category][type].create\n\t\t);\n\t}\n);\n\nconst isDromasAdmin = state => {\n\tlet isDromasAdmin = false;\n\tif (state.users && state.users.data && state.users.data.length) {\n\t\tconst currentUser = state.users.data.filter(\n\t\t\tuser => user.key === state.users.activeKey\n\t\t);\n\t\tif (currentUser.length > 0) {\n\t\t\tcurrentUser[0].groups.forEach(group => {\n\t\t\t\tif (group.name === 'Aktualizace LPIS Gisat admin') {\n\t\t\t\t\tisDromasAdmin = true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\treturn isDromasAdmin || state.users.isAdmin;\n};\n\nconst getActiveUserDromasLpisChangeReviewGroup = createSelector(\n\t[getGroupKeysForActiveUser, ScopeSelectors.getActiveScopeConfiguration],\n\t(activeUserGroupKeys, activeScopeConfiguration) => {\n\t\tif (\n\t\t\t_.includes(\n\t\t\t\tactiveUserGroupKeys,\n\t\t\t\tactiveScopeConfiguration.dromasLpisChangeReview.groups.gisatAdmins\n\t\t\t)\n\t\t) {\n\t\t\treturn 'gisatAdmins';\n\t\t} else if (\n\t\t\t_.includes(\n\t\t\t\tactiveUserGroupKeys,\n\t\t\t\tactiveScopeConfiguration.dromasLpisChangeReview.groups.szifAdmins\n\t\t\t)\n\t\t) {\n\t\t\treturn 'szifAdmins';\n\t\t} else if (\n\t\t\t_.includes(\n\t\t\t\tactiveUserGroupKeys,\n\t\t\t\tactiveScopeConfiguration.dromasLpisChangeReview.groups.gisatUsers\n\t\t\t)\n\t\t) {\n\t\t\treturn 'gisatUsers';\n\t\t} else if (\n\t\t\t_.includes(\n\t\t\t\tactiveUserGroupKeys,\n\t\t\t\tactiveScopeConfiguration.dromasLpisChangeReview.groups.szifUsers\n\t\t\t)\n\t\t) {\n\t\t\treturn 'szifUsers';\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\nexport default {\n\tgetAll,\n\n\tgetActive,\n\tgetByKey,\n\tgetById,\n\n\tgetActiveKey: getActiveKey,\n\tgetActiveUser: getActive,\n\tgetGroupKeysForActiveUser: getGroupKeysForActiveUser,\n\tgetGroupsForActiveUser: getGroupKeysForActiveUser,\n\tgetUsers: getAll,\n\tgetGroups: getGroups,\n\tgetSubstate: getSubstate,\n\tgetGroupsSubstate,\n\n\thasActiveUserPermissionToCreate,\n\n\tisAdmin: isAdmin,\n\tisAdminGroupMember: isAdminGroupMember,\n\tisAdminOrAdminGroupMember: isAdminOrAdminGroupMember,\n\tisLoggedIn: isLoggedIn,\n\tisDromasAdmin: isDromasAdmin,\n\n\tgetActiveUserDromasLpisChangeReviewGroup: getActiveUserDromasLpisChangeReviewGroup,\n};\n","import {createSelector} from 'reselect';\n\nimport common from '../_common/selectors';\n\nimport attributesSelectors from '../Attributes/selectors';\nimport attributeSetsSelectors from '../AttributeSets/selectors';\nimport componentsSelectors from '../Components/selectors';\nimport scopesSelectors from '../Scopes/selectors';\n\nconst getSubstate = state => state.views;\n\nconst getActive = common.getActive(getSubstate);\nconst getActiveKey = common.getActiveKey(getSubstate);\n\nconst getAll = common.getAll(getSubstate);\nconst getAllAsObject = common.getAllAsObject(getSubstate);\n\nconst getByKey = common.getByKey(getSubstate);\nconst getByKeys = common.getByKeys(getSubstate);\nconst getByKeysAsObject = common.getByKeysAsObject(getSubstate);\n\nconst getDataByKey = common.getDataByKey(getSubstate);\nconst getEditedActive = common.getEditedActive(getSubstate);\nconst getEditedAll = common.getEditedAll(getSubstate);\nconst getEditedAllAsObject = common.getEditedAllAsObject(getSubstate);\nconst getEditedByKey = common.getEditedByKey(getSubstate);\nconst getEditedDataByKey = common.getEditedDataByKey(getSubstate);\nconst getEditedKeys = common.getEditedKeys(getSubstate);\n\nconst getIndexed = common.getIndexed(getSubstate);\n\nconst getDeletePermissionByKey = common.getDeletePermissionByKey(getSubstate);\nconst getUpdatePermissionByKey = common.getUpdatePermissionByKey(getSubstate);\nconst getUsedKeysForComponent = common.getUsedKeysForComponent(getSubstate);\nconst haveAllKeysRegisteredUse = common.haveAllKeysRegisteredUse(getSubstate);\n\n// TODO add other stores\nconst getStateToSave = createSelector(\n\t[\n\t\tattributesSelectors.getStateToSave,\n\t\tattributeSetsSelectors.getStateToSave,\n\t\tcomponentsSelectors.getStateToSave,\n\t\tscopesSelectors.getStateToSave,\n\t],\n\t(attributes, attributeSets, components, scopes) => {\n\t\treturn {\n\t\t\tattributes,\n\t\t\tattributeSets,\n\t\t\tcomponents,\n\t\t\tscopes,\n\t\t};\n\t}\n);\n\nexport default {\n\tgetActive,\n\tgetActiveKey,\n\tgetAll,\n\tgetAllAsObject,\n\n\tgetByKey,\n\tgetByKeys,\n\tgetByKeysAsObject,\n\n\tgetDataByKey,\n\tgetDeletePermissionByKey,\n\n\tgetEditedActive,\n\tgetEditedAll,\n\tgetEditedAllAsObject,\n\tgetEditedByKey,\n\tgetEditedDataByKey,\n\tgetEditedKeys,\n\n\tgetIndexed,\n\n\tgetStateToSave,\n\tgetSubstate,\n\n\tgetUpdatePermissionByKey,\n\tgetUsedKeysForComponent,\n\n\thaveAllKeysRegisteredUse,\n};\n","import _ from 'lodash';\nimport {createSelector} from 'reselect';\n\nconst getAllSetsAsObject = state => state.windows.sets;\nconst getAllWindowsAsObject = state => state.windows.windows;\n\nconst getSetByKey = createSelector(\n\t[getAllSetsAsObject, (state, key) => key],\n\t(sets, key) => {\n\t\treturn sets && sets[key];\n\t}\n);\n\nconst getWindow = createSelector(\n\t[getAllWindowsAsObject, (state, key) => key],\n\t(windows, key) => {\n\t\treturn windows && windows[key];\n\t}\n);\n\nconst getWindowsBySetKeyAsObject = createSelector(\n\t[getSetByKey, getAllWindowsAsObject],\n\t(set, windows) => {\n\t\tif (set && set.orderByHistory && set.orderByHistory.length) {\n\t\t\tlet setWindows = {};\n\t\t\t_.each(set.orderByHistory, key => {\n\t\t\t\tsetWindows[key] = windows[key];\n\t\t\t});\n\t\t\treturn setWindows;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n);\n\nconst isOpen = createSelector([getWindow], window => {\n\treturn window && window.data && window.data.state === 'open';\n});\n\nexport default {\n\tgetSetByKey,\n\tgetWindow,\n\tgetWindowsBySetKeyAsObject,\n\tisOpen,\n};\n","import App from './App/selectors';\nimport Areas from './Areas/selectors';\nimport AreaRelations from './AreaRelations/selectors';\nimport Attributes from './Attributes/selectors';\nimport AttributeSets from './AttributeSets/selectors';\nimport Cases from './Cases/selectors';\nimport Components from './Components/selectors';\nimport Data from './Data/selectors';\nimport LayerTemplates from './LayerTemplates/selectors';\nimport LayerTrees from './LayerTrees/selectors';\nimport Maps from './Maps/selectors';\nimport Periods from './Periods/selectors';\nimport Places from './Places/selectors';\nimport Scenarios from './Scenarios/selectors';\nimport Scopes from './Scopes/selectors';\nimport Screens from './Screens/selectors';\nimport Selections from './Selections/selectors';\nimport Styles from './Styles/selectors';\nimport Tags from './Tags/selectors';\nimport Users from './Users/selectors';\nimport Views from './Views/selectors';\nimport Windows from './Windows/selectors';\n\nexport default {\n\tapp: App,\n\tareas: Areas,\n\tareaRelations: AreaRelations,\n\tattributes: Attributes,\n\tattributeSets: AttributeSets,\n\tcases: Cases,\n\tcomponents: Components,\n\tdata: Data,\n\tlayerTemplates: LayerTemplates,\n\tlayerTrees: LayerTrees,\n\tmaps: Maps,\n\tperiods: Periods,\n\tplaces: Places,\n\tscenarios: Scenarios,\n\tscopes: Scopes,\n\tscreens: Screens,\n\tselections: Selections,\n\tstyles: Styles,\n\ttags: Tags,\n\tusers: Users,\n\tviews: Views,\n\twindows: Windows,\n};\n","import _, {isEqual} from 'lodash';\nimport path from 'path';\nimport moment from 'moment';\n\nimport request from './request';\nimport commonHelpers from './helpers';\nimport commonSelectors from './selectors';\nimport Select from '../Select';\nimport ActionTypes from '../../constants/ActionTypes';\n\nimport {utils} from '@gisatcz/ptr-utils';\nimport {configDefaults} from '@gisatcz/ptr-core';\n\nconst DEFAULT_CATEGORY_PATH = 'metadata';\n\n// ============ factories ===========\n\nconst add = action => {\n\treturn data => {\n\t\treturn dispatch => {\n\t\t\tif (!_.isArray(data)) data = [data];\n\t\t\tdispatch(action(data));\n\t\t};\n\t};\n};\n\nconst addIndex = action => {\n\treturn (filter, order, count, start, data, changedOn) => {\n\t\treturn dispatch => {\n\t\t\tdispatch(action(filter, order, count, start, data, changedOn));\n\t\t};\n\t};\n};\n\nconst apiDelete = (dataType, categoryPath, data) => {\n\treturn (dispatch, getState) => {\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(getState());\n\t\tconst apiPath = 'rest/' + categoryPath;\n\t\tconst payload = {\n\t\t\tdata: {\n\t\t\t\t[dataType]: data,\n\t\t\t},\n\t\t};\n\t\treturn request(localConfig, apiPath, 'DELETE', null, payload)\n\t\t\t.then(result => {\n\t\t\t\tif (\n\t\t\t\t\t(result.errors && result.errors[dataType]) ||\n\t\t\t\t\t(result.data && !result.data[dataType])\n\t\t\t\t) {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tactionGeneralError(result.errors[dataType] || new Error('no data'))\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tconst itemsDeleted = result.data[dataType];\n\t\t\t\t\tif (itemsDeleted.length > 0) {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(`No data updated for ${dataType} metadata type`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tdispatch(actionGeneralError(error));\n\t\t\t});\n\t};\n};\n\nconst apiUpdate = (\n\tgetSubstate,\n\tdataType,\n\tactionTypes,\n\tcategoryPath,\n\teditedData\n) => {\n\treturn (dispatch, getState) => {\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(getState());\n\t\tconst apiPath = 'rest/' + categoryPath;\n\t\tconst payload = {\n\t\t\tdata: {\n\t\t\t\t[dataType]: editedData,\n\t\t\t},\n\t\t};\n\t\treturn request(localConfig, apiPath, 'PUT', null, payload)\n\t\t\t.then(result => {\n\t\t\t\tif (\n\t\t\t\t\t(result.errors && result.errors[dataType]) ||\n\t\t\t\t\t(result.data && !result.data[dataType])\n\t\t\t\t) {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tactionGeneralError(result.errors[dataType] || new Error('no data'))\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\treceiveUpdated(\n\t\t\t\t\t\t\tgetSubstate,\n\t\t\t\t\t\t\tactionTypes,\n\t\t\t\t\t\t\tresult,\n\t\t\t\t\t\t\tdataType,\n\t\t\t\t\t\t\tcategoryPath\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tdispatch(actionGeneralError(error));\n\t\t\t});\n\t};\n};\n\nconst updateEdited = (getSubstate, actionTypes) => {\n\treturn (modelKey, key, value) => {\n\t\treturn (dispatch, getState) => {\n\t\t\tif (!getSubstate) {\n\t\t\t\treturn dispatch(\n\t\t\t\t\tactionGeneralError(\n\t\t\t\t\t\t'common/actions#updateEdited: setSubstate parameter is missing!'\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (!actionTypes) {\n\t\t\t\treturn dispatch(\n\t\t\t\t\tactionGeneralError(\n\t\t\t\t\t\t'common/actions#updateEdited: actionTypes parameter is missing!'\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (!modelKey) {\n\t\t\t\treturn dispatch(\n\t\t\t\t\tactionGeneralError(\n\t\t\t\t\t\t'common/actions#updateEdited: Model key is missing!'\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (!key) {\n\t\t\t\treturn dispatch(\n\t\t\t\t\tactionGeneralError(\n\t\t\t\t\t\t'common/actions#updateEdited: Property key is missing!'\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tlet originalModel = commonSelectors.getByKey(getSubstate)(\n\t\t\t\tgetState(),\n\t\t\t\tmodelKey\n\t\t\t);\n\n\t\t\t// delete property from edited, if the value in update is the same as in state\n\t\t\t//TODO - test\n\t\t\tif (\n\t\t\t\toriginalModel &&\n\t\t\t\t(value === originalModel.data[key] ||\n\t\t\t\t\tisEqual(originalModel.data[key], value))\n\t\t\t) {\n\t\t\t\tdispatch(actionRemovePropertyFromEdited(actionTypes, modelKey, key));\n\t\t\t} else {\n\t\t\t\tdispatch(\n\t\t\t\t\tactionUpdateEdited(actionTypes, [\n\t\t\t\t\t\t{key: modelKey, data: {[key]: value}},\n\t\t\t\t\t])\n\t\t\t\t);\n\t\t\t}\n\t\t};\n\t};\n};\n\nconst updateStore = (getSubstate, actionTypes) => {\n\treturn data => {\n\t\treturn dispatch => {\n\t\t\tdispatch(actionUpdateStore(actionTypes, data));\n\t\t};\n\t};\n};\n\nconst removePropertyFromEdited = actionTypes => {\n\treturn (modelKey, key) => {\n\t\treturn dispatch(actionRemovePropertyFromEdited(actionTypes, modelKey, key));\n\t};\n};\n\nconst deleteItem = (\n\tgetSubstate,\n\tdataType,\n\tactionTypes,\n\tcategoryPath = DEFAULT_CATEGORY_PATH\n) => {\n\treturn item => {\n\t\treturn (dispatch, getState) => {\n\t\t\tif (!item) {\n\t\t\t\treturn dispatch(\n\t\t\t\t\tactionGeneralError(\n\t\t\t\t\t\t'common/actions#deleteItem: item to delete is missing!'\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (!item.key) {\n\t\t\t\treturn dispatch(\n\t\t\t\t\tactionGeneralError(\n\t\t\t\t\t\t'common/actions#deleteItem: item key to delete is missing!'\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\t//dispatch deleting?\n\t\t\t//TODO\n\t\t\treturn dispatch(\n\t\t\t\tapiDelete(dataType, categoryPath, [{key: item.key}])\n\t\t\t).then(result => {\n\t\t\t\tconst data = result.data[dataType];\n\t\t\t\tconst deletedKeys = data.map(d => d.key);\n\n\t\t\t\t//Check if item deleted\n\t\t\t\tif (isEqual(deletedKeys, [item.key])) {\n\t\t\t\t\t// mark deleted items by \"deleted\" date\n\t\t\t\t\tconst deleteDate = moment(new Date().toISOString()).utc().format();\n\t\t\t\t\tdeletedKeys.forEach(key => {\n\t\t\t\t\t\tdispatch(actionMarkAsDeleted(actionTypes, key, deleteDate));\n\t\t\t\t\t});\n\n\t\t\t\t\t// remove dependencies in all edited metadata\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tactionRemovePropertyValuesFromAllEdited(dataType, deletedKeys)\n\t\t\t\t\t);\n\t\t\t\t\t// TODO check original metadata dependencies\n\n\t\t\t\t\t//refresh proper indexes\n\t\t\t\t\tconst state = getState();\n\t\t\t\t\tconst indexes =\n\t\t\t\t\t\tcommonSelectors.getIndexesByFilteredItem(getSubstate)(\n\t\t\t\t\t\t\tstate,\n\t\t\t\t\t\t\titem\n\t\t\t\t\t\t) || [];\n\t\t\t\t\tif (!_.isEmpty(indexes)) {\n\t\t\t\t\t\tindexes.forEach(index => {\n\t\t\t\t\t\t\tif (index) {\n\t\t\t\t\t\t\t\t//invalidate data\n\t\t\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\t\t\tactionClearIndex(actionTypes, index.filter, index.order)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t//refresh data\n\t\t\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\t\t\trefreshIndex(\n\t\t\t\t\t\t\t\t\t\tgetSubstate,\n\t\t\t\t\t\t\t\t\t\tdataType,\n\t\t\t\t\t\t\t\t\t\tindex.filter,\n\t\t\t\t\t\t\t\t\t\tindex.order,\n\t\t\t\t\t\t\t\t\t\tactionTypes,\n\t\t\t\t\t\t\t\t\t\tcategoryPath\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t//error\n\t\t\t\t\treturn dispatch(\n\t\t\t\t\t\tactionGeneralError(\n\t\t\t\t\t\t\t'common/actions#deleteItem: Deleted key is not equal to key to delete!'\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t};\n};\n\nconst saveEdited = (\n\tgetSubstate,\n\tdataType,\n\tactionTypes,\n\tcategoryPath = DEFAULT_CATEGORY_PATH\n) => {\n\treturn key => {\n\t\treturn (dispatch, getState) => {\n\t\t\tif (!getSubstate) {\n\t\t\t\treturn dispatch(\n\t\t\t\t\tactionGeneralError(\n\t\t\t\t\t\t'common/actions#saveEdited: setSubstate parameter is missing!'\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (!dataType) {\n\t\t\t\treturn dispatch(\n\t\t\t\t\tactionGeneralError(\n\t\t\t\t\t\t'common/actions#saveEdited: dataType parameter is missing!'\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (!actionTypes) {\n\t\t\t\treturn dispatch(\n\t\t\t\t\tactionGeneralError(\n\t\t\t\t\t\t'common/actions#saveEdited: actionTypes parameter is missing!'\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (!key) {\n\t\t\t\treturn dispatch(\n\t\t\t\t\tactionGeneralError('common/actions#saveEdited: Model key is missing!')\n\t\t\t\t);\n\t\t\t}\n\t\t\tlet state = getState();\n\t\t\tlet saved = commonSelectors.getByKey(getSubstate)(state, key);\n\t\t\tlet edited = commonSelectors.getEditedByKey(getSubstate)(state, key);\n\n\t\t\tif (saved) {\n\t\t\t\t// update\n\t\t\t\treturn dispatch(\n\t\t\t\t\tapiUpdate(getSubstate, dataType, actionTypes, categoryPath, [edited])\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\t// create\n\t\t\t\tdebugger;\n\t\t\t}\n\t\t};\n\t};\n};\n\nconst useKeys = (\n\tgetSubstate,\n\tdataType,\n\tactionTypes,\n\tcategoryPath = DEFAULT_CATEGORY_PATH\n) => {\n\treturn (keys, componentId) => {\n\t\treturn (dispatch, getState) => {\n\t\t\tconst state = getState();\n\t\t\tconst isRegistered = commonSelectors.haveAllKeysRegisteredUse(\n\t\t\t\tgetSubstate\n\t\t\t)(state, componentId, keys);\n\t\t\tif (!isRegistered) {\n\t\t\t\tdispatch(actionUseKeysRegister(actionTypes, componentId, keys));\n\t\t\t}\n\n\t\t\treturn dispatch(\n\t\t\t\tensureKeys(getSubstate, dataType, actionTypes, keys, categoryPath)\n\t\t\t);\n\t\t};\n\t};\n};\n\nconst useIndexed = (\n\tgetSubstate,\n\tdataType,\n\tactionTypes,\n\tcategoryPath = DEFAULT_CATEGORY_PATH\n) => {\n\treturn (filterByActive, filter, order, start, length, componentId) => {\n\t\treturn (dispatch, getState) => {\n\t\t\tdispatch(\n\t\t\t\tactionUseIndexedRegister(\n\t\t\t\t\tactionTypes,\n\t\t\t\t\tcomponentId,\n\t\t\t\t\tfilterByActive,\n\t\t\t\t\tfilter,\n\t\t\t\t\torder,\n\t\t\t\t\tstart,\n\t\t\t\t\tlength\n\t\t\t\t)\n\t\t\t);\n\t\t\tlet state = getState();\n\t\t\tconst activeKeys = commonSelectors.getAllActiveKeys(state);\n\n\t\t\tlet fullFilter = commonHelpers.mergeFilters(\n\t\t\t\tactiveKeys,\n\t\t\t\tfilterByActive,\n\t\t\t\tfilter\n\t\t\t);\n\t\t\treturn dispatch(\n\t\t\t\tensureIndexed(\n\t\t\t\t\tgetSubstate,\n\t\t\t\t\tdataType,\n\t\t\t\t\tfullFilter,\n\t\t\t\t\torder,\n\t\t\t\t\tstart,\n\t\t\t\t\tlength,\n\t\t\t\t\tactionTypes,\n\t\t\t\t\tcategoryPath\n\t\t\t\t)\n\t\t\t);\n\t\t};\n\t};\n};\n\n/**\n * If not refresh data, call clearIndex to invalidate data.\n */\nfunction refreshIndex(\n\tgetSubstate,\n\tdataType,\n\tfilter,\n\torder,\n\tactionTypes,\n\tcategoryPath = DEFAULT_CATEGORY_PATH\n) {\n\treturn (dispatch, getState) => {\n\t\tlet state = getState();\n\t\tlet usesForIndex = commonSelectors.getUsedIndexPage(getSubstate)(\n\t\t\tstate,\n\t\t\tfilter,\n\t\t\torder\n\t\t);\n\t\tif (usesForIndex) {\n\t\t\t_.each(usesForIndex.uses, use => {\n\t\t\t\tdispatch(\n\t\t\t\t\tensureIndexed(\n\t\t\t\t\t\tgetSubstate,\n\t\t\t\t\t\tdataType,\n\t\t\t\t\t\tusesForIndex.filter,\n\t\t\t\t\t\tusesForIndex.order,\n\t\t\t\t\t\tuse.start,\n\t\t\t\t\t\tuse.length,\n\t\t\t\t\t\tactionTypes,\n\t\t\t\t\t\tcategoryPath\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t};\n}\n\nfunction receiveIndexed(actionTypes, result, dataType, filter, order, start) {\n\treturn dispatch => {\n\t\t// add data to store\n\t\tif (result.data[dataType].length) {\n\t\t\tdispatch(actionAdd(actionTypes, result.data[dataType], filter));\n\t\t}\n\n\t\t// add to index\n\t\tdispatch(\n\t\t\tactionAddIndex(\n\t\t\t\tactionTypes,\n\t\t\t\tfilter,\n\t\t\t\torder,\n\t\t\t\tresult.total,\n\t\t\t\tstart,\n\t\t\t\tresult.data[dataType],\n\t\t\t\tresult.changes && result.changes[dataType]\n\t\t\t)\n\t\t);\n\t};\n}\n\nfunction requestWrapper(\n\tapiPath,\n\tmethod,\n\tquery,\n\tpayload,\n\tsuccessAction,\n\terrorAction\n) {\n\treturn (dispatch, getState) => {\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(getState());\n\n\t\trequest(localConfig, apiPath, method, query, payload)\n\t\t\t.then(result => {\n\t\t\t\tdispatch(successAction(result.data));\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tdispatch(errorAction(error));\n\t\t\t});\n\t};\n}\n\nfunction create(\n\tgetSubstate,\n\tdataType,\n\tactionTypes,\n\tcategoryPath = DEFAULT_CATEGORY_PATH\n) {\n\treturn (key, appKey) => {\n\t\treturn (dispatch, getState) => {\n\t\t\tconst state = getState();\n\t\t\tconst apiPath = path.join('rest', categoryPath);\n\t\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(state);\n\n\t\t\tlet applicationKey = null;\n\t\t\tif (appKey) {\n\t\t\t\tapplicationKey = appKey;\n\t\t\t} else {\n\t\t\t\tlet currentAppKey = Select.app.getKey(state);\n\t\t\t\tif (currentAppKey) {\n\t\t\t\t\tapplicationKey = currentAppKey;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst payload = getCreatePayload(dataType, key, applicationKey);\n\t\t\treturn request(localConfig, apiPath, 'POST', null, payload)\n\t\t\t\t.then(result => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t(result.errors && result.errors[dataType]) ||\n\t\t\t\t\t\t(result.data && !result.data[dataType])\n\t\t\t\t\t) {\n\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\tactionGeneralError(\n\t\t\t\t\t\t\t\tresult.errors[dataType] || new Error('no data')\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst items = result.data[dataType];\n\t\t\t\t\t\tdispatch(actionAdd(actionTypes, items));\n\n\t\t\t\t\t\tlet indexes = [];\n\t\t\t\t\t\titems.forEach(item => {\n\t\t\t\t\t\t\tindexes =\n\t\t\t\t\t\t\t\tindexes.concat(\n\t\t\t\t\t\t\t\t\t// Find out indexes which could include new item\n\t\t\t\t\t\t\t\t\tcommonSelectors.getIndexesByFilteredItem(getSubstate)(\n\t\t\t\t\t\t\t\t\t\tgetState(),\n\t\t\t\t\t\t\t\t\t\titem\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t) || [];\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tlet uniqueIndexes = commonHelpers.getUniqueIndexes(indexes);\n\t\t\t\t\t\tif (!_.isEmpty(uniqueIndexes)) {\n\t\t\t\t\t\t\tuniqueIndexes.forEach(index => {\n\t\t\t\t\t\t\t\tif (index) {\n\t\t\t\t\t\t\t\t\t//invalidate data\n\t\t\t\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\t\t\t\tactionClearIndex(actionTypes, index.filter, index.order)\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t//refresh data\n\t\t\t\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\t\t\t\trefreshIndex(\n\t\t\t\t\t\t\t\t\t\t\tgetSubstate,\n\t\t\t\t\t\t\t\t\t\t\tdataType,\n\t\t\t\t\t\t\t\t\t\t\tindex.filter,\n\t\t\t\t\t\t\t\t\t\t\tindex.order,\n\t\t\t\t\t\t\t\t\t\t\tactionTypes,\n\t\t\t\t\t\t\t\t\t\t\tcategoryPath\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(error => {\n\t\t\t\t\tdispatch(actionGeneralError(error));\n\t\t\t\t});\n\t\t};\n\t};\n}\n\nfunction ensureKeys(\n\tgetSubstate,\n\tdataType,\n\tactionTypes,\n\tkeys,\n\tcategoryPath = DEFAULT_CATEGORY_PATH\n) {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\tconst PAGE_SIZE =\n\t\t\tSelect.app.getLocalConfiguration(state, 'requestPageSize') ||\n\t\t\tconfigDefaults.requestPageSize;\n\n\t\tlet keysToLoad = commonSelectors.getKeysToLoad(getSubstate)(state, keys);\n\t\tlet promises = [];\n\n\t\tif (keysToLoad) {\n\t\t\tkeysToLoad = _.chunk(keysToLoad, PAGE_SIZE);\n\t\t\t_.each(keysToLoad, keysToLoadPage => {\n\t\t\t\tpromises.push(\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tloadKeysPage(dataType, actionTypes, keysToLoadPage, categoryPath)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\treturn Promise.all(promises);\n\t};\n}\n\nfunction ensureIndexed(\n\tgetSubstate,\n\tdataType,\n\tfilter,\n\torder,\n\tstart,\n\tlength,\n\tactionTypes,\n\tcategoryPath = DEFAULT_CATEGORY_PATH\n) {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(state);\n\t\tconst PAGE_SIZE =\n\t\t\tlocalConfig.requestPageSize || configDefaults.requestPageSize;\n\t\tlet total = commonSelectors.getIndexTotal(getSubstate)(\n\t\t\tstate,\n\t\t\tfilter,\n\t\t\torder\n\t\t);\n\t\tlet changedOn = commonSelectors.getIndexChangedOn(getSubstate)(\n\t\t\tstate,\n\t\t\tfilter,\n\t\t\torder\n\t\t);\n\n\t\tif (total != null) {\n\t\t\t// we have existing index, we only load what we don't have\n\n\t\t\tconst indexPage =\n\t\t\t\tcommonSelectors.getIndexPage(getSubstate)(\n\t\t\t\t\tstate,\n\t\t\t\t\tfilter,\n\t\t\t\t\torder,\n\t\t\t\t\tstart,\n\t\t\t\t\tlength\n\t\t\t\t) || {};\n\t\t\tconst pages = _.chunk(Object.values(indexPage), PAGE_SIZE);\n\t\t\tconst promises = pages.map((page, i) => {\n\t\t\t\tconst loadedKeys = page.filter(v => v != null);\n\t\t\t\tif (loadedKeys.length === page.length) {\n\t\t\t\t\treturn; // page is already loaded\n\t\t\t\t}\n\n\t\t\t\tconst completeFilter = loadedKeys.length\n\t\t\t\t\t? {...filter, key: {notin: loadedKeys}}\n\t\t\t\t\t: filter;\n\n\t\t\t\treturn dispatch(\n\t\t\t\t\tloadIndexedPage(\n\t\t\t\t\t\tdataType,\n\t\t\t\t\t\tcompleteFilter,\n\t\t\t\t\t\torder,\n\t\t\t\t\t\tstart + i * PAGE_SIZE,\n\t\t\t\t\t\tchangedOn,\n\t\t\t\t\t\tactionTypes,\n\t\t\t\t\t\tcategoryPath\n\t\t\t\t\t)\n\t\t\t\t).catch(err => {\n\t\t\t\t\tif (err.message === 'Index outdated') {\n\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\trefreshIndex(\n\t\t\t\t\t\t\t\tgetSubstate,\n\t\t\t\t\t\t\t\tdataType,\n\t\t\t\t\t\t\t\tfilter,\n\t\t\t\t\t\t\t\torder,\n\t\t\t\t\t\t\t\tactionTypes,\n\t\t\t\t\t\t\t\tcategoryPath\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn Promise.all(promises);\n\t\t} else {\n\t\t\t// we don't have index, we need to load everything\n\n\t\t\treturn dispatch(\n\t\t\t\tloadIndexedPage(\n\t\t\t\t\tdataType,\n\t\t\t\t\tfilter,\n\t\t\t\t\torder,\n\t\t\t\t\tstart,\n\t\t\t\t\tchangedOn,\n\t\t\t\t\tactionTypes,\n\t\t\t\t\tcategoryPath\n\t\t\t\t)\n\t\t\t)\n\t\t\t\t.then(response => {\n\t\t\t\t\t// check success to make sure it's our error from BE and not anything broken in render chain\n\t\t\t\t\tif (response && response.message && response.success === false) {\n\t\t\t\t\t\t// do nothing\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// remaining pages\n\t\t\t\t\t\tif (length > PAGE_SIZE) {\n\t\t\t\t\t\t\treturn dispatch(\n\t\t\t\t\t\t\t\tensureIndexed(\n\t\t\t\t\t\t\t\t\tgetSubstate,\n\t\t\t\t\t\t\t\t\tdataType,\n\t\t\t\t\t\t\t\t\tfilter,\n\t\t\t\t\t\t\t\t\torder,\n\t\t\t\t\t\t\t\t\tstart + PAGE_SIZE,\n\t\t\t\t\t\t\t\t\tlength - PAGE_SIZE,\n\t\t\t\t\t\t\t\t\tactionTypes,\n\t\t\t\t\t\t\t\t\tcategoryPath\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} // else already done\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tif (err.message === 'Index outdated') {\n\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\trefreshIndex(\n\t\t\t\t\t\t\t\tgetSubstate,\n\t\t\t\t\t\t\t\tdataType,\n\t\t\t\t\t\t\t\tfilter,\n\t\t\t\t\t\t\t\torder,\n\t\t\t\t\t\t\t\tactionTypes,\n\t\t\t\t\t\t\t\tcategoryPath\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(`_common/actions#ensure: ${err}`);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t};\n}\n\nfunction loadKeysPage(\n\tdataType,\n\tactionTypes,\n\tkeys,\n\tcategoryPath = DEFAULT_CATEGORY_PATH\n) {\n\treturn (dispatch, getState) => {\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(getState());\n\t\tconst apiPath = getAPIPath(categoryPath, dataType);\n\n\t\tlet payload = {\n\t\t\tfilter: {\n\t\t\t\tkey: {\n\t\t\t\t\tin: keys,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\treturn request(localConfig, apiPath, 'POST', null, payload)\n\t\t\t.then(result => {\n\t\t\t\tif (\n\t\t\t\t\t(result.errors && result.errors[dataType]) ||\n\t\t\t\t\t(result.data && !result.data[dataType])\n\t\t\t\t) {\n\t\t\t\t\tthrow new Error(result.errors[dataType] || 'no data');\n\t\t\t\t} else {\n\t\t\t\t\tdispatch(receiveKeys(actionTypes, result, dataType, keys));\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tdispatch(actionGeneralError(error));\n\t\t\t\treturn error;\n\t\t\t});\n\t};\n}\n\nfunction loadIndexedPage(\n\tdataType,\n\tfilter,\n\torder,\n\tstart,\n\tchangedOn,\n\tactionTypes,\n\tcategoryPath = DEFAULT_CATEGORY_PATH\n) {\n\treturn (dispatch, getState) => {\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(getState());\n\t\tconst PAGE_SIZE =\n\t\t\tlocalConfig.requestPageSize || configDefaults.requestPageSize;\n\t\tconst apiPath = getAPIPath(categoryPath, dataType);\n\n\t\tlet payload = {\n\t\t\tfilter: filter && {...filter},\n\t\t\toffset: start - 1,\n\t\t\torder: order,\n\t\t\tlimit: PAGE_SIZE,\n\t\t};\n\t\treturn request(localConfig, apiPath, 'POST', null, payload)\n\t\t\t.then(result => {\n\t\t\t\tif (\n\t\t\t\t\t(result.errors && result.errors[dataType]) ||\n\t\t\t\t\t(result.data && !result.data[dataType])\n\t\t\t\t) {\n\t\t\t\t\tthrow new Error(result.errors[dataType] || 'no data');\n\t\t\t\t} else if (\n\t\t\t\t\tresult.changes &&\n\t\t\t\t\tresult.changes[dataType] &&\n\t\t\t\t\tmoment(result.changes[dataType]).isAfter(changedOn)\n\t\t\t\t) {\n\t\t\t\t\tthrow new Error('Index outdated');\n\t\t\t\t} else {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\treceiveIndexed(actionTypes, result, dataType, filter, order, start)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tdispatch(actionGeneralError(error));\n\t\t\t\treturn error; //todo do we need to return this\n\t\t\t});\n\t};\n}\n\nfunction receiveUpdated(\n\tgetSubstate,\n\tactionTypes,\n\tresult,\n\tdataType,\n\tcategoryPath\n) {\n\treturn (dispatch, getState) => {\n\t\tlet data = result.data[dataType];\n\t\tif (data.length) {\n\t\t\tlet originalData = commonSelectors.getAllAsObject(getSubstate)(\n\t\t\t\tgetState()\n\t\t\t);\n\t\t\tdispatch(actionAdd(actionTypes, data));\n\t\t\tlet editedData = commonSelectors.getEditedAllAsObject(getSubstate)(\n\t\t\t\tgetState()\n\t\t\t);\n\n\t\t\tlet indexes = [];\n\t\t\tdata.forEach(model => {\n\t\t\t\tlet original = originalData?.[model.key];\n\t\t\t\tlet edited = editedData?.[model.key]?.data;\n\t\t\t\t_.forIn(edited, (value, key) => {\n\t\t\t\t\tif (model.data[key] === value) {\n\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\tactionRemovePropertyFromEdited(actionTypes, model.key, key)\n\t\t\t\t\t\t);\n\t\t\t\t\t} else if (_.isObject(value)) {\n\t\t\t\t\t\tif (JSON.stringify(value) === JSON.stringify(model.data[key])) {\n\t\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\t\tactionRemovePropertyFromEdited(actionTypes, model.key, key)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else if (_.isArray(value) && _.isEmpty(value)) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t_.isEmpty(model.data[key]) ||\n\t\t\t\t\t\t\t\t(model.data && !model.data[key])\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\t\t\tactionRemovePropertyFromEdited(actionTypes, model.key, key)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t//Find corresponding indexes for new model\n\t\t\t\tindexes = indexes.concat(\n\t\t\t\t\tcommonSelectors.getIndexesByFilteredItem(getSubstate)(\n\t\t\t\t\t\tgetState() || [],\n\t\t\t\t\t\tmodel\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t\t//Find corresponding indexes for original model\n\t\t\t\tindexes = indexes.concat(\n\t\t\t\t\tcommonSelectors.getIndexesByFilteredItem(getSubstate)(\n\t\t\t\t\t\tgetState() || [],\n\t\t\t\t\t\toriginal\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t});\n\n\t\t\tlet uniqueIndexes = commonHelpers.getUniqueIndexes(indexes);\n\t\t\tif (!_.isEmpty(uniqueIndexes)) {\n\t\t\t\tuniqueIndexes.forEach(index => {\n\t\t\t\t\tif (index) {\n\t\t\t\t\t\t//invalidate data\n\t\t\t\t\t\tdispatch(actionClearIndex(actionTypes, index.filter, index.order));\n\t\t\t\t\t\t//refresh data\n\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\trefreshIndex(\n\t\t\t\t\t\t\t\tgetSubstate,\n\t\t\t\t\t\t\t\tdataType,\n\t\t\t\t\t\t\t\tindex.filter,\n\t\t\t\t\t\t\t\tindex.order,\n\t\t\t\t\t\t\t\tactionTypes,\n\t\t\t\t\t\t\t\tcategoryPath\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(`No data updated for ${dataType} metadata type`);\n\t\t}\n\t};\n}\n\nfunction receiveKeys(actionTypes, result, dataType, keys) {\n\treturn dispatch => {\n\t\t// add data to store\n\t\tif (result.data[dataType].length) {\n\t\t\tdispatch(actionAdd(actionTypes, result.data[dataType]));\n\t\t}\n\n\t\t// add unreceived keys\n\t\t_.remove(keys, key => {\n\t\t\treturn _.find(result.data[dataType], {key});\n\t\t});\n\t\tif (keys.length) {\n\t\t\tdispatch(actionAddUnreceivedKeys(actionTypes, keys));\n\t\t}\n\t};\n}\n\nfunction refreshUses(\n\tgetSubstate,\n\tdataType,\n\tactionTypes,\n\tcategoryPath = DEFAULT_CATEGORY_PATH\n) {\n\treturn () => {\n\t\treturn (dispatch, getState) => {\n\t\t\tdispatch(actionClearIndexes(actionTypes));\n\n\t\t\tlet state = getState();\n\n\t\t\tlet usedKeys = commonSelectors.getKeysInUse(getSubstate)(state);\n\t\t\tdispatch(\n\t\t\t\tensureKeys(getSubstate, dataType, actionTypes, usedKeys, categoryPath)\n\t\t\t);\n\n\t\t\tlet usedIndexPages = commonSelectors.getUsedIndexPages(getSubstate)(\n\t\t\t\tstate\n\t\t\t);\n\n\t\t\tconst promises = _.flatMap(usedIndexPages, usedIndexPage => {\n\t\t\t\t_.map(usedIndexPage.uses, use => {\n\t\t\t\t\treturn dispatch(\n\t\t\t\t\t\tensureIndexed(\n\t\t\t\t\t\t\tgetSubstate,\n\t\t\t\t\t\t\tdataType,\n\t\t\t\t\t\t\tusedIndexPage.filter,\n\t\t\t\t\t\t\tusedIndexPage.order,\n\t\t\t\t\t\t\tuse.start,\n\t\t\t\t\t\t\tuse.length,\n\t\t\t\t\t\t\tactionTypes,\n\t\t\t\t\t\t\tcategoryPath\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn Promise.all(promises);\n\t\t};\n\t};\n}\n\nfunction ensureIndexesWithFilterByActive(\n\tgetSubstate,\n\tdataType,\n\tactionTypes,\n\tcategoryPath = DEFAULT_CATEGORY_PATH\n) {\n\treturn filterByActive => {\n\t\treturn (dispatch, getState) => {\n\t\t\tconst state = getState();\n\t\t\tconst usedIndexes = commonSelectors.getUsesWithActiveDependency(\n\t\t\t\tgetSubstate\n\t\t\t)(state, filterByActive);\n\n\t\t\tconst promises = _.flatMap(usedIndexes, usedIndex => {\n\t\t\t\t_.map(usedIndex.uses, use => {\n\t\t\t\t\treturn dispatch(\n\t\t\t\t\t\tensureIndexed(\n\t\t\t\t\t\t\tgetSubstate,\n\t\t\t\t\t\t\tdataType,\n\t\t\t\t\t\t\tusedIndex.filter,\n\t\t\t\t\t\t\tusedIndex.order,\n\t\t\t\t\t\t\tuse.start,\n\t\t\t\t\t\t\tuse.length,\n\t\t\t\t\t\t\tactionTypes,\n\t\t\t\t\t\t\tcategoryPath\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn Promise.all(promises);\n\t\t};\n\t};\n}\n\nfunction updateSubstateFromView(actionTypes) {\n\treturn data => {\n\t\treturn dispatch => {\n\t\t\tif (data && data.activeKey) {\n\t\t\t\tdispatch(actionSetActiveKey(actionTypes, data.activeKey));\n\t\t\t} else if (data && data.activeKeys) {\n\t\t\t\tdispatch(actionSetActiveKeys(actionTypes, data.activeKeys));\n\t\t\t}\n\t\t};\n\t};\n}\n\n// ============ common namespace actions ===========\n\nfunction actionDataSetOutdated() {\n\treturn {\n\t\ttype: ActionTypes.COMMON.DATA.SET_OUTDATED,\n\t};\n}\n\nfunction actionRemovePropertyValuesFromAllEdited(dataType, keys) {\n\treturn {\n\t\ttype: ActionTypes.COMMON.EDITED.REMOVE_PROPERTY_VALUES,\n\t\tdataType,\n\t\tkeys,\n\t};\n}\n\nfunction actionGeneralError(e) {\n\tconsole.error('common/actions error', e);\n\treturn {type: 'ERROR'};\n}\n\n// ============ specific store namespace actions ===========\n\nconst creator = action => {\n\treturn actionTypes => {\n\t\treturn (...args) => {\n\t\t\treturn dispatch => {\n\t\t\t\tdispatch(action(actionTypes, ...args));\n\t\t\t};\n\t\t};\n\t};\n};\n\nfunction action(actionTypes, type, payload) {\n\ttype = type.split('.');\n\t_.each(type, pathSegment => {\n\t\tif (!actionTypes.hasOwnProperty(pathSegment)) {\n\t\t\tconsole.error(\n\t\t\t\t'common/actions#action: Action not in namespace',\n\t\t\t\ttype,\n\t\t\t\tpayload\n\t\t\t);\n\t\t\tthrow new Error('common/actions#action: Action not in namespace');\n\t\t}\n\t\tactionTypes = actionTypes[pathSegment];\n\t});\n\tif (typeof actionTypes !== 'string')\n\t\tthrow new Error('common/actions#action: Action type not string');\n\treturn {...payload, type: actionTypes};\n}\n\nfunction actionAdd(actionTypes, data, filter) {\n\tif (!_.isArray(data)) data = [data];\n\treturn action(actionTypes, 'ADD', {data, filter});\n}\n\nfunction actionAddUnreceivedKeys(actionTypes, keys) {\n\tif (!_.isArray(keys)) keys = [keys];\n\treturn action(actionTypes, 'ADD_UNRECEIVED', {keys});\n}\n\nfunction actionAddIndex(\n\tactionTypes,\n\tfilter,\n\torder,\n\tcount,\n\tstart,\n\tdata,\n\tchangedOn,\n\tlimit //optional\n) {\n\treturn action(actionTypes, 'INDEX.ADD', {\n\t\tfilter,\n\t\torder,\n\t\tcount,\n\t\tstart,\n\t\tdata,\n\t\tchangedOn,\n\t\t...(limit && {limit: limit}),\n\t});\n}\n/**\n * Useful for invalidate data before refresh indexes\n */\nfunction actionClearIndex(actionTypes, filter, order) {\n\treturn action(actionTypes, 'INDEX.CLEAR_INDEX', {filter, order});\n}\n\nconst actionMarkAsDeleted = (actionTypes, key, date) => {\n\treturn action(actionTypes, 'MARK_DELETED', {key, date});\n};\n\nfunction actionClearIndexes(actionTypes) {\n\treturn action(actionTypes, 'INDEX.CLEAR_ALL');\n}\n\nfunction actionDelete(actionTypes, keys) {\n\treturn action(actionTypes, 'DELETE', {keys});\n}\n\nfunction actionSetActiveKey(actionTypes, key) {\n\treturn action(actionTypes, 'SET_ACTIVE_KEY', {key});\n}\n\nfunction actionSetActiveKeys(actionTypes, keys) {\n\treturn action(actionTypes, 'SET_ACTIVE_KEYS', {keys});\n}\n\nfunction actionRemoveEdited(actionTypes, keys) {\n\treturn action(actionTypes, 'EDITED.REMOVE', {keys});\n}\n\nfunction actionUpdateEdited(actionTypes, data) {\n\treturn action(actionTypes, 'EDITED.UPDATE', {data});\n}\n\nfunction actionRemovePropertyFromEdited(actionTypes, key, property) {\n\treturn action(actionTypes, 'EDITED.REMOVE_PROPERTY', {key, property});\n}\n\nfunction actionUseIndexedRegister(\n\tactionTypes,\n\tcomponentId,\n\tfilterByActive,\n\tfilter,\n\torder,\n\tstart,\n\tlength\n) {\n\treturn action(actionTypes, 'USE.INDEXED.REGISTER', {\n\t\tcomponentId,\n\t\tfilterByActive,\n\t\tfilter,\n\t\torder,\n\t\tstart,\n\t\tlength,\n\t});\n}\n\nfunction actionUseIndexedClear(actionTypes, componentId) {\n\treturn action(actionTypes, 'USE.INDEXED.CLEAR', {componentId});\n}\n\nfunction actionUseIndexedClearAll(actionTypes) {\n\treturn action(actionTypes, 'USE.INDEXED.CLEAR_ALL');\n}\n\nfunction actionUpdateStore(actionTypes, data) {\n\treturn action(actionTypes, 'UPDATE_STORE', data);\n}\n\nfunction actionUseKeysClear(actionTypes, componentId) {\n\treturn action(actionTypes, 'USE.KEYS.CLEAR', {componentId});\n}\n\nfunction actionUseKeysRegister(actionTypes, componentId, keys) {\n\treturn action(actionTypes, 'USE.KEYS.REGISTER', {componentId, keys});\n}\n\n// ============ utilities ===========\nconst getAPIPath = (categoryPath = DEFAULT_CATEGORY_PATH, dataType) => {\n\treturn path.join('rest', categoryPath, 'filtered', dataType);\n};\n\nconst getCreatePayload = (datatype, key = utils.uuid(), applicationKey) => {\n\tconst payload = {\n\t\tdata: {},\n\t};\n\n\tlet model = {key, data: {}};\n\tif (applicationKey) {\n\t\tmodel.data = {applicationKey};\n\t}\n\n\tpayload.data[datatype] = [model];\n\n\treturn payload;\n};\n\n// ============ export ===========\n\nexport default {\n\tadd: creator(actionAdd),\n\taction,\n\taddIndex: creator(actionAddIndex),\n\tactionGeneralError,\n\tapiUpdate,\n\tcreator,\n\tcreate,\n\tdelete: deleteItem,\n\tensure: ensureKeys,\n\tensureIndexed,\n\tensureIndexesWithFilterByActive,\n\tensureKeys,\n\tloadIndexedPage,\n\tloadKeysPage,\n\tsetActiveKey: creator(actionSetActiveKey),\n\tsetActiveKeys: creator(actionSetActiveKeys),\n\treceiveUpdated,\n\treceiveIndexed,\n\treceiveKeys,\n\trefreshUses,\n\tremovePropertyFromEdited,\n\trequest: requestWrapper,\n\tsaveEdited,\n\tupdateSubstateFromView,\n\tupdateEdited,\n\tupdateStore,\n\tuseKeys,\n\tuseKeysClear: creator(actionUseKeysClear),\n\tuseIndexed,\n\tclearIndex: creator(actionClearIndex),\n\n\tuseIndexedRegister: actionUseIndexedRegister,\n\tuseIndexedClear: creator(actionUseIndexedClear),\n\tuseIndexedClearAll: creator(actionUseIndexedClearAll),\n\tactionDataSetOutdated,\n\tactionSetActiveKey,\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport request from '../_common/request';\nimport selectors from './selectors';\nimport commonActions from '../_common/actions';\nimport Select from '../Select';\n\n// ============ creators ===========\n\nconst loadConfiguration = () => {\n\treturn (dispatch, getState) => {\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(getState());\n\t\tconst apiPath = 'rest/application/filtered/configurations';\n\t\tlet applicationKey = selectors.getKey(getState());\n\t\tconst payload = {\n\t\t\tfilter: {\n\t\t\t\tapplicationKey,\n\t\t\t},\n\t\t};\n\t\treturn request(localConfig, apiPath, 'POST', null, payload)\n\t\t\t.then(result => {\n\t\t\t\tif (\n\t\t\t\t\t(result.errors && result.errors.configurations) ||\n\t\t\t\t\t(result.data && !result.data.configurations)\n\t\t\t\t) {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tcommonActions.actionGeneralError(\n\t\t\t\t\t\t\tresult.errors.configurations || new Error('no data')\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t} else if (\n\t\t\t\t\tresult.data.configurations.length &&\n\t\t\t\t\tresult.data.configurations[0].data &&\n\t\t\t\t\tresult.data.configurations[0].data.data\n\t\t\t\t) {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tactionReceiveConfiguration(result.data.configurations[0].data.data)\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tcommonActions.actionGeneralError(new Error('empty configuration'))\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tdispatch(commonActions.actionGeneralError(error));\n\t\t\t});\n\t};\n};\n\n// ============ actions ===========\nconst actionSetKey = key => {\n\treturn {\n\t\ttype: ActionTypes.APP.SET_KEY,\n\t\tkey,\n\t};\n};\nconst actionSetBaseUrl = url => {\n\treturn {\n\t\ttype: ActionTypes.APP.SET_BASE_URL,\n\t\turl,\n\t};\n};\nconst actionSetLocalConfiguration = (path, value) => {\n\treturn {\n\t\ttype: ActionTypes.APP.SET_LOCAL_CONFIGURATION,\n\t\tpath,\n\t\tvalue,\n\t};\n};\nconst actionUpdateLocalConfiguration = update => {\n\treturn {\n\t\ttype: ActionTypes.APP.UPDATE_LOCAL_CONFIGURATION,\n\t\tupdate,\n\t};\n};\nconst actionReceiveConfiguration = configuration => {\n\treturn {\n\t\ttype: ActionTypes.APP.RECEIVE_CONFIGURATION,\n\t\tconfiguration,\n\t};\n};\n\n// ============ export ===========\n\nexport default {\n\tadd: actionReceiveConfiguration,\n\tsetKey: actionSetKey,\n\tupdateLocalConfiguration: actionUpdateLocalConfiguration,\n\tsetBaseUrl: actionSetBaseUrl,\n\tsetLocalConfiguration: actionSetLocalConfiguration,\n\tloadConfiguration,\n};\n","import ActionTypes from '../../../constants/ActionTypes';\n\nimport common from '../../_common/actions';\nimport Select from '../../Select';\n\n// ============ creators ===========\n\nconst setActiveKey = common.setActiveKey(ActionTypes.AREAS.AREA_TREE_LEVELS);\nconst useIndexed = common.useIndexed(\n\tSelect.areas.areaTreeLevels.getSubstate,\n\t'areaTreeLevels',\n\tActionTypes.AREAS.AREA_TREE_LEVELS\n);\nconst useKeys = common.useKeys(\n\tSelect.areas.areaTreeLevels.getSubstate,\n\t'areaTreeLevels',\n\tActionTypes.AREAS.AREA_TREE_LEVELS\n);\nconst refreshUses = common.refreshUses(\n\tSelect.areas.areaTreeLevels.getSubstate,\n\t`areaTreeLevels`,\n\tActionTypes.AREAS.AREA_TREE_LEVELS\n);\n\nconst setActiveKeyAndEnsureDependencies = key => {\n\treturn (dispatch, getState, options) => {\n\t\tdispatch(setActiveKey(key));\n\t\tdispatch(options.ensureDependenciesOfActiveMetadataType('areaTreeLevel'));\n\t};\n};\n\n// ============ actions ===========\n\nfunction actionClearUseIndexed(componentId) {\n\treturn {\n\t\ttype: ActionTypes.AREAS.AREA_TREE_LEVELS.USE.INDEXED.CLEAR,\n\t\tcomponentId,\n\t};\n}\n\n// ============ export ===========\n\nexport default {\n\trefreshUses,\n\tsetActiveKey: setActiveKeyAndEnsureDependencies,\n\tuseIndexed,\n\tuseIndexedClear: actionClearUseIndexed,\n\tuseKeys,\n};\n","import ActionTypes from '../../../constants/ActionTypes';\n\nimport common from '../../_common/actions';\nimport Select from '../../Select';\n\n// ============ creators ===========\n\nconst setActiveKey = common.setActiveKey(ActionTypes.AREAS.AREA_TREES);\nconst useIndexed = common.useIndexed(\n\tSelect.areas.areaTrees.getSubstate,\n\t'areaTrees',\n\tActionTypes.AREAS.AREA_TREES\n);\nconst useKeys = common.useKeys(\n\tSelect.areas.areaTrees.getSubstate,\n\t'areaTrees',\n\tActionTypes.AREAS.AREA_TREES\n);\nconst refreshUses = common.refreshUses(\n\tSelect.areas.areaTrees.getSubstate,\n\t`areaTrees`,\n\tActionTypes.AREAS.AREA_TREES\n);\n\n// ============ actions ===========\n\nfunction actionClearUseIndexed(componentId) {\n\treturn {\n\t\ttype: ActionTypes.AREAS.AREA_TREES.USE.INDEXED.CLEAR,\n\t\tcomponentId,\n\t};\n}\n\n// ============ export ===========\n\nexport default {\n\trefreshUses,\n\tsetActiveKey,\n\tuseIndexed,\n\tuseIndexedClear: actionClearUseIndexed,\n\tuseKeys,\n\tuseKeysClear: common.useKeysClear(ActionTypes.AREAS.AREA_TREES),\n};\n","import areaTreeLevels from './AreaTreeLevels/actions';\nimport areaTrees from './AreaTrees/actions';\n\nexport default {\n\tareaTreeLevels,\n\tareaTrees,\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport Select from '../Select';\nimport common from '../_common/actions';\n\n// ============ creators ===========\nconst useIndexedRegister = (\n\tcomponentId,\n\tfilterByActive,\n\tfilter,\n\torder,\n\tstart,\n\tlength\n) =>\n\tcommon.useIndexedRegister(\n\t\tActionTypes.AREA_RELATIONS,\n\t\tcomponentId,\n\t\tfilterByActive,\n\t\tfilter,\n\t\torder,\n\t\tstart,\n\t\tlength\n\t);\nconst ensureIndexed = (filter, order, start, length) =>\n\tcommon.ensureIndexed(\n\t\tSelect.areaRelations.getSubstate,\n\t\t'area',\n\t\tfilter,\n\t\torder,\n\t\tstart,\n\t\tlength,\n\t\tActionTypes.AREA_RELATIONS,\n\t\t'relations'\n\t);\nconst add = common.add(ActionTypes.AREA_RELATIONS);\nconst useIndexedClearAll = common.useIndexedClearAll(\n\tActionTypes.AREA_RELATIONS\n);\n\n// ============ export ===========\n\nexport default {\n\tadd,\n\tuseIndexedRegister,\n\tuseIndexedClearAll,\n\tensureIndexed,\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common from '../_common/actions';\nimport Select from '../Select';\n\n// ============ creators ===========\nconst create = common.create(\n\tSelect.attributes.getSubstate,\n\t'attributes',\n\tActionTypes.ATTRIBUTES\n);\nconst refreshUses = common.refreshUses(\n\tSelect.attributes.getSubstate,\n\t`attributes`,\n\tActionTypes.ATTRIBUTES\n);\nconst deleteItem = common.delete(\n\tSelect.attributes.getSubstate,\n\t'attributes',\n\tActionTypes.ATTRIBUTES\n);\nconst saveEdited = common.saveEdited(\n\tSelect.attributes.getSubstate,\n\t'attributes',\n\tActionTypes.ATTRIBUTES\n);\nconst setActiveKey = common.setActiveKey(ActionTypes.ATTRIBUTES);\nconst setActiveKeys = common.setActiveKeys(ActionTypes.ATTRIBUTES);\nconst updateEdited = common.updateEdited(\n\tSelect.attributes.getSubstate,\n\tActionTypes.ATTRIBUTES\n);\nconst updateStore = common.updateStore(\n\tSelect.attributes.getSubstate,\n\tActionTypes.ATTRIBUTES\n);\nconst useIndexed = common.useIndexed(\n\tSelect.attributes.getSubstate,\n\t'attributes',\n\tActionTypes.ATTRIBUTES\n);\nconst useIndexedClear = common.useIndexedClear(ActionTypes.ATTRIBUTES);\nconst useKeys = common.useKeys(\n\tSelect.attributes.getSubstate,\n\t'attributes',\n\tActionTypes.ATTRIBUTES\n);\nconst useKeysClear = common.useKeysClear(ActionTypes.ATTRIBUTES);\nconst updateStateFromView = common.updateSubstateFromView(\n\tActionTypes.ATTRIBUTES\n);\n\nconst setActiveKeyAndEnsureDependencies = key => {\n\treturn (dispatch, getState, options) => {\n\t\tdispatch(setActiveKey(key));\n\t\tdispatch(options.ensureDependenciesOfActiveMetadataType('attribute'));\n\t};\n};\n\nconst setActiveKeysAndEnsureDependencies = keys => {\n\treturn (dispatch, getState, options) => {\n\t\tdispatch(setActiveKeys(keys));\n\t\tdispatch(options.ensureDependenciesOfActiveMetadataType('attribute'));\n\t};\n};\n\n// ============ export ===========\n\nexport default {\n\tcreate,\n\tdelete: deleteItem,\n\tupdateStateFromView,\n\n\trefreshUses,\n\n\tsaveEdited,\n\tsetActiveKey: setActiveKeyAndEnsureDependencies,\n\tsetActiveKeys: setActiveKeysAndEnsureDependencies,\n\n\tupdateEdited,\n\tupdateStore,\n\tuseIndexed,\n\tuseIndexedClear,\n\tuseKeys,\n\tuseKeysClear,\n};\n","import ActionTypes from '../../constants/ActionTypes';\n\nimport common from '../_common/actions';\n\n// ============ creators ===========\n\nconst setActiveKeys = common.setActiveKeys(ActionTypes.ATTRIBUTE_SETS);\n\n// ============ export ===========\n\nexport default {\n\tsetActiveKeys,\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common from '../_common/actions';\nimport Select from '../Select';\n\n// ============ creators ===========\n\nconst add = common.add(ActionTypes.CASES);\nconst create = common.create(\n\tSelect.cases.getSubstate,\n\t'cases',\n\tActionTypes.CASES\n);\nconst deleteItem = common.delete(\n\tSelect.cases.getSubstate,\n\t'cases',\n\tActionTypes.CASES\n);\nconst saveEdited = common.saveEdited(\n\tSelect.cases.getSubstate,\n\t'cases',\n\tActionTypes.CASES\n);\nconst setActiveKey = common.setActiveKey(ActionTypes.CASES);\nconst setActiveKeys = common.setActiveKeys(ActionTypes.CASES);\nconst updateEdited = common.updateEdited(\n\tSelect.cases.getSubstate,\n\tActionTypes.CASES\n);\nconst updateStateFromView = common.updateSubstateFromView(ActionTypes.CASES);\nconst useKeys = common.useKeys(\n\tSelect.cases.getSubstate,\n\t'cases',\n\tActionTypes.CASES\n);\nconst useKeysClear = common.useKeysClear(ActionTypes.CASES);\nconst useIndexed = common.useIndexed(\n\tSelect.cases.getSubstate,\n\t'cases',\n\tActionTypes.CASES\n);\nconst useIndexedClear = common.useIndexedClear(ActionTypes.CASES);\nconst refreshUses = common.refreshUses(\n\tSelect.cases.getSubstate,\n\t`cases`,\n\tActionTypes.CASES\n);\n\nconst setActiveKeyAndEnsureDependencies = key => {\n\treturn (dispatch, getState, options) => {\n\t\tdispatch(setActiveKey(key));\n\t\tdispatch(options.ensureDependenciesOfActiveMetadataType('case'));\n\t};\n};\n\nconst setActiveKeysAndEnsureDependencies = keys => {\n\treturn (dispatch, getState, options) => {\n\t\tdispatch(setActiveKeys(keys));\n\t\tdispatch(options.ensureDependenciesOfActiveMetadataType('case'));\n\t};\n};\n\n// ============ actions ===========\n\n// ============ export ===========\n\nexport default {\n\tadd,\n\tcreate,\n\tdelete: deleteItem,\n\n\trefreshUses,\n\n\tsaveEdited,\n\tsetActiveKey: setActiveKeyAndEnsureDependencies,\n\tsetActiveKeys: setActiveKeysAndEnsureDependencies,\n\n\tupdateEdited,\n\tupdateStateFromView,\n\tuseIndexed,\n\tuseIndexedClear,\n\tuseKeys,\n\tuseKeysClear,\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common from '../_common/actions';\nimport Select from '../Select';\n\nconst updateStore = common.updateStore(\n\tSelect.components.getSubstate,\n\tActionTypes.COMPONENTS\n);\n\n// ============ creators ===========\nfunction update(component, data) {\n\treturn dispatch => {\n\t\tdispatch(actionUpdate(component, data));\n\t};\n}\n\n// ============ actions ===========\nfunction actionUpdate(component, data) {\n\treturn {\n\t\ttype: ActionTypes.COMPONENTS.UPDATE,\n\t\tcomponent: component,\n\t\tupdate: data,\n\t};\n}\nfunction actionSet(component, path, value) {\n\treturn {\n\t\ttype: ActionTypes.COMPONENTS.SET,\n\t\tcomponent,\n\t\tpath,\n\t\tvalue,\n\t};\n}\n\n// ============ export ===========\n\nexport default {\n\tupdate,\n\tupdateStateFromView: updateStore,\n\tupdateStore,\n\tset: actionSet,\n};\n","import ActionTypes from '../../../constants/ActionTypes';\nimport common from '../../_common/actions';\n\nconst actionTypes = ActionTypes.DATA.ATTRIBUTE_RELATIONS;\n\nconst add = common.add(actionTypes);\nconst addIndex = common.addIndex(actionTypes);\n// ============ creators ===========\n/**\n * It ensure adding index and adding or updating received data from BE.\n * Add relations to state only when attributeRelations received, in case of empty attributeRelations it adds only index.\n * @param {Array} attributeRelations Array received from BE contains attributeRelations.\n * @param {Object} filter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey and styleKey.\n * @param {Array?} order\n * @param {Number} start\n * @param {Number} total\n * @param {string?} changedOn\n */\nfunction receiveIndexed(\n\tattributeRelations,\n\tfilter,\n\torder,\n\tstart,\n\ttotal,\n\tchangedOn,\n\tlimit\n) {\n\treturn dispatch => {\n\t\t// add attributeRelations to store\n\t\tif (attributeRelations.length) {\n\t\t\tdispatch(add(attributeRelations, filter));\n\t\t}\n\n\t\t// add to index\n\t\tdispatch(\n\t\t\taddIndex(\n\t\t\t\tfilter,\n\t\t\t\torder,\n\t\t\t\ttotal,\n\t\t\t\tstart,\n\t\t\t\tattributeRelations,\n\t\t\t\tchangedOn,\n\t\t\t\tlimit\n\t\t\t)\n\t\t);\n\t};\n}\n\n/**\n * Create new index with loading indicator based on pagination.\n * @param {Object} pagination\n * @param {Object} filter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey and styleKey.\n * @param {Array?} order\n */\nfunction addLoadingIndex(pagination, filter, order) {\n\tconst changedOn = null;\n\n\t// Fake new data object for common action of size same like pagination.limit\n\t// Action \"common.addIndex\" needs array of data objects with key to create new index.\n\t// \"data\" is a Array of the minimal data for construct index in common actoin.\n\t// Use key = true as a loading identificator\n\tconst data = new Array(pagination.limit).fill({key: true});\n\n\t// filter, order, data, start, count, changedOn\n\treturn actionAddIndex(\n\t\tfilter,\n\t\torder,\n\t\tdata,\n\t\tpagination.offset + 1,\n\t\tnull,\n\t\tchangedOn\n\t);\n}\n\n// ============ actions ============\nconst actionUpdateStore = data => {\n\treturn {\n\t\ttype: ActionTypes.DATA.ATTRIBUTE_RELATIONS.UPDATE_STORE,\n\t\tdata,\n\t};\n};\n\nfunction actionAddIndex(filter, order, data, start, count, changedOn) {\n\treturn {\n\t\ttype: actionTypes.INDEX.ADD,\n\t\tfilter,\n\t\torder,\n\t\tdata: data,\n\t\tstart,\n\t\tcount,\n\t\tchangedOn,\n\t};\n}\n// ============ export ===========\n\nexport default {\n\treceiveIndexed,\n\taddLoadingIndex,\n\tupdateStore: actionUpdateStore,\n};\n","import ActionTypes from '../../../constants/ActionTypes';\nimport common from '../../_common/actions';\n\nconst actionTypes = ActionTypes.DATA.ATTRIBUTE_DATA_SOURCES;\n\nconst addIndex = common.addIndex(actionTypes);\nconst add = common.add(actionTypes);\n\n// ============ creators ===========\n/**\n * It ensure adding index and adding or updating received data from BE.\n * Add dataSources to state only when attributeDataSources received, in case of empty attributeDataSources it adds only index.\n * @param {Array} attributeDataSources Array received from BE contains attributeDataSource definitions.\n * @param {Object} filter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey and styleKey.\n * @param {Array?} order\n * @param {Number} start\n * @param {Number} total\n * @param {string?} changedOn\n */\nfunction receiveIndexed(\n\tattributeDataSources,\n\tfilter,\n\torder,\n\tstart,\n\ttotal,\n\tchangedOn\n) {\n\treturn dispatch => {\n\t\t// add attributeDataSources to store\n\t\tif (attributeDataSources.length) {\n\t\t\tdispatch(add(attributeDataSources, filter));\n\t\t}\n\n\t\t// add to index\n\t\tdispatch(\n\t\t\taddIndex(filter, order, total, start, attributeDataSources, changedOn)\n\t\t);\n\t};\n}\n\n// ============ actions ============\nconst actionUpdateStore = data => {\n\treturn {\n\t\ttype: ActionTypes.DATA.ATTRIBUTE_DATA_SOURCES.UPDATE_STORE,\n\t\tdata,\n\t};\n};\n\n// ============ export ===========\n\nexport default {\n\tadd,\n\treceiveIndexed,\n\tupdateStore: actionUpdateStore,\n};\n","import ActionTypes from '../../../constants/ActionTypes';\nimport {tileAsString} from '../helpers';\nimport {isEmpty as _isEmpty, reduce as _reduce} from 'lodash';\n\nconst actionTypes = ActionTypes.DATA.ATTRIBUTE_DATA;\n\n// ============ creators ===========\n/**\n * It ensure adding index and adding or updating received attribute data from BE under given spatial index.\n * Add data to state only when attributeData received, in case of empty attributeData it adds only index.\n * @param {Object} attributeData Object received from BE contains under attributeDataKey object of data attributes [id]: [value].\n * @param {Object} spatialIndexData Spatial index related to the data.\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @param {Array?} order\n * @param {string?} changedOn\n */\nconst receiveIndexedWithSpatialIndex = (\n\tattributeData,\n\tspatialIndexData,\n\tattributeDataFilter,\n\torder,\n\tchangedOn\n) => {\n\treturn dispatch => {\n\t\tif (!_isEmpty(attributeData)) {\n\t\t\tdispatch(\n\t\t\t\taddDataAndIndexBasedOnSpatialData(\n\t\t\t\t\tattributeDataFilter,\n\t\t\t\t\torder,\n\t\t\t\t\tattributeData,\n\t\t\t\t\tspatialIndexData,\n\t\t\t\t\tchangedOn\n\t\t\t\t)\n\t\t\t);\n\t\t} else {\n\t\t\t// add to index\n\t\t\tdispatch(\n\t\t\t\tcreateAndAddIndexBasedOnSpatialData(\n\t\t\t\t\tattributeDataFilter,\n\t\t\t\t\torder,\n\t\t\t\t\tspatialIndexData,\n\t\t\t\t\tchangedOn\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t};\n};\n\n/**\n * Ensure adding index and adding or updating received attribute data from BE.\n * @param {Object} attributeData\n * @param {Array} attributeData.index\n * @param {Object} attributeData.attributeData\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @param {Array?} order\n * @param {Array?} start\n * @param {Array?} total\n * @param {string?} changedOn\n */\nconst receiveIndexed = (\n\tattributeData,\n\tattributeDataFilter,\n\torder,\n\tstart,\n\ttotal,\n\tchangedOn\n) => {\n\treturn actionAddDataAndIndex(\n\t\tattributeDataFilter,\n\t\torder,\n\t\ttotal,\n\t\tstart,\n\t\tattributeData.index,\n\t\tattributeData.attributeData,\n\t\tchangedOn\n\t);\n};\n\n/**\n * Add data and index at the same time\n *\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @param {Object} attributeData Object received from BE contains under attributeDataKey object of data attributes [id]: [value].\n * @param {Object} spatialIndexData Spatial index related to the data.\n * @param order {Array}\n * @param changedOn {string}\n */\nfunction addDataAndIndexBasedOnSpatialData(\n\tattributeDataFilter,\n\torder,\n\tattributeData,\n\tspatialIndexData,\n\tchangedOn\n) {\n\treturn dispatch => {\n\t\tfor (const attributeDataSourceKey of Object.keys(attributeData)) {\n\t\t\tdispatch(\n\t\t\t\tactionAddDataAndIndexBasedOnSpatialData(\n\t\t\t\t\tattributeDataSourceKey,\n\t\t\t\t\tattributeData[attributeDataSourceKey],\n\t\t\t\t\tattributeDataFilter,\n\t\t\t\t\torder,\n\t\t\t\t\t[spatialIndexData],\n\t\t\t\t\tchangedOn\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t};\n}\n\n/**\n * Create and add index for given attribute data based on related spatial data index.\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @param {Array?} order\n * @param {Object} spatialIndexData Spatial index related to the data.\n * @param {*} changedOn\n */\nfunction createAndAddIndexBasedOnSpatialData(\n\tattributeDataFilter,\n\torder,\n\tspatialIndexData,\n\tchangedOn\n) {\n\treturn actionAddIndexWithSpatialIndex(\n\t\tattributeDataFilter,\n\t\torder,\n\t\t[spatialIndexData],\n\t\tchangedOn\n\t);\n}\n\n/**\n * Create new index based on given level and tiles with loading indicator.\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @param {Array?} order\n * @param {Number} level\n * @param {Array.[Array]} tiles\n */\nfunction addLoadingSpatialIndex(attributeDataFilter, order, level, tiles) {\n\tconst changedOn = null;\n\n\t//create index with tiles value \"true\" that indicates loading state\n\tconst loadingTiles = _reduce(\n\t\ttiles,\n\t\t(acc, tile) => {\n\t\t\tconst tileId = tileAsString(tile);\n\t\t\tacc[tileId] = true;\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n\tconst index = {\n\t\t[level]: loadingTiles,\n\t};\n\n\treturn actionAddIndexWithSpatialIndex(\n\t\tattributeDataFilter,\n\t\torder,\n\t\t[index],\n\t\tchangedOn\n\t);\n}\n\n/**\n * Create new index based on pagination with loading indicator.\n * @param {Object} pagination\n * @param {Number} pagination.limit\n * @param {Number} pagination.offset\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @param {Array?} order\n */\nfunction addLoadingIndex(pagination, attributeDataFilter, order) {\n\tconst changedOn = null;\n\n\t// Fake new data object for common action of size same like pagination.limit\n\t// Action \"common.addIndex\" needs array of data objects with key to create new index.\n\t// \"data\" is a Array of the minimal data for construct index in common actoin.\n\t// Use key = true as a loading identificator\n\tconst data = new Array(pagination.limit).fill({key: true});\n\n\t// filter, order, data, start, count, changedOn\n\treturn actionAddIndex(\n\t\tattributeDataFilter,\n\t\torder,\n\t\tdata,\n\t\tpagination.offset + 1,\n\t\tnull,\n\t\tchangedOn\n\t);\n}\n\n// ============ helpers ============\n\n/**\n * Get data for indexing\n * @param {Object} spatialData\n * @param {Object} attributeData\n * @return {Object}\n */\nfunction getIndexDataBySpatialData(spatialData, attributeData) {\n\tconst indexByLevelByTileByDataSourceKey = {};\n\n\t//Attribute data indexes are stored in related spatial index\n\t//for all spatial data keys in spatialData\n\tfor (const [spatialDataSourceKey, datasource] of Object.entries(\n\t\tspatialData\n\t)) {\n\t\t//for all levels in spatial data source\n\t\tfor (const [level, tiles] of Object.entries(datasource.spatialIndex)) {\n\t\t\tif (!indexByLevelByTileByDataSourceKey[level]) {\n\t\t\t\tindexByLevelByTileByDataSourceKey[level] = {};\n\t\t\t}\n\t\t\t//for all tiles in tiles\n\t\t\tfor (const [tile, tileData] of Object.entries(tiles)) {\n\t\t\t\t// If empty attributeData, then rewrite \"loading\" state.\n\t\t\t\t// or\n\t\t\t\t// Prepare empty tile for new data if tile does not exists.\n\t\t\t\tif (\n\t\t\t\t\t!indexByLevelByTileByDataSourceKey[level][tileAsString(tile)] ||\n\t\t\t\t\t_isEmpty(attributeData)\n\t\t\t\t) {\n\t\t\t\t\tindexByLevelByTileByDataSourceKey[level][tileAsString(tile)] = {};\n\t\t\t\t}\n\n\t\t\t\tif (!_isEmpty(attributeData)) {\n\t\t\t\t\t//for all attribute data source keys in attributeData\n\t\t\t\t\tfor (const [\n\t\t\t\t\t\tattributeDataSourceKey,\n\t\t\t\t\t\tattributeDataSource,\n\t\t\t\t\t] of Object.entries(attributeData)) {\n\t\t\t\t\t\t// Save only tileData that are incuded in attribute data keys\n\n\t\t\t\t\t\tconst indexes = tileData.filter(e =>\n\t\t\t\t\t\t\tObject.keys(attributeDataSource).includes(e.toString())\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\t//Add to existing index\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tindexByLevelByTileByDataSourceKey?.[level]?.[\n\t\t\t\t\t\t\t\ttileAsString(tile)\n\t\t\t\t\t\t\t]?.[attributeDataSourceKey]\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tindexByLevelByTileByDataSourceKey[level][tileAsString(tile)][\n\t\t\t\t\t\t\t\tattributeDataSourceKey\n\t\t\t\t\t\t\t] = [\n\t\t\t\t\t\t\t\t...indexByLevelByTileByDataSourceKey[level][tileAsString(tile)][\n\t\t\t\t\t\t\t\t\tattributeDataSourceKey\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t...indexes,\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//Create new tile and insert dsKey index data\n\t\t\t\t\t\t\tindexByLevelByTileByDataSourceKey[level][tileAsString(tile)][\n\t\t\t\t\t\t\t\tattributeDataSourceKey\n\t\t\t\t\t\t\t] = indexes;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn indexByLevelByTileByDataSourceKey;\n}\n\n// ============ actions ============\nfunction actionRemoveSpatialIndex(filter, order) {\n\treturn {\n\t\ttype: actionTypes.SPATIAL_INDEX.REMOVE,\n\t\tfilter,\n\t\torder,\n\t};\n}\n\n/**\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @param {Array?} order\n * @param {Number} total\n * @param {Number} start\n * @param {Array} index\n * @param {Object} data\n * @param {string?} changedOn\n */\nfunction actionAddDataAndIndexBasedOnSpatialData(\n\tattributeDataSourceKey,\n\tdata,\n\tattributeDataFilter,\n\torder,\n\tindexData,\n\tchangedOn\n) {\n\treturn {\n\t\ttype: actionTypes.ADD_WITH_SPATIAL_INDEX,\n\t\tattributeDataSourceKey,\n\t\tdata,\n\t\tfilter: attributeDataFilter,\n\t\torder,\n\t\tindexData,\n\t\tchangedOn,\n\t};\n}\n\n/**\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @param {Array?} order\n * @param {Number} total\n * @param {Number} start\n * @param {Array} index\n * @param {Object} data\n * @param {string?} changedOn\n */\nfunction actionAddDataAndIndex(\n\tattributeDataFilter,\n\torder,\n\ttotal,\n\tstart,\n\tindex,\n\tdata,\n\tchangedOn\n) {\n\treturn {\n\t\ttype: actionTypes.ADD_WITH_INDEX,\n\t\tfilter: attributeDataFilter,\n\t\torder,\n\t\ttotal,\n\t\tstart,\n\t\tindex,\n\t\tdata,\n\t\tchangedOn,\n\t};\n}\n\nfunction actionAddIndexWithSpatialIndex(\n\tattributeDataFilter,\n\torder,\n\tindex,\n\tchangedOn\n) {\n\treturn {\n\t\ttype: actionTypes.SPATIAL_INDEX.ADD,\n\t\tfilter: attributeDataFilter,\n\t\torder,\n\t\tindexData: index,\n\t\tchangedOn,\n\t};\n}\n\n/**\n *\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @param {*} order\n * @param {*} data\n * @param {*} start\n * @param {*} count\n * @param {*} changedOn\n * @returns\n */\nfunction actionAddIndex(\n\tattributeDataFilter,\n\torder,\n\tdata,\n\tstart,\n\tcount,\n\tchangedOn\n) {\n\treturn {\n\t\ttype: actionTypes.INDEX.ADD,\n\t\tfilter: attributeDataFilter,\n\t\torder,\n\t\tdata: data,\n\t\tstart,\n\t\tcount,\n\t\tchangedOn,\n\t};\n}\n\nfunction actionUpdateStore(data) {\n\treturn {\n\t\ttype: actionTypes.UPDATE_STORE,\n\t\tdata,\n\t};\n}\n\n// ============ export ===========\n\nexport default {\n\taddLoadingIndex,\n\taddLoadingSpatialIndex,\n\tgetIndexDataBySpatialData,\n\treceiveIndexedWithSpatialIndex,\n\treceiveIndexed,\n\tremoveSpatialIndex: actionRemoveSpatialIndex,\n\tupdateStore: actionUpdateStore, //do we use it?\n};\n","import {isNumber as _isNumber, difference as _difference} from 'lodash';\n\n/**\n * Determinate pages for requested range of the data. Return array which always starts with 0 as a first page.\n * @param {Number} [count] Optional size of data on BE. Usually known after request on BE.\n * @param {Number} PAGE_SIZE Size of pagesize\n * @param {Number} [optStart]  Optional start, if not set, default value 1 is used.\n * @param {Number} [optLength] Optional length of requested data. If set, then last page will not overfloat requested data.\n * @return {Array.<Number>} Page indexes [0,1,2,3]\n */\nexport function getRestPages(count, PAGE_SIZE, optStart = 1, optLength) {\n\toptStart = _isNumber(optStart) ? optStart : 1;\n\n\tif (_isNumber(count) && (count === 0 || optStart > count)) {\n\t\treturn [];\n\t} else {\n\t\tlet wanted;\n\t\tif (_isNumber(count)) {\n\t\t\twanted = count - optStart + 1;\n\t\t\t// Request specific number of results\n\t\t\tif (_isNumber(optLength)) {\n\t\t\t\tif (optStart + optLength - 1 > count) {\n\t\t\t\t\twanted = count - optStart + 1;\n\t\t\t\t} else {\n\t\t\t\t\twanted = optLength;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Request specific number of results\n\t\t\tif (_isNumber(optLength)) {\n\t\t\t\twanted = optLength;\n\t\t\t} else {\n\t\t\t\twanted = PAGE_SIZE;\n\t\t\t}\n\t\t}\n\n\t\tconst startIndex = optStart; //1\n\t\tconst endIndex = optStart + wanted; //101\n\n\t\tconst lastPageIndex = Math.ceil((endIndex - startIndex) / PAGE_SIZE);\n\t\tconst pages = [...Array(lastPageIndex)].map((_, i) => {\n\t\t\treturn i;\n\t\t});\n\n\t\treturn pages;\n\t}\n}\n\n/**\n * Get pagination object {offset, limit}. Calculate necessary limit and offset from wanted range of the data.\n * If optLength or optCount passed, then returned pagination object will not overfloat limits.\n * @param {Number} pageIndex Page index based on count, PAGE_SIZE, start and length.\n * @param {Number} [optStart]  Optional start, if not set, default value 1 is used.\n * @param {Number} pageSize Size of pagesize\n * @param {Number} [optLength] Optional length of requested data. If set, then last page will not overfloat requested data.\n * @param {Number} [optCount] Optional size of data on BE. Usually known after request on BE.\n * @return {Object} {offset:Number, limit: Number}\n */\nexport function getPagination(\n\tpageIndex,\n\toptStart = 1,\n\tpageSize,\n\toptLength,\n\toptCount\n) {\n\toptStart = _isNumber(optStart) ? optStart : 1;\n\tlet limit = pageSize;\n\n\tif (_isNumber(optLength) && pageIndex * pageSize + pageSize > optLength) {\n\t\tlimit = Math.max(0, optLength - pageIndex * pageSize);\n\t}\n\n\tif (\n\t\t_isNumber(optCount) &&\n\t\toptStart + pageIndex * pageSize + limit - 1 > optCount\n\t) {\n\t\tlimit = Math.max(0, optCount - (optStart + pageIndex * pageSize - 1));\n\t}\n\n\treturn {\n\t\toffset: Math.max(0, optStart + pageIndex * pageSize - 1),\n\t\tlimit,\n\t};\n}\n\n/**\n * Get empty pagination\n * @return {Object} {offset:Number, limit: Number\n */\nexport function getNullishPagination() {\n\treturn getPagination(0, 1, 0, 0);\n}\n\n/**\n * Find loaded or loading pages\n * @param {Object} dataIndex Index with loaded or loading data\n * @param {Number} [optStart] Optional start, if not set, default value 1 is used.\n * @param {Number} pageSize Size of pagesize\n * @param {Array.<Number>} pages Which pages asking for\n * @param {Number} [optCount] Optional size of data on BE. Usually known after request on BE.\n * @param {Number} [optLength] Optional length of requested data. If set, then last page will not overfloat requested data.\n * @return {Array} Array of page indexex that are loaded of loading\n */\nexport function getLoadedPages(\n\tdataIndex = {},\n\toptStart = 1,\n\tpageSize,\n\tpages = [],\n\toptCount,\n\toptLength\n) {\n\toptStart = _isNumber(optStart) ? optStart : 1;\n\tconst loadedPages = [];\n\tpages.forEach(pageIndex => {\n\t\tlet itemsOnPage = 0;\n\n\t\tif (_isNumber(optCount)) {\n\t\t\tif (_isNumber(optLength) && pageSize * (pageIndex + 1) > optLength) {\n\t\t\t\titemsOnPage = optLength - pageSize * pageIndex;\n\n\t\t\t\tif (optStart + itemsOnPage > optCount) {\n\t\t\t\t\titemsOnPage =\n\t\t\t\t\t\toptCount - (optStart + pageSize * (pageIndex + 1) - pageSize) + 1;\n\t\t\t\t}\n\t\t\t} else if (optStart + pageSize * (pageIndex + 1) > optCount) {\n\t\t\t\titemsOnPage =\n\t\t\t\t\toptCount - (optStart + pageSize * (pageIndex + 1) - pageSize) + 1;\n\t\t\t} else {\n\t\t\t\titemsOnPage = pageSize;\n\t\t\t}\n\t\t} else {\n\t\t\tif (_isNumber(optLength) && pageSize * (pageIndex + 1) > optLength) {\n\t\t\t\titemsOnPage = optLength - pageSize * pageIndex;\n\t\t\t} else {\n\t\t\t\titemsOnPage = pageSize;\n\t\t\t}\n\t\t}\n\n\t\tconst requestedDataIndexes = [...Array(itemsOnPage)].map((_, i) => {\n\t\t\treturn optStart + pageSize * pageIndex + i;\n\t\t});\n\t\tconst hasPage = requestedDataIndexes.every(index =>\n\t\t\tdataIndex.hasOwnProperty(index)\n\t\t);\n\t\tif (hasPage) {\n\t\t\tloadedPages.push(pageIndex);\n\t\t}\n\t});\n\treturn loadedPages;\n}\n\n/**\n * Determinate requested pages and which pages are alredy loaded or loading. Return difference between requested an loaded pages.\n * @param {Object} [optDataIndex]\n * @param {Number} pageSize Size of pagesize\n * @param {Number} [optStart] Optional start.\n * @param {Number} [optLength] Optional length of requested data.\n */\nexport function getMissingPages(optDataIndex, pageSize, optStart, optLength) {\n\tconst count = optDataIndex?.count || null;\n\tconst restPages = getRestPages(count, pageSize, optStart, optLength);\n\n\tconst loadedPages = getLoadedPages(\n\t\toptDataIndex?.index,\n\t\toptStart,\n\t\tpageSize,\n\t\trestPages,\n\t\tcount,\n\t\toptLength\n\t);\n\tconst missingPages = _difference(restPages, loadedPages);\n\n\treturn missingPages;\n}\n","import {merge as _merge, isEmpty as _isEmpty} from 'lodash';\nimport {setState} from '@jvitela/recompute';\nimport {configDefaults} from '@gisatcz/ptr-core';\nimport ActionTypes from '../../../constants/ActionTypes';\nimport request from '../../_common/request';\nimport commonActions from '../../_common/actions';\nimport attributeRelations from '../AttributeRelations/actions';\nimport attributeData from '../AttributeData/actions';\nimport Select from '../../Select';\nimport {getPagination, getNullishPagination, getMissingPages} from './helpers';\n\nimport {getPageSize} from '../helpers';\n\nconst DEFAULT_PAGE_PAGINATION = {\n\toffset: 0,\n\tlimit: configDefaults.requestPageSize,\n};\n\n/**\n * Update whole data.components.components object with given components\n * @param components {Object}\n */\nfunction addComponentsFromView(components) {\n\treturn dispatch => {\n\t\tif (components) {\n\t\t\tdispatch(actionAddOrReplaceComponents(components));\n\t\t}\n\t};\n}\n\n/**\n * Update component deeply with new data\n * @param componentKey {string}\n * @param update {Object}\n */\nfunction updateComponent(componentKey, update) {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\tconst componentState =\n\t\t\tSelect.data.components.getComponentStateByKey(state, componentKey) || {};\n\n\t\tdispatch(\n\t\t\tactionAddOrReplaceComponents({\n\t\t\t\t[componentKey]: _merge(componentState, update),\n\t\t\t})\n\t\t);\n\t};\n}\n\n/**\n * Ensure load attribute data and relations.\n * Useful if no indexes are registered for relations and attribute data.\n * Function has two phases, it loads data and relations in first and determinate and loads what is missing in second phase.\n * @param {String} componentKey Related component\n * @param {Array?} order Order object for attributes\n * @param {Object} commonFilter Common filter object used as a relationsFilter and used in attributeDataFilter.\n * @param {Object} attributeDataFilterExtension Object contains values for extend commonFilter to create attributeDataFilter.\n * @param {Number} start Position of first asked item after ordered.\n * @param {Number} length How many attribute data asking for.\n * @param {Number} PAGE_SIZE How many attribute data items will be in one request.\n * @param {Boolean} loadRelations Whether to load relations.\n * @param {Boolean} loadData Whether to load attribute data.\n * @param {Object} attributePagination Paginations for attributes {offset: Number, limit: Number}\n * @param {Object} relationsPagination Paginations for relations {offset: Number, limit: Number}\n * @return {function}\n */\nfunction ensureDataAndRelations(\n\tcomponentKey,\n\torder,\n\tcommonFilter,\n\tattributeDataFilterExtension,\n\tstart,\n\tlength,\n\tPAGE_SIZE,\n\tloadRelations,\n\tloadData,\n\tattributePagination,\n\trelationsPagination\n) {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\t// Update recompute state before ask cached selectors.\n\t\tsetState(state);\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(state);\n\t\tconst PAGE_SIZE = getPageSize(localConfig);\n\t\tconst RELATIONS_PAGE_SIZE = getPageSize(localConfig);\n\n\t\treturn dispatch(\n\t\t\tloadIndexedPage(\n\t\t\t\torder,\n\t\t\t\tcommonFilter,\n\t\t\t\tattributeDataFilterExtension,\n\t\t\t\t!!loadRelations,\n\t\t\t\tloadData,\n\t\t\t\trelationsPagination,\n\t\t\t\tattributePagination\n\t\t\t)\n\t\t).then(response => {\n\t\t\tif (response instanceof Error) {\n\t\t\t\treturn;\n\t\t\t\tthrow response;\n\t\t\t}\n\n\t\t\tsetState(getState());\n\n\t\t\tconst attributeDataIndex =\n\t\t\t\tSelect.data.components.getIndexForAttributeDataByComponentKey(\n\t\t\t\t\tcomponentKey\n\t\t\t\t) || [];\n\n\t\t\tconst relationsFilter = {...commonFilter};\n\t\t\tconst attributeRelationsIndex =\n\t\t\t\tSelect.data.attributeRelations.getIndex(getState(), relationsFilter) ||\n\t\t\t\t[];\n\n\t\t\tconst missingAttributesPages = getMissingPages(\n\t\t\t\tattributeDataIndex,\n\t\t\t\tPAGE_SIZE,\n\t\t\t\tstart,\n\t\t\t\tlength\n\t\t\t);\n\t\t\tconst missingRelationsPages = getMissingPages(\n\t\t\t\tattributeRelationsIndex,\n\t\t\t\tRELATIONS_PAGE_SIZE,\n\t\t\t\t1,\n\t\t\t\tnull\n\t\t\t);\n\n\t\t\tif (\n\t\t\t\tmissingRelationsPages.length === 0 &&\n\t\t\t\tmissingAttributesPages.length === 0\n\t\t\t) {\n\t\t\t\t//nothing to load\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\t//needs to load more relations or data\n\t\t\t\treturn dispatch(\n\t\t\t\t\tloadMissingRelationsAndData(\n\t\t\t\t\t\tcomponentKey,\n\t\t\t\t\t\torder,\n\t\t\t\t\t\tcommonFilter,\n\t\t\t\t\t\tattributeDataFilterExtension,\n\t\t\t\t\t\tmissingRelationsPages,\n\t\t\t\t\t\tmissingAttributesPages,\n\t\t\t\t\t\tstart,\n\t\t\t\t\t\tlength,\n\t\t\t\t\t\tPAGE_SIZE\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t};\n}\n\n/**\n * Helper function. Usually second step in requesting data.\n * Load all relations and attributeData based on its remaining page counts.\n * @param {String} componentKey\n * @param {Array?} order Order object for attributes\n * @param {Object} commonFilter Common filter object used as a relationsFilter and used in attributeDataFilter.\n * @param {Object} attributeDataFilterExtension Object contains values for extend commonFilter to create attributeDataFilter.\n * @param {Array} remainingRelationsPages Missing page indexes of ralations defined in array. [0,1,2,3] || [2,5]\n * @param {Array} remainingAttributeDataPages Missing page indexes of attributes defined in array. [0,1,2,3] || [2,5]\n * @param {Array} start Starting position of first requested item. Defualt is 1.\n * @param {Array} length Length of asked attributeData\n * @param {Number} PAGE_SIZE How many attribute data items will be in one request.\n * @return {function} Return promise.\n */\nfunction loadMissingRelationsAndData(\n\tcomponentKey,\n\torder,\n\tcommonFilter,\n\tattributeDataFilterExtension,\n\tremainingRelationsPages,\n\tremainingAttributeDataPages,\n\tstart,\n\tlength,\n\tPAGE_SIZE\n) {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\t// Update recompute state before ask cached selectors.\n\t\tsetState(state);\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(state);\n\t\tconst RELATIONS_PAGE_SIZE = getPageSize(localConfig);\n\n\t\tconst promises = [];\n\n\t\tconst attributeDataIndex =\n\t\t\tSelect.data.components.getIndexForAttributeDataByComponentKey(\n\t\t\t\tcomponentKey\n\t\t\t) || {};\n\t\tconst attributeCount = attributeDataIndex.count;\n\n\t\t// load remaining relations pages\n\t\tlet pagination = 0;\n\t\tconst loadRelations = true;\n\n\t\tfor (let i = 1; i <= remainingRelationsPages.length; i++) {\n\t\t\tconst relationsPagination = getPagination(\n\t\t\t\tremainingRelationsPages[i - 1],\n\t\t\t\t1,\n\t\t\t\tRELATIONS_PAGE_SIZE\n\t\t\t);\n\n\t\t\t//only if missing attribute data pages missing\n\t\t\tlet attributePagination = getNullishPagination();\n\t\t\tlet loadData = false;\n\t\t\tif (pagination < remainingAttributeDataPages.length) {\n\t\t\t\tattributePagination = getPagination(\n\t\t\t\t\tremainingAttributeDataPages[i - 1],\n\t\t\t\t\tstart,\n\t\t\t\t\tPAGE_SIZE,\n\t\t\t\t\tlength,\n\t\t\t\t\tattributeCount\n\t\t\t\t);\n\t\t\t\tloadData = true;\n\t\t\t\tpagination = i;\n\t\t\t}\n\n\t\t\tpromises.push(\n\t\t\t\tdispatch(\n\t\t\t\t\tloadIndexedPage(\n\t\t\t\t\t\torder,\n\t\t\t\t\t\tcommonFilter,\n\t\t\t\t\t\tattributeDataFilterExtension,\n\t\t\t\t\t\tloadRelations,\n\t\t\t\t\t\tloadData,\n\t\t\t\t\t\trelationsPagination,\n\t\t\t\t\t\tattributePagination\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t// If its still needed, load remaining data pages\n\t\tfor (let i = pagination + 1; i <= remainingAttributeDataPages.length; i++) {\n\t\t\tconst relationsPagination = getNullishPagination();\n\t\t\tconst attributePagination = getPagination(\n\t\t\t\tremainingAttributeDataPages[i - 1],\n\t\t\t\tstart,\n\t\t\t\tPAGE_SIZE,\n\t\t\t\tlength,\n\t\t\t\tattributeCount\n\t\t\t);\n\t\t\tconst loadRelations = false;\n\t\t\tconst loadData = true;\n\t\t\tpromises.push(\n\t\t\t\tdispatch(\n\t\t\t\t\tloadIndexedPage(\n\t\t\t\t\t\torder,\n\t\t\t\t\t\tcommonFilter,\n\t\t\t\t\t\tattributeDataFilterExtension,\n\t\t\t\t\t\tloadRelations,\n\t\t\t\t\t\tloadData,\n\t\t\t\t\t\trelationsPagination,\n\t\t\t\t\t\tattributePagination\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\treturn Promise.all(promises);\n\t};\n}\n\n/**\n * Check if for given componentKey missing data or relations and load them.\n * @param {String} componentKey\n */\nconst ensure = componentKey => {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\t// Update recompute state before ask cached selectors.\n\t\tsetState(state);\n\t\tconst componentState = Select.data.components.getComponentStateByKey(\n\t\t\tstate,\n\t\t\tcomponentKey\n\t\t);\n\n\t\tif (componentState) {\n\t\t\tconst {attributeOrder: order = null, start = 1, length} = componentState;\n\n\t\t\tconst attributeDataFilterExtension = Select.data.components.getAttributeDataFilterExtensionByComponentKey(\n\t\t\t\tcomponentKey\n\t\t\t);\n\n\t\t\tconst commonFilter = Select.data.components.getCommonFilterByComponentKey(\n\t\t\t\tcomponentKey\n\t\t\t);\n\n\t\t\tconst relationsFilter = {\n\t\t\t\t...commonFilter,\n\t\t\t};\n\n\t\t\tconst attributeDataIndex =\n\t\t\t\tSelect.data.components.getIndexForAttributeDataByComponentKey(\n\t\t\t\t\tcomponentKey\n\t\t\t\t) || [];\n\n\t\t\tconst attributeRelationsIndex =\n\t\t\t\tSelect.data.attributeRelations.getIndex(state, relationsFilter) || [];\n\n\t\t\tlet loadRelations = true;\n\t\t\tlet loadData = true;\n\n\t\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(state);\n\t\t\tconst RELATIONS_PAGE_SIZE = getPageSize(localConfig);\n\n\t\t\t// Attribute data page size is same like app page size\n\t\t\t// In case of need PAGE_SIZE could be modified here\n\t\t\tconst PAGE_SIZE = RELATIONS_PAGE_SIZE;\n\n\t\t\tlet relationsPagination = getPagination(0, 1, RELATIONS_PAGE_SIZE);\n\t\t\tlet attributePagination = getPagination(0, start, PAGE_SIZE, length);\n\n\t\t\tlet missingRelationsPages, missingAttributesPages;\n\t\t\t// Relations index exist\n\t\t\t// find if all required relations are loaded\n\t\t\tif (!_isEmpty(attributeDataIndex)) {\n\t\t\t\tmissingRelationsPages = getMissingPages(\n\t\t\t\t\tattributeRelationsIndex,\n\t\t\t\t\tRELATIONS_PAGE_SIZE,\n\t\t\t\t\t1,\n\t\t\t\t\tnull\n\t\t\t\t);\n\t\t\t\trelationsPagination = getPagination(\n\t\t\t\t\tmissingRelationsPages[0] || 0,\n\t\t\t\t\t0,\n\t\t\t\t\tRELATIONS_PAGE_SIZE\n\t\t\t\t);\n\t\t\t\tif (missingRelationsPages.length > 0) {\n\t\t\t\t\tloadRelations = true;\n\t\t\t\t} else {\n\t\t\t\t\tloadRelations = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Attribute data index exist\n\t\t\t// find if all required data are loaded\n\t\t\tif (!_isEmpty(attributeDataIndex)) {\n\t\t\t\tmissingAttributesPages = getMissingPages(\n\t\t\t\t\tattributeDataIndex,\n\t\t\t\t\tPAGE_SIZE,\n\t\t\t\t\tstart,\n\t\t\t\t\tlength\n\t\t\t\t);\n\t\t\t\tattributePagination = getPagination(\n\t\t\t\t\tmissingAttributesPages[0] || 0,\n\t\t\t\t\tstart,\n\t\t\t\t\tPAGE_SIZE,\n\t\t\t\t\tlength,\n\t\t\t\t\tattributeDataIndex.count\n\t\t\t\t);\n\t\t\t\tif (missingAttributesPages.length > 0) {\n\t\t\t\t\tloadData = true;\n\t\t\t\t} else {\n\t\t\t\t\tloadData = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Attribute and relation index is loaded. We know exactly which attribute or relations pages we need.\n\t\t\tif (!_isEmpty(attributeDataIndex) && !_isEmpty(attributeRelationsIndex)) {\n\t\t\t\t// Some of data or relations are needed\n\t\t\t\tif (loadData || loadRelations) {\n\t\t\t\t\t// Load just missing data and relations defined by missingPages\n\t\t\t\t\treturn dispatch(\n\t\t\t\t\t\tloadMissingRelationsAndData(\n\t\t\t\t\t\t\tcomponentKey,\n\t\t\t\t\t\t\torder,\n\t\t\t\t\t\t\tcommonFilter,\n\t\t\t\t\t\t\tattributeDataFilterExtension,\n\t\t\t\t\t\t\tmissingRelationsPages,\n\t\t\t\t\t\t\tmissingAttributesPages,\n\t\t\t\t\t\t\tstart,\n\t\t\t\t\t\t\tlength,\n\t\t\t\t\t\t\tPAGE_SIZE\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\t// All data are loaded\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// Attribute or relations or both index is not loaded.\n\t\t\t} else {\n\t\t\t\t// Load relations and data\n\t\t\t\treturn dispatch(\n\t\t\t\t\tensureDataAndRelations(\n\t\t\t\t\t\tcomponentKey,\n\t\t\t\t\t\torder,\n\t\t\t\t\t\tcommonFilter,\n\t\t\t\t\t\tattributeDataFilterExtension,\n\t\t\t\t\t\tstart,\n\t\t\t\t\t\tlength,\n\t\t\t\t\t\tPAGE_SIZE,\n\t\t\t\t\t\tloadRelations,\n\t\t\t\t\t\tloadData,\n\t\t\t\t\t\tattributePagination,\n\t\t\t\t\t\trelationsPagination\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t};\n};\n\nconst ensureWithFilterByActive = filterByActive => {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\tconst componentsInUse = Select.data.components.getAllComponentsInUse(state);\n\t\tif (componentsInUse.length) {\n\t\t\tcomponentsInUse.forEach(componentKey => {\n\t\t\t\tconst fitsFilterByActive = Select.data.components.componentMatchesFilterByActive(\n\t\t\t\t\tstate,\n\t\t\t\t\tcomponentKey,\n\t\t\t\t\tfilterByActive\n\t\t\t\t);\n\t\t\t\tif (fitsFilterByActive) {\n\t\t\t\t\tdispatch(ensure(componentKey));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n};\n\n/**\n * Entry point for ensuring data for component\n * @param {string} componentKey\n */\nconst use = componentKey => {\n\treturn dispatch => {\n\t\tdispatch(componentUseRegister(componentKey));\n\t\tdispatch(ensure(componentKey));\n\t};\n};\n\n/**\n * Clear use of the component\n * @param componentKey {string}\n */\nconst componentUseClear = componentKey => {\n\treturn (dispatch, getState) => {\n\t\tconst registered = Select.data.components.isComponentInUse(\n\t\t\tgetState(),\n\t\t\tcomponentKey\n\t\t);\n\t\tif (registered) {\n\t\t\tdispatch(actionComponentUseClear(componentKey));\n\t\t}\n\t};\n};\n\n/**\n * Register use of the component\n * @param componentKey {string}\n */\nconst componentUseRegister = componentKey => {\n\treturn (dispatch, getState) => {\n\t\tconst alreadyRegistered = Select.data.components.isComponentInUse(\n\t\t\tgetState(),\n\t\t\tcomponentKey\n\t\t);\n\t\tif (!alreadyRegistered) {\n\t\t\tdispatch(actionComponentUseRegister(componentKey));\n\t\t}\n\t};\n};\n\n/**\n * Compose payload for request from given parameters\n * @param {Object} commonFilter Common filter object used as a relationsFilter and used in attributeDataFilter.\n * @param {Object} relationsPagination Pagination for relations. Example `{relations: true, limit:100, offset:0}`.\n * @param {Object?} attributeDataPagination Pagination for attributeData. Example `{data: true, limit:100, offset:0}`.\n * @param {Object} attributeDataFilterExtension Object contains values for extend commonFilter to create attributeDataFilter.\n * @param {Array?} order Order object for attributes\n * @returns {Object}\n */\nconst getPayload = (\n\tcommonFilter,\n\trelationsPagination,\n\tattributeDataPagination,\n\tattributeDataFilterExtension,\n\torder\n) => {\n\tconst {\n\t\tattributeFilter,\n\t\tdataSourceKeys,\n\t\tfeatureKeys,\n\t\tspatialFilter,\n\t} = attributeDataFilterExtension;\n\n\tconst {\n\t\tlayerTemplateKey,\n\t\tareaTreeLevelKey,\n\t\tattributeKeys,\n\t\tmodifiers,\n\t} = commonFilter;\n\n\t// Create payload\n\tconst payload = {\n\t\tmodifiers,\n\n\t\t// which layer you want\n\t\t...(layerTemplateKey && {layerTemplateKey}),\n\t\t...(areaTreeLevelKey && {areaTreeLevelKey}),\n\n\t\t// which attributes you want\n\t\t...(attributeKeys && {attributeKeys}),\n\n\t\t// pagination for relations (& data sources)\n\t\t// TODO add support for relations:false on BE\n\t\t// ...(loadRelations && {relations: usedRelationsPagination}),\n\t\trelations: relationsPagination,\n\n\t\tdata: {\n\t\t\t...(attributeDataPagination && attributeDataPagination),\n\n\t\t\t...(attributeFilter && {attributeFilter}),\n\n\t\t\tattributeOrder: order || null,\n\n\t\t\t// list of specific features you want\n\t\t\t...(featureKeys && {featureKeys}),\n\n\t\t\t// extent\n\t\t\t...(spatialFilter && {spatialFilter}),\n\n\t\t\t// use data source keys instead of LayerTemplateKey/AreaTreeLevelKey + modifiers\n\t\t\t...(dataSourceKeys && {dataSourceKeys}),\n\t\t},\n\t};\n\treturn payload;\n};\n\n/**\n * Process result into smaller actions that pass loaded data into store.\n * @param {Object} result Result from BE\n * @param {bool} loadRelations Wether BE should return relations\n * @param {Object} relationsFilter Filter object with modifiers\n * @param {Object?} relationsOrder Order object for relations\n * @param {Object} attributeDataFilter Object contains values extended by commonFilter.\n * @param {Array?} order Order object for attributes\n * @param {Number} relationsLimit Numeric limitation for loading relations\n * @returns\n */\nconst processResult = (\n\tresult,\n\tloadRelations,\n\trelationsFilter,\n\trelationsOrder,\n\tattributeDataFilter,\n\torder,\n\trelationsLimit\n) => {\n\treturn dispatch => {\n\t\tif (result.attributeData || result.attributeRelationsDataSources) {\n\t\t\tif (loadRelations) {\n\t\t\t\tconst changes = null;\n\t\t\t\tdispatch(\n\t\t\t\t\tattributeRelations.receiveIndexed(\n\t\t\t\t\t\tresult.attributeRelationsDataSources.attributeRelations,\n\t\t\t\t\t\trelationsFilter,\n\t\t\t\t\t\trelationsOrder,\n\t\t\t\t\t\tresult.attributeRelationsDataSources.offset + 1,\n\t\t\t\t\t\tresult.attributeRelationsDataSources.total,\n\t\t\t\t\t\tchanges,\n\t\t\t\t\t\trelationsLimit\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (result.attributeData.attributeData) {\n\t\t\t\tconst changes = null;\n\t\t\t\tdispatch(\n\t\t\t\t\tattributeData.receiveIndexed(\n\t\t\t\t\t\tresult.attributeData,\n\t\t\t\t\t\tattributeDataFilter,\n\t\t\t\t\t\torder,\n\t\t\t\t\t\tresult.attributeData.offset + 1,\n\t\t\t\t\t\tresult.attributeData.total,\n\t\t\t\t\t\tchanges\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t};\n};\n\n/**\n *\n * @param {Array?} order Order object for attributes\n * @param {Object} commonFilter Common filter object used as a relationsFilter and used in attributeDataFilter.\n * @param {Object} attributeDataFilterExtension Object contains values for extend commonFilter to create attributeDataFilter.\n * @param {bool} loadRelations Whether response should contain relations\n * @param {bool} loadData Whether response should contain data\n * @param {Object?} relationsPagination Pagination for relations.\n * @param {Object?} attributeDataPagination Pagination for attributeData.\n */\nfunction loadIndexedPage(\n\torder,\n\tcommonFilter,\n\tattributeDataFilterExtension,\n\tloadRelations,\n\tloadData,\n\trelationsPagination,\n\tattributeDataPagination\n) {\n\treturn (dispatch, getState) => {\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(getState());\n\t\tconst apiPath = 'rest/attributeData/filtered';\n\t\tconst relationsOrder = null;\n\n\t\tconst relationsFilter = {...commonFilter};\n\t\tconst attributeDataFilter = {\n\t\t\t...commonFilter,\n\t\t\t...attributeDataFilterExtension,\n\t\t};\n\n\t\tconst usedRelationsPagination = relationsPagination\n\t\t\t? {...relationsPagination}\n\t\t\t: DEFAULT_PAGE_PAGINATION;\n\n\t\tif (loadRelations) {\n\t\t\tusedRelationsPagination.relations = true;\n\t\t\t//set relations loading\n\t\t\tdispatch(\n\t\t\t\tattributeRelations.addLoadingIndex(\n\t\t\t\t\tusedRelationsPagination,\n\t\t\t\t\trelationsFilter,\n\t\t\t\t\trelationsOrder\n\t\t\t\t)\n\t\t\t);\n\t\t} else {\n\t\t\tusedRelationsPagination.relations = false;\n\t\t}\n\n\t\tconst usedAttributeDataPagination = attributeDataPagination\n\t\t\t? {...attributeDataPagination}\n\t\t\t: DEFAULT_PAGE_PAGINATION;\n\n\t\tif (loadData) {\n\t\t\tusedAttributeDataPagination.data = true;\n\t\t\t//set attributeData loading\n\t\t\tdispatch(\n\t\t\t\tattributeData.addLoadingIndex(\n\t\t\t\t\tusedAttributeDataPagination,\n\t\t\t\t\tattributeDataFilter,\n\t\t\t\t\torder\n\t\t\t\t)\n\t\t\t);\n\t\t} else {\n\t\t\tusedAttributeDataPagination.data = false;\n\t\t}\n\n\t\tconst payload = getPayload(\n\t\t\tcommonFilter,\n\t\t\tusedRelationsPagination,\n\t\t\tusedAttributeDataPagination,\n\t\t\tattributeDataFilterExtension,\n\t\t\torder\n\t\t);\n\n\t\treturn request(localConfig, apiPath, 'POST', null, payload, undefined, null)\n\t\t\t.then(result => {\n\t\t\t\tif (result.errors) {\n\t\t\t\t\tthrow new Error(result.errors[dataType] || 'no data');\n\t\t\t\t} else {\n\t\t\t\t\tif (result.attributeData || result.attributeRelationsDataSources) {\n\t\t\t\t\t\tconst relationsLimit = usedRelationsPagination.limit;\n\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\tprocessResult(\n\t\t\t\t\t\t\t\tresult,\n\t\t\t\t\t\t\t\tloadRelations,\n\t\t\t\t\t\t\t\trelationsFilter,\n\t\t\t\t\t\t\t\trelationsOrder,\n\t\t\t\t\t\t\t\tattributeDataFilter,\n\t\t\t\t\t\t\t\torder,\n\t\t\t\t\t\t\t\trelationsLimit\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst error = new Error('no data');\n\t\t\t\t\t\tdispatch(commonActions.actionGeneralError(error));\n\t\t\t\t\t\treturn error;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tdispatch(commonActions.actionGeneralError(error));\n\t\t\t\treturn error; //todo do we need to return this\n\t\t\t});\n\t};\n}\n\n// Actions ------------------------------------------------------------------------------------------------------------\n/**\n *\n * @param componentKey {string}\n * @param attributeKeys {Array}\n * @returns\n */\nconst actionSetAttributeKeys = (componentKey, attributeKeys) => {\n\treturn {\n\t\ttype: ActionTypes.DATA.COMPONENTS.COMPONENT.SET.ATTRIBUTE_KEYS,\n\t\tcomponentKey,\n\t\tattributeKeys,\n\t};\n};\n\nconst actionAddOrReplaceComponents = components => {\n\treturn {\n\t\ttype: ActionTypes.DATA.COMPONENTS.ADD_COMPONENTS,\n\t\tcomponents,\n\t};\n};\n\nconst actionComponentUseClear = componentKey => {\n\treturn {\n\t\ttype: ActionTypes.DATA.COMPONENTS.COMPONENT.USE.CLEAR,\n\t\tcomponentKey,\n\t};\n};\n\nconst actionComponentUseRegister = componentKey => {\n\treturn {\n\t\ttype: ActionTypes.DATA.COMPONENTS.COMPONENT.USE.REGISTER,\n\t\tcomponentKey,\n\t};\n};\n\nexport default {\n\taddComponentsFromView,\n\tcomponentUseClear,\n\tcomponentUseRegister,\n\tensure,\n\tensureDataAndRelations,\n\tensureWithFilterByActive,\n\tgetPayload,\n\tloadIndexedPage,\n\tloadMissingRelationsAndData,\n\tprocessResult,\n\tsetAttributeKeys: actionSetAttributeKeys,\n\tupdateComponent,\n\tuse,\n};\n","import ActionTypes from '../../../constants/ActionTypes';\nimport common from '../../_common/actions';\n\nconst actionTypes = ActionTypes.DATA.SPATIAL_RELATIONS;\n\nconst addIndex = common.addIndex(actionTypes);\nconst add = common.add(actionTypes);\n\n// ============ creators ===========\n/**\n * It ensure adding index and adding received spatialRelations from BE.\n * Add relations to state only when spatialRelations received, in case of empty spatialRelations it adds only index.\n * @param {Object} spatialRelations Object received from BE.\n * @param {Object} filter Filler object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @param {Array?} order\n * @param {Number} start\n * @param {Number} total\n * @param {string?} changedOn\n */\nfunction receiveIndexed(\n\tspatialRelations,\n\tfilter,\n\torder,\n\tstart,\n\ttotal,\n\tchanges\n) {\n\treturn dispatch => {\n\t\t// add spatialRelations to store\n\t\t// There should be check if relation is already in the store.\n\t\tif (spatialRelations.length) {\n\t\t\tdispatch(add(spatialRelations, filter));\n\t\t}\n\n\t\t// add to index\n\t\tdispatch(addIndex(filter, order, total, start, spatialRelations, changes));\n\t};\n}\n\n// ============ actions ============\n// ============ export ===========\n\nexport default {\n\treceiveIndexed,\n};\n","import ActionTypes from '../../../constants/ActionTypes';\nimport common from '../../_common/actions';\n\nconst actionTypes = ActionTypes.DATA.SPATIAL_DATA_SOURCES;\n\nconst addIndex = common.addIndex(actionTypes);\nconst add = common.add(actionTypes);\n\n// ============ creators ===========\n/**\n * It ensure adding index and adding received spatialDataSources from BE.\n * Add dataSources to state only when spatialDataSources received, in case of empty spatialDataSources it adds only index.\n * @param {Object} spatialDataSources Object received from BE.\n * @param {Object} filter Filler object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @param {Array?} order\n * @param {Number} start\n * @param {Number} total\n * @param {string?} changedOn\n */\nfunction receiveIndexed(\n\tspatialDataSources,\n\tfilter,\n\torder,\n\tstart,\n\ttotal,\n\tchangedOn\n) {\n\treturn dispatch => {\n\t\t// add spatialDataSources to store\n\t\t// There should be check if spatialDataSources is already in the store.\n\t\tif (spatialDataSources.length) {\n\t\t\tdispatch(add(spatialDataSources, filter));\n\t\t}\n\n\t\t// add to index\n\t\tdispatch(\n\t\t\taddIndex(filter, order, total, start, spatialDataSources, changedOn)\n\t\t);\n\t};\n}\n\n// ============ actions ============\n\n// ============ export ===========\n\nexport default {\n\tadd,\n\treceiveIndexed,\n};\n","import ActionTypes from '../../../constants/ActionTypes';\nimport {isEmpty as _isEmpty, forIn as _forIn, reduce as _reduce} from 'lodash';\nimport {tileAsString} from '../helpers';\n\nconst actionTypes = ActionTypes.DATA.SPATIAL_DATA;\n\n// ============ creators ===========\n/**\n * It ensure adding index and adding received data from BE.\n * Add data to state only when spatialData received, in case of empty spatialData it adds only index.\n * @param {Object} spatialData Object received from BE contains under spatialDataKey object of data attributes [id]: {data, spatialIndex}.\n * @param {Object} filter Filler object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @param {Array?} order\n * @param {string?} changedOn\n */\nconst receiveIndexed = (spatialData, filter, order, changedOn) => {\n\treturn dispatch => {\n\t\tif (spatialData && !_isEmpty(spatialData)) {\n\t\t\treturn dispatch(addDataAndIndex(spatialData, filter, order, changedOn));\n\t\t}\n\t};\n};\n\n/**\n * Add data and index at the same time\n * Add data, even if data are empty, for replacing loading indicator.\n * @param spatialDataAndIndexByDataSourceKey {Object} [dataSourceKey]: {data: Object, spatialIndex: Object}\n * @param filter {Object}\n * @param order {Array}\n * @param changedOn {string}\n */\nfunction addDataAndIndex(\n\tspatialDataAndIndexByDataSourceKey,\n\tfilter,\n\torder,\n\tchangedOn\n) {\n\treturn dispatch => {\n\t\tconst indexByLevelByTileByDataSourceKey = getIndexData(\n\t\t\tspatialDataAndIndexByDataSourceKey\n\t\t);\n\n\t\t// spatialData should be only from one level\n\t\tconst level = Object.keys(indexByLevelByTileByDataSourceKey)[0];\n\n\t\tlet spatialDataByDataSourceKey = {};\n\t\t_forIn(\n\t\t\tspatialDataAndIndexByDataSourceKey,\n\t\t\t(value, spatialDataSourceKey) => {\n\t\t\t\tspatialDataByDataSourceKey[spatialDataSourceKey] = value.data;\n\t\t\t}\n\t\t);\n\n\t\tdispatch(\n\t\t\tactionAddDataAndIndex(\n\t\t\t\tspatialDataByDataSourceKey,\n\t\t\t\tlevel,\n\t\t\t\tfilter,\n\t\t\t\torder,\n\t\t\t\t[indexByLevelByTileByDataSourceKey],\n\t\t\t\tchangedOn\n\t\t\t)\n\t\t);\n\t};\n}\n\n/**\n * Create new index based on given level and tiles with loading indicator.\n * @param {Object} filter Filler object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @param {Array?} order\n * @param {Number} level\n * @param {Array.[Array]} tiles\n */\nfunction addLoadingIndex(filter, order, level, tiles) {\n\tconst changedOn = null;\n\n\t//create index with tiles value \"true\" that indicates loading state\n\tconst loadingTiles = _reduce(\n\t\ttiles,\n\t\t(acc, tile) => {\n\t\t\tconst tileId = tileAsString(tile);\n\t\t\tacc[tileId] = true;\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n\tconst index = {\n\t\t[level]: loadingTiles,\n\t};\n\treturn actionAddIndex(filter, order, [index], changedOn);\n}\n\n// ============ helpers ============\n\n/**\n * Get data for indexing\n * @param spatialDataByDataSourceKey {Object} [dataSourceKey]: {data: Object, spatialIndex: Object}\n * @return {Object}\n */\nfunction getIndexData(spatialDataByDataSourceKey) {\n\tconst indexByLevelByTileByDataSourceKey = {};\n\tfor (const [dsKey, datasource] of Object.entries(\n\t\tspatialDataByDataSourceKey\n\t)) {\n\t\tfor (const [level, tiles] of Object.entries(datasource.spatialIndex)) {\n\t\t\tif (!indexByLevelByTileByDataSourceKey[level]) {\n\t\t\t\tindexByLevelByTileByDataSourceKey[level] = {};\n\t\t\t}\n\t\t\tfor (const [tile, tileData] of Object.entries(tiles)) {\n\t\t\t\t//Add to existing index\n\t\t\t\tif (indexByLevelByTileByDataSourceKey?.[level]?.[tileAsString(tile)]) {\n\t\t\t\t\tindexByLevelByTileByDataSourceKey[level][tileAsString(tile)] = {\n\t\t\t\t\t\t...indexByLevelByTileByDataSourceKey[level][tileAsString(tile)],\n\t\t\t\t\t\t[dsKey]: tileData,\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\t//Create new tile and insert dsKey index data\n\t\t\t\t\tindexByLevelByTileByDataSourceKey[level][tileAsString(tile)] = {\n\t\t\t\t\t\t[dsKey]: tileData,\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn indexByLevelByTileByDataSourceKey;\n}\n\n// ============ actions ============\nfunction actionRemoveIndex(filter, order) {\n\treturn {\n\t\ttype: actionTypes.INDEX.REMOVE,\n\t\tfilter,\n\t\torder,\n\t};\n}\n\nfunction actionAddDataAndIndex(\n\tdataByDataSourceKey,\n\tlevel,\n\tfilter,\n\torder,\n\tindexData,\n\tchangedOn\n) {\n\treturn {\n\t\ttype: actionTypes.ADD_WITH_INDEX,\n\t\tdataByDataSourceKey,\n\t\tlevel,\n\t\tfilter,\n\t\torder,\n\t\tindexData,\n\t\tchangedOn,\n\t};\n}\n\nfunction actionAddIndex(filter, order, index, changedOn) {\n\treturn {\n\t\ttype: actionTypes.INDEX.ADD,\n\t\tfilter,\n\t\torder,\n\t\tindexData: index,\n\t\tchangedOn,\n\t};\n}\n\n// ============ export ===========\n\nexport default {\n\taddLoadingIndex,\n\tgetIndexData,\n\tremoveIndex: actionRemoveIndex,\n\treceiveIndexed,\n};\n","// Layer data types that supports vector tiling.\n// Tiled vectors has spatial and attributes indexes with loading indication.\n// TODO 'vector' is only temporary, remove it once it is modified on BE\nexport const TILED_VECTOR_LAYER_TYPES = ['tiledVector', 'tiled-vector'];\n","import {\n\tisEmpty as _isEmpty,\n\treduce as _reduce,\n\tflattenDeep as _flattenDeep,\n\tdifference as _difference,\n\tintersection as _intersection,\n} from 'lodash';\nimport {setState} from '@jvitela/recompute';\nimport {configDefaults} from '@gisatcz/ptr-core';\nimport attributeRelations from './AttributeRelations/actions';\nimport attributeDataSources from './AttributeDataSources/actions';\nimport attributeData from './AttributeData/actions';\nimport components from './Components/actions';\nimport spatialRelations from './SpatialRelations/actions';\nimport spatialDataSources from './SpatialDataSources/actions';\nimport spatialData from './SpatialData/actions';\nimport request from '../_common/request';\nimport commonActions from '../_common/actions';\n\nimport Select from '../Select';\nimport {\n\tgetMissingTiles,\n\ttileAsString,\n\tgetPageSize,\n\ttileAsStringArray,\n} from './helpers';\nimport {TILED_VECTOR_LAYER_TYPES} from './constants';\nimport helpers from '../_common/helpers';\n\nconst DEFAULT_RELATIONS_PAGE = {\n\toffset: 0,\n\tlimit: configDefaults.requestPageSize,\n};\n\n/**\n * Calculates how many page of relations is missing.\n * It assume that one page of size PAGE_SIZE was loaded.\n * @param {Number} attributeRelationsCount Wanted attributeRelations items\n * @param {Number} spatialRelationsCount Wanted spatialRelations items\n * @param {Number} PAGE_SIZE How many items fit to one page\n * @returns Number How many pages remaining\n */\nconst getRestRelationsPages = (\n\tattributeRelationsCount,\n\tspatialRelationsCount,\n\tPAGE_SIZE\n) => {\n\t// What is higer to load? attributeRelations or spatialRelations\n\tconst maxCountValue = Math.max(\n\t\tattributeRelationsCount,\n\t\tspatialRelationsCount\n\t);\n\tif (maxCountValue === 0) {\n\t\treturn 0;\n\t} else {\n\t\tconst remainingPageCount = Math.ceil(\n\t\t\t(maxCountValue - PAGE_SIZE) / PAGE_SIZE\n\t\t);\n\t\treturn remainingPageCount;\n\t}\n};\n\n/**\n * Helper function. Usually second step in requesting data.\n * Calculate if relations requests are missing based on attributeRelationsCount and spatialRelationsCount.\n * Each relations request loads one next tile from spatialFilter.\n * Rest tiles are loaded without relatiions.\n * @param {bool} loadGeometry Whether response should contain geometry\n * @param {Object} spatialFilter Spatial defined filter of level and its tiles\n * @param {string?} styleKey UUID\n * @param {Array?} order\n * @param {Object} spatialRelationsFilter Filler object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @param {Object} attributeRelationsFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey and styleKey.\n * @param {Number} attributeRelationsCount Count of known attribute relations. Used for determinate further requests.\n * @param {Number} spatialRelationsCount Count of known spatial relations. Used for determinate further requests.\n * @param {Array} preloadedSpatialDataSources SpatialDataSources loaded by previous request.\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @return {function} Return promise.\n */\nfunction loadMissingRelationsAndData(\n\tloadGeometry,\n\tspatialFilter,\n\tstyleKey,\n\torder,\n\tspatialRelationsFilter,\n\tattributeRelationsFilter,\n\tattributeRelationsCount,\n\tspatialRelationsCount,\n\tpreloadedSpatialDataSources = [],\n\tattributeDataFilter\n) {\n\treturn (dispatch, getState) => {\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(getState());\n\t\tconst PAGE_SIZE = getPageSize(localConfig);\n\n\t\tconst promises = [];\n\n\t\t// load remaining relations pages\n\t\t// ignoring first page\n\t\tconst remainingRelationsPageCount = getRestRelationsPages(\n\t\t\tattributeRelationsCount,\n\t\t\tspatialRelationsCount,\n\t\t\tPAGE_SIZE\n\t\t);\n\t\tlet tilesPagination = 0;\n\t\tfor (let i = 1; i <= remainingRelationsPageCount; i++) {\n\t\t\t//load only needed relations\n\t\t\tconst loadAttributeRelations = attributeRelationsCount - i > 0;\n\t\t\tconst loadSpatialRelations = spatialRelationsCount - i > 0;\n\t\t\tconst relations = {\n\t\t\t\toffset: i * PAGE_SIZE,\n\t\t\t\tlimit: PAGE_SIZE,\n\t\t\t};\n\n\t\t\ttilesPagination = i;\n\t\t\tconst spatialIndex = {\n\t\t\t\ttiles: [spatialFilter.tiles[tilesPagination]],\n\t\t\t};\n\t\t\tpromises.push(\n\t\t\t\tdispatch(\n\t\t\t\t\tloadIndexedPage(\n\t\t\t\t\t\tstyleKey,\n\t\t\t\t\t\trelations,\n\t\t\t\t\t\tspatialIndex,\n\t\t\t\t\t\tspatialFilter,\n\t\t\t\t\t\tloadGeometry,\n\t\t\t\t\t\tloadAttributeRelations,\n\t\t\t\t\t\tloadSpatialRelations,\n\t\t\t\t\t\torder,\n\t\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\t\tattributeDataFilter\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t//\n\t\t//load rest of tiles\n\t\t//\n\t\tconst remainingTilesPageCount = spatialFilter?.tiles?.length || 0;\n\n\t\t//first tile was loaded before loadMissingRelationsAndData first request\n\t\tfor (let i = tilesPagination + 1; i < remainingTilesPageCount; i++) {\n\t\t\tconst spatialIndex = {\n\t\t\t\ttiles: [spatialFilter.tiles[i]],\n\t\t\t};\n\n\t\t\tconst relations = {};\n\t\t\tconst loadRestTilesRelations = false;\n\t\t\tpromises.push(\n\t\t\t\tdispatch(\n\t\t\t\t\tloadIndexedPage(\n\t\t\t\t\t\tstyleKey,\n\t\t\t\t\t\trelations,\n\t\t\t\t\t\tspatialIndex,\n\t\t\t\t\t\tspatialFilter,\n\t\t\t\t\t\tloadGeometry,\n\t\t\t\t\t\tloadRestTilesRelations,\n\t\t\t\t\t\tloadRestTilesRelations,\n\t\t\t\t\t\torder,\n\t\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\t\tattributeDataFilter\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\tif (promises.length > 0) {\n\t\t\treturn Promise.all(promises).then((response = []) => {\n\t\t\t\t// All relations are loaded at this moment.\n\t\t\t\t// Check if all spatialDataSources relations from response and preloadedSpatialDataSources are type of \"unsupported\" like raster/wms/wmts.\n\t\t\t\t// If all spatialDataSources are unsupported, then received data are empty and indexes needs to be removed.\n\t\t\t\t// If only some of spatialDataSources relations are unsupported, then loading status on index will be replaced by data.\n\t\t\t\tconst spatialDataSourcesTypes = _flattenDeep(\n\t\t\t\t\tresponse.map(r =>\n\t\t\t\t\t\tr?.spatialAttributeRelationsDataSources?.spatialDataSources?.map(\n\t\t\t\t\t\t\tsds => ({\n\t\t\t\t\t\t\t\ttype: sds.data.type,\n\t\t\t\t\t\t\t\tkey: sds.key,\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t\tconst spatialDataSourcesPairs = [\n\t\t\t\t\t...spatialDataSourcesTypes,\n\t\t\t\t\t...preloadedSpatialDataSources,\n\t\t\t\t];\n\n\t\t\t\t//test spatialDataSources only if some come from BE\n\t\t\t\tconst allSourcesAreUnsupported = !_isEmpty(spatialDataSourcesPairs)\n\t\t\t\t\t? spatialDataSourcesPairs.every(\n\t\t\t\t\t\t\tds => !TILED_VECTOR_LAYER_TYPES.includes(ds.type)\n\t\t\t\t\t  )\n\t\t\t\t\t: false;\n\n\t\t\t\t// Check if all of returned spatialDataSources are unsupported type.\n\t\t\t\t// Indexes for unsupported layers can be cleared.\n\t\t\t\tif (allSourcesAreUnsupported) {\n\t\t\t\t\t// AttributeData and spatialData index represented by spatialRelationsFilter, attributeRelationsFilter and order can be deleted\n\t\t\t\t\tdispatch(spatialData.removeIndex(spatialRelationsFilter, order));\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tattributeData.removeSpatialIndex(attributeDataFilter, order)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t};\n}\n\n/**\n * Ensure load missing attribute data and relations for tiles defined in spatialFilter that are not loaded or loading in state.\n *\n * @param {Object} spatialFilter Spatial defined filter of level and its tiles\n * @param {string?} styleKey UUID\n * @param {Array?} order\n * @param {Object} spatialRelationsFilter Filler object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @param {Object} attributeRelationsFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey and styleKey.\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @return {function}\n */\nfunction loadMissingAttributeData(\n\tspatialFilter,\n\tstyleKey,\n\torder,\n\tspatialRelationsFilter,\n\tattributeRelationsFilter,\n\tattributeDataFilter\n) {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(state);\n\t\tconst PAGE_SIZE = getPageSize(localConfig);\n\n\t\tconst relations = {\n\t\t\t// start: 0,\n\t\t\t// length: 1000,\n\t\t\toffset: 0,\n\t\t\tlimit: PAGE_SIZE,\n\t\t};\n\n\t\t//\n\t\t// which attribute data to load\n\t\t//\n\n\t\t//get attribute data index with loaded and loading data\n\t\tconst attributeDataIndex =\n\t\t\tSelect.data.attributeData.getIndex(\n\t\t\t\tstate,\n\t\t\t\t'spatialIndexes',\n\t\t\t\tattributeDataFilter,\n\t\t\t\torder\n\t\t\t) || [];\n\n\t\t//diff loaded attribute data from index with wanted spatial data\n\t\tconst missingAttributeDataTiles =\n\t\t\tgetMissingTiles(attributeDataIndex, spatialFilter) || [];\n\n\t\t// Load relations and data sources in first request if they are not already loaded.\n\t\tconst attributeRelations = Select.data.attributeRelations.getIndex(\n\t\t\tstate,\n\t\t\tattributeRelationsFilter,\n\t\t\torder\n\t\t);\n\t\tconst attributeDataSources = Select.data.attributeDataSources.getIndex(\n\t\t\tstate,\n\t\t\tattributeRelationsFilter,\n\t\t\torder\n\t\t);\n\t\tlet loadAttributeRelationsAndDS = !(\n\t\t\t!_isEmpty(attributeRelations) && !_isEmpty(attributeDataSources)\n\t\t);\n\n\t\t//load only attribute data\n\t\tconst loadGeometry = false;\n\n\t\t// Modified spatial filter with only missing attribute data tiles\n\t\tconst spatialFilterWithMissingTiles = {\n\t\t\t...spatialFilter,\n\t\t\ttiles: missingAttributeDataTiles,\n\t\t};\n\t\t// Relations for given filters are missing\n\t\tif (loadAttributeRelationsAndDS) {\n\t\t\t// Only if spatialIndex is null then is set whole spatialFilter.tiles as loading true in one step\n\t\t\tconst spatialIndex = null;\n\t\t\tconst loadAttributeRelations = true;\n\t\t\tconst loadSpatialRelations = false;\n\t\t\t// Load relations\n\t\t\treturn dispatch(\n\t\t\t\tloadIndexedPage(\n\t\t\t\t\tstyleKey,\n\t\t\t\t\trelations,\n\t\t\t\t\tspatialIndex,\n\t\t\t\t\tspatialFilterWithMissingTiles,\n\t\t\t\t\tloadGeometry,\n\t\t\t\t\tloadAttributeRelations,\n\t\t\t\t\tloadSpatialRelations,\n\t\t\t\t\torder,\n\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\tattributeDataFilter\n\t\t\t\t)\n\t\t\t).then(response => {\n\t\t\t\tif (response instanceof Error) {\n\t\t\t\t\treturn;\n\t\t\t\t\tthrow response;\n\t\t\t\t}\n\n\t\t\t\tconst spatialDataSources =\n\t\t\t\t\tresponse?.spatialAttributeRelationsDataSources?.spatialDataSources ||\n\t\t\t\t\t[];\n\t\t\t\tconst preloadSpatialDataSources = spatialDataSources.map(sds => ({\n\t\t\t\t\ttype: sds.data.type,\n\t\t\t\t\tkey: sds.key,\n\t\t\t\t}));\n\n\t\t\t\tconst attributeRelationsCount =\n\t\t\t\t\tresponse.spatialAttributeRelationsDataSources.total\n\t\t\t\t\t\t.attributeRelations;\n\t\t\t\tconst spatialRelationsCount =\n\t\t\t\t\tresponse.spatialAttributeRelationsDataSources.total.spatialRelations;\n\t\t\t\treturn dispatch(\n\t\t\t\t\tloadMissingRelationsAndData(\n\t\t\t\t\t\tloadGeometry,\n\t\t\t\t\t\tspatialFilterWithMissingTiles,\n\t\t\t\t\t\tstyleKey,\n\t\t\t\t\t\torder,\n\t\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\t\tattributeRelationsCount,\n\t\t\t\t\t\tspatialRelationsCount,\n\t\t\t\t\t\tpreloadSpatialDataSources,\n\t\t\t\t\t\tattributeDataFilter\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t});\n\t\t} else {\n\t\t\tconst promises = [];\n\t\t\tconst loadAttributeRelations = false;\n\t\t\tconst loadSpatialRelations = false;\n\n\t\t\tfor (const tile of missingAttributeDataTiles) {\n\t\t\t\tconst spatialIndex = {\n\t\t\t\t\ttiles: [tile],\n\t\t\t\t};\n\n\t\t\t\tpromises.push(\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tloadIndexedPage(\n\t\t\t\t\t\t\tstyleKey,\n\t\t\t\t\t\t\trelations,\n\t\t\t\t\t\t\tspatialIndex,\n\t\t\t\t\t\t\tspatialFilter,\n\t\t\t\t\t\t\tloadGeometry,\n\t\t\t\t\t\t\tloadAttributeRelations,\n\t\t\t\t\t\t\tloadSpatialRelations,\n\t\t\t\t\t\t\torder,\n\t\t\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\t\t\tattributeDataFilter\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn Promise.all(promises);\n\t\t}\n\t};\n}\n\n/**\n * Ensure load missing spatial data for tiles defined in spatialFilter that are not loaded or loading in state.\n * @param {Object} spatialFilter Spatial defined filter of level and its tiles\n * @param {string?} styleKey UUID\n * @param {Array?} order\n * @param {Object} spatialRelationsFilter Filler object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @param {Object} attributeRelationsFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey and styleKey.\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @return {function}\n */\nfunction loadMissingSpatialData(\n\tspatialFilter,\n\tstyleKey,\n\torder,\n\tspatialRelationsFilter,\n\tattributeRelationsFilter,\n\tattributeDataFilter\n) {\n\treturn (dispatch, getState) => {\n\t\t//\n\t\t//which spatial data to load\n\t\t//\n\n\t\t//get spatial data index with loaded and loading data\n\t\tconst spatialDataIndex =\n\t\t\tSelect.data.spatialData.getIndex(\n\t\t\t\tgetState(),\n\t\t\t\tspatialRelationsFilter,\n\t\t\t\torder\n\t\t\t) || [];\n\n\t\t//diff spatial data loaded/loading and to load\n\t\tconst missingSpatialDataTiles =\n\t\t\tgetMissingTiles(spatialDataIndex, spatialFilter) || [];\n\t\tconst loadGeometry = true;\n\n\t\tdispatch(\n\t\t\tsetLoading(\n\t\t\t\tattributeDataFilter,\n\t\t\t\t{\n\t\t\t\t\ttiles: missingSpatialDataTiles,\n\t\t\t\t},\n\t\t\t\tspatialFilter,\n\t\t\t\tspatialRelationsFilter,\n\t\t\t\torder,\n\t\t\t\tloadGeometry\n\t\t\t)\n\t\t);\n\t\tconst promises = [];\n\t\tfor (const tile of missingSpatialDataTiles) {\n\t\t\tconst spatialIndex = {\n\t\t\t\ttiles: [tile],\n\t\t\t};\n\n\t\t\tconst relations = {};\n\t\t\tconst loadRelations = false;\n\t\t\tpromises.push(\n\t\t\t\tdispatch(\n\t\t\t\t\tloadIndexedPage(\n\t\t\t\t\t\tstyleKey,\n\t\t\t\t\t\trelations,\n\t\t\t\t\t\tspatialIndex,\n\t\t\t\t\t\tspatialFilter,\n\t\t\t\t\t\tloadGeometry,\n\t\t\t\t\t\tloadRelations,\n\t\t\t\t\t\tloadRelations,\n\t\t\t\t\t\torder,\n\t\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\t\tattributeDataFilter\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\treturn Promise.all(promises);\n\t};\n}\n\n/**\n * Ensure load spatial data, attribute data and relations for tiles defined in spatialFilter.\n * Makes load first page of data, if more date missing, pass filters to loadMissingRelationsAndData.\n * @param {Object} spatialFilter Spatial defined filter of level and its tiles\n * @param {string?} styleKey UUID\n * @param {Array?} order\n * @param {Object} spatialRelationsFilter Filler object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @param {Object} attributeRelationsFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey and styleKey.\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @return {function}\n */\nfunction ensureDataAndRelations(\n\tspatialFilter,\n\tstyleKey,\n\torder,\n\tspatialRelationsFilter,\n\tattributeRelationsFilter,\n\tattributeDataFilter\n) {\n\treturn (dispatch, getState) => {\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(getState());\n\t\tconst PAGE_SIZE = getPageSize(localConfig);\n\n\t\tconst relations = {\n\t\t\t// start: 0,\n\t\t\t// length: 1000,\n\t\t\toffset: 0,\n\t\t\tlimit: PAGE_SIZE,\n\t\t};\n\n\t\tconst loadGeometry = true;\n\t\tconst loadAttributeRelations = true;\n\t\tconst loadSpatialRelations = true;\n\t\tif (spatialFilter && !_isEmpty(spatialFilter)) {\n\t\t\t// Only if spatialIndex is null then is set whole spatialFilter.tiles as loading true in one step\n\t\t\tconst spatialIndex = null;\n\t\t\treturn dispatch(\n\t\t\t\tloadIndexedPage(\n\t\t\t\t\tstyleKey,\n\t\t\t\t\trelations,\n\t\t\t\t\tspatialIndex,\n\t\t\t\t\tspatialFilter,\n\t\t\t\t\tloadGeometry,\n\t\t\t\t\tloadAttributeRelations,\n\t\t\t\t\tloadSpatialRelations,\n\t\t\t\t\torder,\n\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\tattributeDataFilter\n\t\t\t\t)\n\t\t\t)\n\t\t\t\t.then(response => {\n\t\t\t\t\tif (response instanceof Error) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t\tthrow response;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst attributeRelationsCount =\n\t\t\t\t\t\tresponse.spatialAttributeRelationsDataSources.total\n\t\t\t\t\t\t\t.attributeRelations;\n\t\t\t\t\tconst spatialRelationsCount =\n\t\t\t\t\t\tresponse.spatialAttributeRelationsDataSources.total\n\t\t\t\t\t\t\t.spatialRelations;\n\n\t\t\t\t\tconst restRelationsPages = getRestRelationsPages(\n\t\t\t\t\t\tattributeRelationsCount,\n\t\t\t\t\t\tspatialRelationsCount,\n\t\t\t\t\t\tPAGE_SIZE\n\t\t\t\t\t);\n\n\t\t\t\t\tconst spatialDataSources =\n\t\t\t\t\t\tresponse?.spatialAttributeRelationsDataSources\n\t\t\t\t\t\t\t?.spatialDataSources || [];\n\n\t\t\t\t\t//test spatialDataSources only if some come from BE\n\t\t\t\t\tconst allSourcesAreUnsupported = loadSpatialRelations\n\t\t\t\t\t\t? spatialDataSources.every(\n\t\t\t\t\t\t\t\tds => !TILED_VECTOR_LAYER_TYPES.includes(ds.data?.type)\n\t\t\t\t\t\t  )\n\t\t\t\t\t\t: false;\n\n\t\t\t\t\t// Check if all of returned spatialDataSources are unsupported type.\n\t\t\t\t\t// If so, is no reason to make further requests.\n\t\t\t\t\t// Indexes for unsupported layers can be cleared.\n\t\t\t\t\tif (restRelationsPages === 0 && allSourcesAreUnsupported) {\n\t\t\t\t\t\t// AttributeData and spatialData index represented by spatialRelationsFilter, attributeRelationsFilter and order can be deleted\n\t\t\t\t\t\tdispatch(spatialData.removeIndex(spatialRelationsFilter, order));\n\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\tattributeData.removeSpatialIndex(attributeDataFilter, order)\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst preloadSpatialDataSources = spatialDataSources.map(sds => ({\n\t\t\t\t\t\t\ttype: sds.data.type,\n\t\t\t\t\t\t\tkey: sds.key,\n\t\t\t\t\t\t}));\n\t\t\t\t\t\treturn dispatch(\n\t\t\t\t\t\t\tloadMissingRelationsAndData(\n\t\t\t\t\t\t\t\tloadGeometry,\n\t\t\t\t\t\t\t\tspatialFilter,\n\t\t\t\t\t\t\t\tstyleKey,\n\t\t\t\t\t\t\t\torder,\n\t\t\t\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\t\t\t\tattributeRelationsCount,\n\t\t\t\t\t\t\t\tspatialRelationsCount,\n\t\t\t\t\t\t\t\tpreloadSpatialDataSources,\n\t\t\t\t\t\t\t\tattributeDataFilter\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tif (err?.message === 'Index outdated') {\n\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\trefreshIndex(\n\t\t\t\t\t\t\t\tgetSubstate,\n\t\t\t\t\t\t\t\tdataType,\n\t\t\t\t\t\t\t\tfilter,\n\t\t\t\t\t\t\t\torder,\n\t\t\t\t\t\t\t\tactionTypes,\n\t\t\t\t\t\t\t\tcategoryPath\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(`data/actions#ensure: ${err}`);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t} else {\n\t\t\treturn dispatch(\n\t\t\t\tcommonActions.actionGeneralError(new Error('Missing spatial filter'))\n\t\t\t);\n\t\t}\n\t};\n}\n\n/**\n * Find out all tiles from spatialFilter without loaded attribute data\n * @param {Object} attributeDataIndex\n * @param {Object} spatialFilter Spatial defined filter of level and its tiles\n */\nconst hasMissingAttributesData = (attributeDataIndex, spatialFilter) => {\n\tconst missingAttributeDataTiles =\n\t\tgetMissingTiles(attributeDataIndex, spatialFilter) || spatialFilter.tiles;\n\treturn missingAttributeDataTiles &&\n\t\tmissingAttributeDataTiles.length &&\n\t\tmissingAttributeDataTiles.length > 0\n\t\t? true\n\t\t: false;\n};\n\n/**\n * Find out all tiles from spatialFilter without loaded attribute data\n * @param {Object} spatialDataIndex\n * @param {Object} spatialFilter Spatial defined filter of level and its tiles\n */\nconst hasMissingSpatialData = (spatialDataIndex, spatialFilter) => {\n\tconst missingSpatialDataTiles =\n\t\tgetMissingTiles(spatialDataIndex, spatialFilter) || spatialFilter.tiles;\n\treturn missingSpatialDataTiles &&\n\t\tmissingSpatialDataTiles.length &&\n\t\tmissingSpatialDataTiles.length > 0\n\t\t? true\n\t\t: false;\n};\n\n/**\n * It find out if for given spatialRelationsFilter exists relations index.\n * The Existence of index means it is loading or loaded or we can just find out missing data.\n * TODO - add support of areaTrees\n * TODO - add support of dataSourcesKeys\n * @param {Object} state App state object\n * @param {Object} spatialRelationsFilter Filler object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @param {Array} order\n * @return {bool}\n */\nconst hasSpatialOrAreaRelations = (state, spatialRelationsFilter, order) => {\n\tlet spatialRelationsIndex = null;\n\tlet areaRelationsIndex = null;\n\n\tif (spatialRelationsFilter.layerTemplateKey) {\n\t\tspatialRelationsIndex = Select.data.spatialRelations.getIndex(\n\t\t\tstate,\n\t\t\tspatialRelationsFilter,\n\t\t\torder\n\t\t);\n\t}\n\n\t// FIXME - add support for areaTreeLevels\n\tif (spatialRelationsFilter.areaTreeLevelKey) {\n\t\t// areaRelationsIndex = Select.data.areaRelations.getIndex(getState(), spatialRelationsFilter, order);\n\t}\n\n\treturn spatialRelationsIndex !== null || areaRelationsIndex !== null;\n};\n\n/**\n * Entry function for requesting of loading new data. In first step are identified loaded indexes based on filters.\n * Next phase is request only data that are missing.\n * @param styleKey {string}\n * @param commonRelationsFilter {Object} Filter object with modifiers, layerTemplateKey or areaTreeLevelKey. It defines spatialRealations and after add styleKey is used as a attributeRelations filter.\n * @param {Object} spatialFilter Spatial defined filter of level and its tiles\n * @param attributeDataFilterExtension {Object} Filter object with optional values for attributeFilter, dataSourceKeys and featureKeys. After merge with attributeRelationsFilter it defines filter for attributeData\n * @return {function}\n */\nfunction ensure(\n\tstyleKey,\n\tcommonRelationsFilter,\n\tspatialFilter,\n\tattributeDataFilterExtension\n) {\n\treturn (dispatch, getState) => {\n\t\t// Filter params - see Panther docs: Code/API/Data endpoint\n\t\tconst {areaTreeLevelKey, layerTemplateKey} = commonRelationsFilter;\n\t\tconst spatialRelationsFilter = commonRelationsFilter;\n\t\tconst attributeRelationsFilter = {...commonRelationsFilter, styleKey};\n\t\tconst attributeDataFilter = {\n\t\t\t...attributeRelationsFilter,\n\t\t\t...attributeDataFilterExtension,\n\t\t};\n\n\t\t// ensure string datatype for tiles in filter\n\t\tspatialFilter.tiles = spatialFilter.tiles.map(tileAsStringArray);\n\n\t\t// Order for spatialData if null at the moment\n\t\tconst order = null;\n\n\t\tconst spatialDataIndex =\n\t\t\tSelect.data.spatialData.getIndex(\n\t\t\t\tgetState(),\n\t\t\t\tspatialRelationsFilter,\n\t\t\t\torder\n\t\t\t) || [];\n\t\tconst attributeDataIndex =\n\t\t\tSelect.data.attributeData.getIndex(\n\t\t\t\tgetState(),\n\t\t\t\t'spatialIndexes',\n\t\t\t\tattributeDataFilter,\n\t\t\t\torder\n\t\t\t) || [];\n\t\tconst missingAttributesData = hasMissingAttributesData(\n\t\t\tattributeDataIndex,\n\t\t\tspatialFilter\n\t\t);\n\t\tconst missingSpatialData = hasMissingSpatialData(\n\t\t\tspatialDataIndex,\n\t\t\tspatialFilter\n\t\t);\n\t\tconst filterHasSpatialOrAreaRelations = hasSpatialOrAreaRelations(\n\t\t\tgetState(),\n\t\t\tspatialRelationsFilter,\n\t\t\torder\n\t\t);\n\n\t\tconst loadRelationsAndData =\n\t\t\t!filterHasSpatialOrAreaRelations && missingSpatialData;\n\n\t\tlet modifiedSpatialFilterForAttributes = {...spatialFilter};\n\t\tlet modifiedSpatialFilterForSpatial = {...spatialFilter};\n\n\t\t// If spatial relations are loaded and spatial and attribute date are missing,\n\t\t// find which only attribute tile are missing and which attribute tiles load with spatial data.\n\t\tif (!loadRelationsAndData && missingAttributesData) {\n\t\t\tconst missingAttributeDataTiles =\n\t\t\t\tgetMissingTiles(attributeDataIndex, spatialFilter) || [];\n\t\t\tconst missingSpatialDataTiles =\n\t\t\t\tgetMissingTiles(spatialDataIndex, spatialFilter) || [];\n\n\t\t\tconst missingAttributeDataTilesToLoad = _difference(\n\t\t\t\tmissingAttributeDataTiles,\n\t\t\t\tmissingSpatialDataTiles\n\t\t\t);\n\t\t\tconst missingSpatialAndAttributeDataTiles = _intersection(\n\t\t\t\tmissingAttributeDataTiles,\n\t\t\t\tmissingSpatialDataTiles\n\t\t\t);\n\n\t\t\tmodifiedSpatialFilterForAttributes.tiles = missingAttributeDataTilesToLoad;\n\n\t\t\tmodifiedSpatialFilterForSpatial.tiles = missingSpatialAndAttributeDataTiles;\n\t\t}\n\n\t\tconst promises = [];\n\n\t\tif (loadRelationsAndData) {\n\t\t\tpromises.push(\n\t\t\t\tdispatch(\n\t\t\t\t\tensureDataAndRelations(\n\t\t\t\t\t\tspatialFilter,\n\t\t\t\t\t\tstyleKey,\n\t\t\t\t\t\torder,\n\t\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\t\tattributeDataFilter\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\tfilterHasSpatialOrAreaRelations &&\n\t\t\tmissingSpatialData &&\n\t\t\t!_isEmpty(modifiedSpatialFilterForSpatial.tiles)\n\t\t) {\n\t\t\tpromises.push(\n\t\t\t\tdispatch(\n\t\t\t\t\tloadMissingSpatialData(\n\t\t\t\t\t\tmodifiedSpatialFilterForSpatial,\n\t\t\t\t\t\tstyleKey,\n\t\t\t\t\t\torder,\n\t\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\t\tattributeDataFilter\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\t!loadRelationsAndData &&\n\t\t\t!_isEmpty(modifiedSpatialFilterForAttributes.tiles)\n\t\t) {\n\t\t\tpromises.push(\n\t\t\t\tdispatch(\n\t\t\t\t\tloadMissingAttributeData(\n\t\t\t\t\t\tmodifiedSpatialFilterForAttributes,\n\t\t\t\t\t\tstyleKey,\n\t\t\t\t\t\torder,\n\t\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\t\tattributeDataFilter\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\treturn Promise.all(promises);\n\t};\n}\n\n/**\n * Save result data to related stores.\n * If data are presented, then save them to attributeRelations, attributeDataSources, attributeData, spatialRelations, spatialDataSources, spatialData.\n * @param {Object} result result data from backend data endpoind\n * @param {bool} loadGeometry Whether response should contain geometry\n * @param {bool} loadAttributeRelations Whether response should contain relations\n * @param {bool} loadSpatialRelations Whether response should contain relations\n * @param {Array?} order\n * @param {Object} spatialRelationsFilter Filler object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @param {Object} attributeRelationsFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey and styleKey.\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @param {Object} start\n */\nfunction processResult(\n\tresult,\n\tloadGeometry,\n\tloadAttributeRelations,\n\tloadSpatialRelations,\n\torder,\n\tspatialRelationsFilter,\n\tattributeRelationsFilter,\n\tattributeDataFilter,\n\tstart\n) {\n\treturn (dispatch, getState) => {\n\t\t////\n\t\t// Attributes\n\t\t////\n\t\tif (\n\t\t\t!!loadAttributeRelations &&\n\t\t\tresult.spatialAttributeRelationsDataSources.attributeRelations &&\n\t\t\t!_isEmpty(result.spatialAttributeRelationsDataSources.attributeRelations)\n\t\t) {\n\t\t\tconst changes = null;\n\t\t\tdispatch(\n\t\t\t\tattributeRelations.receiveIndexed(\n\t\t\t\t\tresult.spatialAttributeRelationsDataSources.attributeRelations,\n\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\torder,\n\t\t\t\t\tstart,\n\t\t\t\t\tresult.spatialAttributeRelationsDataSources.total.attributeRelations,\n\t\t\t\t\tchanges\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\t!!loadAttributeRelations &&\n\t\t\tresult.spatialAttributeRelationsDataSources.attributeDataSources &&\n\t\t\t!_isEmpty(\n\t\t\t\tresult.spatialAttributeRelationsDataSources.attributeDataSources\n\t\t\t)\n\t\t) {\n\t\t\tconst changes = null;\n\t\t\tdispatch(\n\t\t\t\tattributeDataSources.receiveIndexed(\n\t\t\t\t\tresult.spatialAttributeRelationsDataSources.attributeDataSources,\n\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\torder,\n\t\t\t\t\tstart,\n\t\t\t\t\tresult.spatialAttributeRelationsDataSources.total.attributeRelations,\n\t\t\t\t\tchanges\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (result.spatialData && result.attributeData) {\n\t\t\tconst changes = null;\n\t\t\tconst spatialIndexData = attributeData.getIndexDataBySpatialData(\n\t\t\t\tresult.spatialData,\n\t\t\t\tresult.attributeData\n\t\t\t);\n\t\t\tdispatch(\n\t\t\t\tattributeData.receiveIndexedWithSpatialIndex(\n\t\t\t\t\tresult.attributeData,\n\t\t\t\t\tspatialIndexData,\n\t\t\t\t\tattributeDataFilter,\n\t\t\t\t\torder,\n\t\t\t\t\tchanges\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t////\n\t\t// Spatial data\n\t\t////\n\t\tif (\n\t\t\t!!loadSpatialRelations &&\n\t\t\tresult.spatialAttributeRelationsDataSources.spatialRelations &&\n\t\t\t!_isEmpty(result.spatialAttributeRelationsDataSources.spatialRelations)\n\t\t) {\n\t\t\tconst changes = null;\n\t\t\tdispatch(\n\t\t\t\tspatialRelations.receiveIndexed(\n\t\t\t\t\tresult.spatialAttributeRelationsDataSources.spatialRelations,\n\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\torder,\n\t\t\t\t\tstart,\n\t\t\t\t\tresult.spatialAttributeRelationsDataSources.total.spatialRelations,\n\t\t\t\t\tchanges\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\t!!loadSpatialRelations &&\n\t\t\tresult.spatialAttributeRelationsDataSources.spatialDataSources &&\n\t\t\t!_isEmpty(result.spatialAttributeRelationsDataSources.spatialDataSources)\n\t\t) {\n\t\t\tconst changes = null;\n\t\t\tdispatch(\n\t\t\t\tspatialDataSources.receiveIndexed(\n\t\t\t\t\tresult.spatialAttributeRelationsDataSources.spatialDataSources,\n\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\torder,\n\t\t\t\t\tstart,\n\t\t\t\t\tresult.spatialAttributeRelationsDataSources.total.spatialRelations,\n\t\t\t\t\tchanges\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (!!loadGeometry) {\n\t\t\t// Add data even if data are empty.\n\t\t\t// Override loading indicator in state index\n\t\t\tconst changes = null;\n\t\t\tdispatch(\n\t\t\t\tspatialData.receiveIndexed(\n\t\t\t\t\tresult.spatialData,\n\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\torder,\n\t\t\t\t\tchanges\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t};\n}\n\n/**\n * Create request payload for data endpoint\n * @param {Object} spatialRelationsFilter Filler object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @param {string?} styleKey\n * @param {Object?} relations Pagination for relations.\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @param {Object?} spatialIndex Object where under \"tiles\" key is array of tiles that should be loaded. Tiles are subset of tiles defined inspatilaFilter.\n * @param {bool} loadGeometry Whether response should contain geometry\n * @param {bool} loadAttributeRelations Whether response should contain relations\n * @param {bool} loadSpatialRelations Whether response should contain relations\n * @param {Object} spatialFilter Spatial defined filter of level and its tiles\n * @returns\n */\nfunction composeDataEndpointPayload(\n\tspatialRelationsFilter,\n\tstyleKey,\n\trelations,\n\tattributeDataFilter,\n\tspatialIndex,\n\tloadGeometry,\n\tloadAttributeRelations,\n\tloadSpatialRelations,\n\tspatialFilter\n) {\n\tconst {areaTreeLevelKey, layerTemplateKey, modifiers} =\n\t\tspatialRelationsFilter || {};\n\n\t// Create payload\n\tconst payload = {\n\t\t...(modifiers && {modifiers}),\n\n\t\t// which layer you want\n\t\t...(layerTemplateKey && {layerTemplateKey}),\n\t\t...(areaTreeLevelKey && {areaTreeLevelKey}),\n\n\t\t// get attributes from style\n\t\t...(styleKey && {styleKey}),\n\n\t\t// pagination for relations (& data sources)\n\t\trelations: {\n\t\t\t...relations,\n\n\t\t\t//should response contain attribute or spatial relations\n\t\t\tattribute: !!loadAttributeRelations,\n\t\t\tspatial: !!loadSpatialRelations,\n\t\t},\n\n\t\tdata: {\n\t\t\t// list of features you want\n\t\t\t...(attributeDataFilter?.featureKeys && {\n\t\t\t\tfeatureKeys: attributeDataFilter.featureKeys,\n\t\t\t}),\n\n\t\t\t// which tiles you want (pseudo-pagination)\n\t\t\t// spatialIndex: {\n\t\t\t//     tiles: [[lon, lat], ...],\n\t\t\t// },\n\t\t\t...(spatialIndex && {spatialIndex}),\n\n\t\t\t// extent\n\t\t\tspatialFilter,\n\n\t\t\t// filter features by attribute value\n\t\t\t// attributeFilter: {\n\t\t\t//     'attribute-uuid': \"blue\",\n\t\t\t//     'attribute-uuid': {\n\t\t\t//         in: [12, 13]\n\t\t\t//     },\n\t\t\t//     ...\n\t\t\t// },\n\t\t\t...(attributeDataFilter?.attributeFilter && {\n\t\t\t\tattributeFilter: attributeDataFilter.attributeFilter,\n\t\t\t}),\n\n\t\t\t//request for geometry\n\t\t\tgeometry: !!loadGeometry,\n\n\t\t\t// use data source keys as filter or add them to filter\n\t\t\t...(attributeDataFilter?.dataSourceKeys && {\n\t\t\t\tdataSourceKeys: attributeDataFilter.dataSourceKeys,\n\t\t\t}),\n\t\t},\n\t};\n\treturn payload;\n}\n\n/**\n * Set loading status to spatialData and attributeData stores to related indexes, level and tiles.\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n * @param {Object?} spatialIndex Object where under \"tiles\" key is array of tiles that should be loaded. Tiles are subset of tiles defined inspatilaFilter.\n * @param {Object} spatialFilter Spatial defined filter of level and its tiles\n * @param {Object} spatialRelationsFilter Filler object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @param {Array?} order\n * @param {bool} loadGeometry Whether response should contain geometry\n */\nfunction setLoading(\n\tattributeDataFilter,\n\tspatialIndex,\n\tspatialFilter,\n\tspatialRelationsFilter,\n\torder,\n\tloadGeometry\n) {\n\treturn (dispatch, getState) => {\n\t\tsetState(getState());\n\t\tconst loadingTilesGeometry =\n\t\t\tspatialIndex?.tiles || spatialFilter?.tiles || [];\n\n\t\t//get loading tiles\n\t\tconst spatialTilesInNotLoadingState = _reduce(\n\t\t\tloadingTilesGeometry,\n\t\t\t(acc = [], tile) => {\n\t\t\t\tconst loading = Select.data.spatialData.isTileLoading(\n\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\tspatialFilter.level,\n\t\t\t\t\ttileAsString(tile)\n\t\t\t\t);\n\t\t\t\tif (!loading) {\n\t\t\t\t\treturn [...acc, tileAsStringArray(tile)];\n\t\t\t\t} else {\n\t\t\t\t\treturn acc;\n\t\t\t\t}\n\t\t\t},\n\t\t\t[]\n\t\t);\n\t\tconst attributesTilesInNotLoadingState = _reduce(\n\t\t\tloadingTilesGeometry,\n\t\t\t(acc = [], tile) => {\n\t\t\t\tconst loading = Select.data.attributeData.isTileLoading(\n\t\t\t\t\tattributeDataFilter,\n\t\t\t\t\tspatialFilter.level,\n\t\t\t\t\ttileAsString(tile)\n\t\t\t\t);\n\t\t\t\tif (!loading) {\n\t\t\t\t\treturn [...acc, tileAsStringArray(tile)];\n\t\t\t\t} else {\n\t\t\t\t\treturn acc;\n\t\t\t\t}\n\t\t\t},\n\t\t\t[]\n\t\t);\n\n\t\t////\n\t\t// Spatial\n\t\t////\n\t\tif (loadGeometry && spatialTilesInNotLoadingState.length > 0) {\n\t\t\tdispatch(\n\t\t\t\tspatialData.addLoadingIndex(\n\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\torder,\n\t\t\t\t\tspatialFilter.level,\n\t\t\t\t\tspatialTilesInNotLoadingState\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\t////\n\t\t// Attribute\n\t\t////\n\t\tif (attributesTilesInNotLoadingState.length > 0) {\n\t\t\tdispatch(\n\t\t\t\tattributeData.addLoadingSpatialIndex(\n\t\t\t\t\tattributeDataFilter,\n\t\t\t\t\torder,\n\t\t\t\t\tspatialFilter.level,\n\t\t\t\t\tattributesTilesInNotLoadingState\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t};\n}\n\n/**\n * Central method for executing requests to data endpoint.\n * @param {string?} styleKey\n * @param {Object?} relations Pagination for relations.\n * @param {Object?} spatialIndex Object where under \"tiles\" key is array of tiles that should be loaded. Tiles are subset of tiles defined inspatilaFilter.\n * @param {Object} spatialFilter Spatial defined filter of level and its tiles\n * @param {bool} loadGeometry Whether response should contain geometry\n * @param {bool} loadAttributeRelations Whether response should contain relations\n * @param {bool} loadSpatialRelations Whether response should contain relations\n * @param {Array?} order\n * @param {Object} spatialRelationsFilter Filler object contains modifiers and layerTemplateKey or areaTreeLevelKey.\n * @param {Object} attributeRelationsFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey and styleKey.\n * @param {Object} attributeDataFilter Filler object contains modifiers, layerTemplateKey or areaTreeLevelKey, styleKey, and optional values for attributeFilter, dataSourceKeys and featureKeys.\n */\nfunction loadIndexedPage(\n\tstyleKey,\n\trelations,\n\tspatialIndex,\n\tspatialFilter,\n\tloadGeometry,\n\tloadAttributeRelations,\n\tloadSpatialRelations,\n\torder,\n\tspatialRelationsFilter = {},\n\tattributeRelationsFilter,\n\tattributeDataFilter\n) {\n\treturn (dispatch, getState) => {\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(getState());\n\t\tconst apiPath = 'rest/data/filtered';\n\n\t\t//Register loading to related indexes and tiles\n\t\tdispatch(\n\t\t\tsetLoading(\n\t\t\t\tattributeDataFilter,\n\t\t\t\tspatialIndex,\n\t\t\t\tspatialFilter,\n\t\t\t\tspatialRelationsFilter,\n\t\t\t\torder,\n\t\t\t\tloadGeometry\n\t\t\t)\n\t\t);\n\n\t\tconst usedRelations = relations ? {...relations} : DEFAULT_RELATIONS_PAGE;\n\n\t\tconst payload = composeDataEndpointPayload(\n\t\t\tspatialRelationsFilter,\n\t\t\tstyleKey,\n\t\t\tusedRelations,\n\t\t\tattributeDataFilter,\n\t\t\tspatialIndex,\n\t\t\tloadGeometry,\n\t\t\tloadAttributeRelations,\n\t\t\tloadSpatialRelations,\n\t\t\tspatialFilter\n\t\t);\n\n\t\tconst start = usedRelations.offset + 1;\n\n\t\treturn request(localConfig, apiPath, 'POST', null, payload, undefined, null)\n\t\t\t.then(result => {\n\t\t\t\tif (result.errors) {\n\t\t\t\t\tconst error = new Error(result.errors[dataType] || 'no data');\n\t\t\t\t\tdispatch(commonActions.actionGeneralError(error));\n\t\t\t\t} else {\n\t\t\t\t\tif (\n\t\t\t\t\t\tresult.spatialAttributeRelationsDataSources &&\n\t\t\t\t\t\tresult.spatialData &&\n\t\t\t\t\t\tresult.attributeData\n\t\t\t\t\t) {\n\t\t\t\t\t\tdispatch(\n\t\t\t\t\t\t\tprocessResult(\n\t\t\t\t\t\t\t\tresult,\n\t\t\t\t\t\t\t\tloadGeometry,\n\t\t\t\t\t\t\t\tloadAttributeRelations,\n\t\t\t\t\t\t\t\tloadSpatialRelations,\n\t\t\t\t\t\t\t\torder,\n\t\t\t\t\t\t\t\tspatialRelationsFilter,\n\t\t\t\t\t\t\t\tattributeRelationsFilter,\n\t\t\t\t\t\t\t\tattributeDataFilter,\n\t\t\t\t\t\t\t\tstart\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst error = new Error('no data');\n\t\t\t\t\t\tdispatch(commonActions.actionGeneralError(error));\n\t\t\t\t\t\treturn error;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tdispatch(commonActions.actionGeneralError(error));\n\t\t\t\treturn error; //todo do we need to return this\n\t\t\t});\n\t};\n}\n\nexport default {\n\t//export of sub actions\n\tattributeData,\n\tattributeDataSources,\n\tattributeRelations,\n\tcomponents,\n\tspatialData,\n\tspatialDataSources,\n\tspatialRelations,\n\n\t//export functions\n\tcomposeDataEndpointPayload,\n\tensure,\n\tensureDataAndRelations,\n\tgetRestRelationsPages,\n\thasMissingAttributesData,\n\thasMissingSpatialData,\n\thasSpatialOrAreaRelations,\n\tloadIndexedPage,\n\tloadMissingAttributeData,\n\tloadMissingRelationsAndData,\n\tloadMissingSpatialData,\n\tprocessResult,\n\tsetLoading,\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common from '../_common/actions';\nimport Select from '../Select';\n\n// ============ creators ===========\n\nconst add = common.add(ActionTypes.LAYER_TEMPLATES);\nconst create = common.create(\n\tSelect.layerTemplates.getSubstate,\n\t'layerTemplates',\n\tActionTypes.LAYER_TEMPLATES\n);\nconst deleteItem = common.delete(\n\tSelect.layerTemplates.getSubstate,\n\t'layerTemplates',\n\tActionTypes.LAYER_TEMPLATES\n);\nconst saveEdited = common.saveEdited(\n\tSelect.layerTemplates.getSubstate,\n\t'layerTemplates',\n\tActionTypes.LAYER_TEMPLATES\n);\nconst setActiveKey = common.setActiveKey(ActionTypes.LAYER_TEMPLATES);\nconst updateEdited = common.updateEdited(\n\tSelect.layerTemplates.getSubstate,\n\tActionTypes.LAYER_TEMPLATES\n);\nconst useKeys = common.useKeys(\n\tSelect.layerTemplates.getSubstate,\n\t'layerTemplates',\n\tActionTypes.LAYER_TEMPLATES\n);\nconst useKeysClear = common.useKeysClear(ActionTypes.LAYER_TEMPLATES);\nconst useIndexed = common.useIndexed(\n\tSelect.layerTemplates.getSubstate,\n\t'layerTemplates',\n\tActionTypes.LAYER_TEMPLATES\n);\nconst useIndexedClear = common.useIndexedClear(ActionTypes.LAYER_TEMPLATES);\nconst clearIndex = common.clearIndex(ActionTypes.LAYER_TEMPLATES);\n\nconst setActiveKeyAndEnsureDependencies = key => {\n\treturn (dispatch, getState, options) => {\n\t\tdispatch(setActiveKey(key));\n\t\tdispatch(options.ensureDependenciesOfActiveMetadataType('layerTemplate'));\n\t};\n};\n\n// ============ export ===========\n\nexport default {\n\tadd,\n\tclearIndex,\n\tcreate,\n\tdelete: deleteItem,\n\tsaveEdited,\n\n\tsetActiveKey: setActiveKeyAndEnsureDependencies,\n\n\tupdateEdited,\n\tuseIndexed,\n\tuseIndexedClear,\n\tuseKeys,\n\tuseKeysClear,\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport Select from '../Select';\n\nimport common from '../_common/actions';\n\n// ============ creators ===========\n\nconst create = common.create(\n\tSelect.layerTrees.getSubstate,\n\t'layerTrees',\n\tActionTypes.LAYER_TREES,\n\t'applications'\n);\nconst deleteItem = common.delete(\n\tSelect.layerTrees.getSubstate,\n\t'layerTrees',\n\tActionTypes.LAYER_TREES,\n\t'applications'\n);\nconst saveEdited = common.saveEdited(\n\tSelect.layerTrees.getSubstate,\n\t'layerTrees',\n\tActionTypes.LAYER_TREES,\n\t'applications'\n);\nconst updateEdited = common.updateEdited(\n\tSelect.layerTrees.getSubstate,\n\tActionTypes.LAYER_TREES\n);\nconst useKeys = common.useKeys(\n\tSelect.layerTrees.getSubstate,\n\t'layerTrees',\n\tActionTypes.LAYER_TREES,\n\t'applications'\n);\nconst useKeysClear = common.useKeysClear(ActionTypes.LAYER_TREES);\nconst useIndexedClear = common.useIndexedClear(ActionTypes.LAYER_TREES);\nconst useIndexed = common.useIndexed(\n\tSelect.layerTrees.getSubstate,\n\t'layerTrees',\n\tActionTypes.LAYER_TREES,\n\t'applications'\n);\nconst refreshUses = common.refreshUses(\n\tSelect.layerTrees.getSubstate,\n\t'layerTrees',\n\tActionTypes.LAYER_TREES,\n\t'applications'\n);\nconst updateStateFromView = common.updateSubstateFromView(\n\tActionTypes.LAYER_TREES\n);\n\n// ============ actions ===========\nfunction ensureData(filter, componentId) {\n\treturn dispatch => {\n\t\treturn dispatch(useIndexed(null, filter, null, 1, 100, componentId)).then();\n\t};\n}\n\n// ============ export ===========\n\nexport default {\n\tcreate,\n\tdelete: deleteItem,\n\n\tensureData,\n\n\trefreshUses,\n\n\tsaveEdited,\n\n\tupdateEdited,\n\tupdateStateFromView,\n\tuseIndexed,\n\tuseIndexedClear,\n\tuseKeys,\n\tuseKeysClear,\n};\n","import ActionTypes from '../../constants/ActionTypes';\n\nimport common from '../_common/actions';\nimport Select from '../Select';\n\n// ============ creators ===========\n\nconst add = common.add(ActionTypes.STYLES);\nconst useIndexed = common.useIndexed(\n\tSelect.styles.getSubstate,\n\t'styles',\n\tActionTypes.STYLES\n);\nconst useKeys = common.useKeys(\n\tSelect.styles.getSubstate,\n\t'styles',\n\tActionTypes.STYLES\n);\nconst useKeysClear = common.useKeysClear(ActionTypes.STYLES);\nconst updateStateFromView = common.updateSubstateFromView(ActionTypes.STYLES);\n\n// ============ export ===========\n\n// TODO - common?\nconst updateStateFromViewWithData = view => {\n\treturn (dispatch, getState) => {\n\t\tdispatch(updateStateFromView(view));\n\t\tif (view.data) {\n\t\t\tdispatch(add(view.data));\n\t\t}\n\t};\n};\n\nexport default {\n\tadd,\n\tuseIndexed,\n\tuseKeys,\n\tuseKeysClear,\n\tupdateStateFromView,\n\tupdateStateFromViewWithData,\n};\n","import common from '../_common/actions';\nimport ActionTypes from '../../constants/ActionTypes';\nimport Select from '../Select';\n\nconst add = common.add(ActionTypes.SELECTIONS);\nconst setActiveKey = common.setActiveKey(ActionTypes.SELECTIONS);\nconst updateStateFromView = common.updateSubstateFromView(\n\tActionTypes.SELECTIONS\n);\n\nconst setActiveSelectionFeatureKeysFilterKeys = selectionKeys => {\n\treturn (dispatch, getState) => {\n\t\tlet activeSelectionKey = Select.selections.getActiveKey(getState());\n\t\tif (activeSelectionKey && selectionKeys) {\n\t\t\tdispatch(setFeatureKeysFilterKeys(activeSelectionKey, selectionKeys));\n\t\t}\n\t};\n};\n\nconst updateStateFromViewWithData = view => {\n\treturn (dispatch, getState) => {\n\t\tdispatch(updateStateFromView(view));\n\t\tif (view.data) {\n\t\t\tdispatch(add(view.data));\n\t\t}\n\t};\n};\n\n// ============ actions ===========\nfunction clearFeatureKeysFilter(key) {\n\treturn {\n\t\ttype: ActionTypes.SELECTIONS.CLEAR.FEATURE_KEYS_FILTER,\n\t\tkey,\n\t};\n}\n\nfunction setFeatureKeysFilterKeys(key, featureKeys) {\n\treturn {\n\t\ttype: ActionTypes.SELECTIONS.SET.FEATURE_KEYS_FILTER.KEYS,\n\t\tkey,\n\t\tfeatureKeys,\n\t};\n}\n\nexport default {\n\tadd,\n\tclearFeatureKeysFilter,\n\tsetActiveSelectionFeatureKeysFilterKeys,\n\tsetActiveKey,\n\tupdateStateFromView,\n\tupdateStateFromViewWithData,\n};\n","import {\n\tisMatch as _isMatch,\n\tisNumber as _isNumber,\n\tomitBy as _omitBy,\n\tpickBy as _pickBy,\n\tisEmpty as _isEmpty,\n} from 'lodash';\nimport {map as mapUtils} from '@gisatcz/ptr-utils';\n\nimport ActionTypes from '../../constants/ActionTypes';\nimport Select from '../../state/Select';\nimport commonActions from '../_common/actions';\nimport commonHelpers from '../_common/helpers';\nimport commonSelectors from '../_common/selectors';\n\nimport DataActions from '../Data/actions';\nimport {TILED_VECTOR_LAYER_TYPES} from '../Data/constants';\nimport StylesActions from '../Styles/actions';\n\nimport helpers from './selectorHelpers';\nimport SelectionsAction from '../Selections/actions';\n\n/* ==================================================\n * CREATORS\n * ================================================== */\n\n/**\n * TODO @vlach1989 tests\n * Add layers at the end of map layers list\n * @param mapKey {string}\n * @param layerStates {Array} A collection, where each object represents state of the layer\n */\nconst addMapLayers = (mapKey, layerStates) => {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\tconst map = Select.maps.getMapByKey(state, mapKey);\n\t\tif (map) {\n\t\t\tdispatch(actionAddMapLayers(mapKey, layerStates));\n\t\t\tconst viewport = Select.maps.getViewportByMapKey(state, mapKey);\n\t\t\tif (viewport) {\n\t\t\t\tdispatch(use(mapKey, null, null, viewport.width, viewport.height));\n\t\t\t}\n\t\t} else {\n\t\t\tdispatch(\n\t\t\t\tcommonActions.actionGeneralError(`No map exists for mapKey ${mapKey}`)\n\t\t\t);\n\t\t}\n\t};\n};\n\n/**\n * TODO @vlach1989 tests\n * Add map layer to the specific position in the list\n * @param mapKey {string}\n * @param layerState {Object}\n * @param index {number} position\n */\nconst addMapLayerToIndex = (mapKey, layerState, index) => {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\tconst map = Select.maps.getMapByKey(state, mapKey);\n\t\tif (map) {\n\t\t\tdispatch(actionAddMapLayerToIndex(mapKey, layerState, index));\n\t\t\tconst viewport = Select.maps.getViewportByMapKey(state, mapKey);\n\t\t\tif (viewport) {\n\t\t\t\tdispatch(use(mapKey, null, null, viewport.width, viewport.height));\n\t\t\t}\n\t\t} else {\n\t\t\tdispatch(\n\t\t\t\tcommonActions.actionGeneralError(`No map exists for mapKey ${mapKey}`)\n\t\t\t);\n\t\t}\n\t};\n};\n\n/**\n * Remove layer from map\n * @param mapKey {string}\n * @param layerKey {string}\n */\nconst removeMapLayer = (mapKey, layerKey) => {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\tconst layerState = Select.maps.getLayerStateByLayerKeyAndMapKey(\n\t\t\tstate,\n\t\t\tmapKey,\n\t\t\tlayerKey\n\t\t);\n\t\tif (layerState) {\n\t\t\tdispatch(actionRemoveMapLayer(mapKey, layerKey));\n\t\t} else {\n\t\t\tdispatch(\n\t\t\t\tcommonActions.actionGeneralError(\n\t\t\t\t\t`No layer with key ${layerKey} found for mapKey ${mapKey}`\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t};\n};\n\n/**\n * Clear use of the map set\n * @param mapSetKey {string}\n */\nconst mapSetUseClear = mapSetKey => {\n\treturn (dispatch, getState) => {\n\t\tconst registered = Select.maps.isMapSetInUse(getState(), mapSetKey);\n\t\tif (registered) {\n\t\t\tdispatch(actionMapSetUseClear(mapSetKey));\n\t\t}\n\t};\n};\n\n/**\n * Register use of the map set\n * @param mapSetKey {string}\n */\nconst mapSetUseRegister = mapSetKey => {\n\treturn (dispatch, getState) => {\n\t\tconst alreadyRegistered = Select.maps.isMapSetInUse(getState(), mapSetKey);\n\t\tif (!alreadyRegistered) {\n\t\t\tdispatch(actionMapSetUseRegister(mapSetKey));\n\t\t}\n\t};\n};\n\n/**\n * Clear use of the map\n * @param mapKey {string}\n */\nconst mapUseClear = mapKey => {\n\treturn (dispatch, getState) => {\n\t\tconst registered = Select.maps.isMapInUse(getState(), mapKey);\n\t\tif (registered) {\n\t\t\tdispatch(actionMapUseClear(mapKey));\n\t\t}\n\t};\n};\n\n/**\n * Register use of the map\n * @param mapKey {string}\n */\nconst mapUseRegister = mapKey => {\n\treturn (dispatch, getState) => {\n\t\tconst alreadyRegistered = Select.maps.isMapInUse(getState(), mapKey);\n\t\tif (!alreadyRegistered) {\n\t\t\tdispatch(actionMapUseRegister(mapKey));\n\t\t}\n\t};\n};\n\n/**\n * @param mapKey {string}\n * @param backgroundLayer {Object} background layer definition\n * @param layers {Object} layers definition\n * @param mapWidth {number} width of map component in px\n * @param mapHeight {number} height of map component in px\n */\nfunction use(mapKey, backgroundLayer, layers, mapWidth, mapHeight) {\n\treturn (dispatch, getState) => {\n\t\tdispatch(mapUseRegister(mapKey));\n\t\tconst state = getState();\n\n\t\tconst spatialFilter = Select.maps.getVisibleTilesByMapKey(\n\t\t\tstate,\n\t\t\tmapKey,\n\t\t\tmapWidth,\n\t\t\tmapHeight\n\t\t);\n\t\t//spatial filter is required for now\n\t\tif (!spatialFilter) {\n\t\t\treturn;\n\t\t}\n\t\t// uncontrolled map - the map is not controlled from store, but layer data is collected based on stored metadata.\n\t\tif (backgroundLayer || layers) {\n\t\t\tlayers = helpers.mergeBackgroundLayerWithLayers(layers, backgroundLayer);\n\t\t}\n\t\t// controlled map (with stateMapKey) - the map is completely controlled from store\n\t\telse {\n\t\t\tlayers = Select.maps.getAllLayersStateByMapKey(state, mapKey);\n\t\t}\n\n\t\tif (layers) {\n\t\t\tlayers.forEach(layer => {\n\t\t\t\t// apply layerUse asynchronous on each leyer\n\t\t\t\t// it cause better FPS and prevent long synchronous tasks\n\t\t\t\tif (!layer.type) {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tdispatch(layerUse(layer, spatialFilter));\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n}\n\n/**\n * @param layerState {Object} layer definition\n * @param spatialFilter {{level: number}, {tiles: Array}}\n */\nfunction layerUse(layerState, spatialFilter) {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\n\t\t// modifiers defined by key\n\t\tlet metadataDefinedByKey = layerState.metadataModifiers\n\t\t\t? {...layerState.metadataModifiers}\n\t\t\t: {};\n\n\t\t// add layerTemplate od areaTreeLevelKey\n\t\tif (layerState.layerTemplateKey) {\n\t\t\tmetadataDefinedByKey.layerTemplateKey = layerState.layerTemplateKey;\n\t\t\t// TODO use layerTemplate here?\n\t\t} else if (layerState.areaTreeLevelKey) {\n\t\t\tmetadataDefinedByKey.areaTreeLevelKey = layerState.areaTreeLevelKey;\n\t\t\t// TODO use areaTreeLevelKey here?\n\t\t}\n\n\t\t// Get actual metadata keys defined by filterByActive\n\t\tconst activeMetadataKeys = layerState.filterByActive\n\t\t\t? commonSelectors.getActiveKeysByFilterByActive(\n\t\t\t\t\tstate,\n\t\t\t\t\tlayerState.filterByActive\n\t\t\t  )\n\t\t\t: null;\n\n\t\t// Merge metadata, metadata defined by key have priority\n\t\tconst mergedMetadataKeys = commonHelpers.mergeMetadataKeys(\n\t\t\tmetadataDefinedByKey,\n\t\t\tactiveMetadataKeys\n\t\t);\n\n\t\t// Decouple modifiers from templates\n\t\tconst {\n\t\t\tareaTreeLevelKey,\n\t\t\tlayerTemplateKey,\n\t\t\t...modifiers\n\t\t} = mergedMetadataKeys;\n\n\t\t// It converts modifiers from metadataKeys: [\"A\", \"B\"] to metadataKey: {in: [\"A\", \"B\"]}\n\t\tconst modifiersForRequest = commonHelpers.convertModifiersToRequestFriendlyFormat(\n\t\t\tmodifiers\n\t\t);\n\t\tif (layerTemplateKey || areaTreeLevelKey) {\n\t\t\tlet commonRelationsFilter = {};\n\t\t\tif (areaTreeLevelKey) {\n\t\t\t\tcommonRelationsFilter = {\n\t\t\t\t\t...(modifiersForRequest && {modifiers: modifiersForRequest}),\n\t\t\t\t\tareaTreeLevelKey,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (layerTemplateKey) {\n\t\t\t\tcommonRelationsFilter = {\n\t\t\t\t\t...(modifiersForRequest && {modifiers: modifiersForRequest}),\n\t\t\t\t\tlayerTemplateKey,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (layerTemplateKey) {\n\t\t\t\tconst order = null;\n\t\t\t\tconst spatialDataSources = Select.data.spatialDataSources.getIndexed(\n\t\t\t\t\tstate,\n\t\t\t\t\tcommonRelationsFilter,\n\t\t\t\t\torder\n\t\t\t\t);\n\t\t\t\tconst sdsContainsVector =\n\t\t\t\t\tspatialDataSources?.some(spatialDataSource =>\n\t\t\t\t\t\tTILED_VECTOR_LAYER_TYPES.includes(spatialDataSource?.data?.type)\n\t\t\t\t\t) || false;\n\t\t\t\t// load only dataSources that are supported type\n\t\t\t\tif (spatialDataSources && !sdsContainsVector) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst styleKey = layerState.styleKey || null;\n\n\t\t\t// TODO ensure style here for now\n\t\t\tif (styleKey) {\n\t\t\t\tdispatch(\n\t\t\t\t\tStylesActions.useKeys(\n\t\t\t\t\t\t[layerState.styleKey],\n\t\t\t\t\t\tlayerState.key + '_layerUse'\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tconst attributeDataFilterExtension = {\n\t\t\t\t...(layerState?.options?.attributeFilter && {\n\t\t\t\t\tattributeFilter: layerState.options.attributeFilter,\n\t\t\t\t}),\n\t\t\t\t...(layerState?.options?.dataSourceKeys && {\n\t\t\t\t\tdataSourceKeys: layerState.options.dataSourceKeys,\n\t\t\t\t}),\n\t\t\t\t...(layerState?.options?.featureKeys && {\n\t\t\t\t\tfeatureKeys: layerState.options.featureKeys,\n\t\t\t\t}),\n\t\t\t};\n\n\t\t\tdispatch(\n\t\t\t\tDataActions.ensure(\n\t\t\t\t\tstyleKey,\n\t\t\t\t\tcommonRelationsFilter,\n\t\t\t\t\tspatialFilter,\n\t\t\t\t\tattributeDataFilterExtension\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t};\n}\n\n/**\n * Ensure indexes with filter by active for each active map\n * @param filterByActive {Object}\n */\nfunction ensureWithFilterByActive(filterByActive) {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\tconst activeKeys = commonSelectors.getAllActiveKeys(state);\n\t\tconst mapKeys = Select.maps.getAllMapsInUse(state);\n\n\t\tif (mapKeys && activeKeys) {\n\t\t\tmapKeys.forEach(mapKey => {\n\t\t\t\tconst mapViewport = Select.maps.getViewportByMapKey(state, mapKey);\n\t\t\t\tif (mapViewport) {\n\t\t\t\t\tconst {width, height} = mapViewport;\n\t\t\t\t\tconst spatialFilter = Select.maps.getVisibleTilesByMapKey(\n\t\t\t\t\t\tstate,\n\t\t\t\t\t\tmapKey,\n\t\t\t\t\t\twidth,\n\t\t\t\t\t\theight\n\t\t\t\t\t);\n\n\t\t\t\t\tif (spatialFilter) {\n\t\t\t\t\t\tconst layers = Select.maps.getAllLayersStateByMapKey(state, mapKey);\n\t\t\t\t\t\tif (layers) {\n\t\t\t\t\t\t\tlayers.forEach(layer => {\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tlayer.filterByActive &&\n\t\t\t\t\t\t\t\t\t_isMatch(layer.filterByActive, filterByActive)\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t// apply layerUse asynchronous on each leyer\n\t\t\t\t\t\t\t\t\t// it cause better FPS and prevent long synchronous tasks\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\tdispatch(layerUse(layer, spatialFilter, activeKeys));\n\t\t\t\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n}\n\n/**\n * @param mapKey {string}\n * @param layerKey {string}\n * @param selectedFeatureKeys {Array}\n */\nfunction setLayerSelectedFeatureKeys(mapKey, layerKey, selectedFeatureKeys) {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\tconst layer = Select.maps.getLayerStateByLayerKeyAndMapKey(\n\t\t\tstate,\n\t\t\tmapKey,\n\t\t\tlayerKey\n\t\t);\n\t\tif (layer?.options?.selectable) {\n\t\t\tconst activeSelectionKey = Select.selections.getActiveKey(state);\n\t\t\tif (\n\t\t\t\tactiveSelectionKey &&\n\t\t\t\tlayer.options.selected?.hasOwnProperty(activeSelectionKey)\n\t\t\t) {\n\t\t\t\t// TODO possible conflicts if features with same key from different layers are selected\n\t\t\t\tdispatch(\n\t\t\t\t\tSelectionsAction.setActiveSelectionFeatureKeysFilterKeys(\n\t\t\t\t\t\tselectedFeatureKeys\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\t// TODO what if there is no active selection?\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param mapKey {string}\n * @param layerKey {string}\n * @param styleKey {string}\n */\nfunction setMapLayerStyleKey(mapKey, layerKey, styleKey) {\n\treturn (dispatch, getState) => {\n\t\tconst layer = Select.maps.getLayerStateByLayerKeyAndMapKey(\n\t\t\tgetState(),\n\t\t\tmapKey,\n\t\t\tlayerKey\n\t\t);\n\t\tif (layer) {\n\t\t\tdispatch(actionSetMapLayerStyleKey(mapKey, layerKey, styleKey));\n\t\t}\n\t};\n}\n\n/**\n * Set map layer option\n * @param mapKey {string}\n * @param layerKey {string}\n * @param optionKey {string}\n * @param optionValue {*}\n */\nfunction setMapLayerOption(mapKey, layerKey, optionKey, optionValue) {\n\treturn (dispatch, getState) => {\n\t\tconst layer = Select.maps.getLayerStateByLayerKeyAndMapKey(\n\t\t\tgetState(),\n\t\t\tmapKey,\n\t\t\tlayerKey\n\t\t);\n\t\tif (layer) {\n\t\t\tdispatch(\n\t\t\t\tactionSetMapLayerOption(mapKey, layerKey, optionKey, optionValue)\n\t\t\t);\n\t\t} else {\n\t\t\tdispatch(\n\t\t\t\tcommonActions.actionGeneralError(\n\t\t\t\t\t`No layer found for mapKey ${mapKey} and layerKey ${layerKey}`\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t};\n}\n\n/**\n * @param mapKey {string}\n */\nfunction setMapSetActiveMapKey(mapKey) {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\tconst set = Select.maps.getMapSetByMapKey(state, mapKey);\n\t\tif (set) {\n\t\t\tconst activeMapKey = Select.maps.getMapSetActiveMapKey(state, set.key);\n\t\t\tif (activeMapKey !== mapKey) {\n\t\t\t\tdispatch(actionSetMapSetActiveMapKey(set.key, mapKey));\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param setKey {string}\n * @param backgroundLayer {Object} background layer definition\n */\nfunction setMapSetBackgroundLayer(setKey, backgroundLayer) {\n\treturn (dispatch, getState) => {\n\t\tdispatch(actionSetMapSetBackgroundLayer(setKey, backgroundLayer));\n\t\tconst maps = Select.maps.getMapSetMaps(getState(), setKey);\n\t\tif (maps) {\n\t\t\tmaps.forEach(map => {\n\t\t\t\t// TODO is viewport always defined?\n\t\t\t\tdispatch(\n\t\t\t\t\tuse(\n\t\t\t\t\t\tmap.key,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tmap?.data?.viewport?.width,\n\t\t\t\t\t\tmap?.data?.viewport?.height\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t};\n}\n\n/**\n * Set background layer for map.\n * @param mapKey {string}\n * @param backgroundLayer {Object} background layer definition\n */\nfunction setMapBackgroundLayer(mapKey, backgroundLayer) {\n\treturn (dispatch, getState) => {\n\t\tconst map = Select.maps.getMapByKey(getState(), mapKey);\n\t\tif (map) {\n\t\t\tdispatch(actionSetMapBackgroundLayer(mapKey, backgroundLayer));\n\n\t\t\t// Call use action only on state controlled layers\n\t\t\tif (!backgroundLayer.type) {\n\t\t\t\tconst backgroundLayerState = Select.maps.getMapBackgroundLayerStateByMapKey(\n\t\t\t\t\tgetState(),\n\t\t\t\t\tmapKey\n\t\t\t\t);\n\n\t\t\t\tconst spatialFilter = Select.maps.getVisibleTilesByMapKey(\n\t\t\t\t\tgetState(),\n\t\t\t\t\tmapKey,\n\t\t\t\t\tmap?.data?.viewport?.width,\n\t\t\t\t\tmap?.data?.viewport?.height\n\t\t\t\t);\n\t\t\t\t//spatial filter is required for now\n\t\t\t\tif (!spatialFilter || !backgroundLayerState) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tdispatch(layerUse(backgroundLayerState, spatialFilter));\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * TODO @vlach1989 test\n * @param setKey {string}\n * @param layers {Array} layers definitions\n */\nfunction setMapSetLayers(setKey, layers) {\n\treturn (dispatch, getState) => {\n\t\tconst set = Select.maps.getMapSetByKey(getState(), setKey);\n\t\tif (set) {\n\t\t\tdispatch(actionSetMapSetLayers(setKey, layers));\n\t\t\tconst maps = Select.maps.getMapSetMaps(getState(), setKey);\n\t\t\tif (maps) {\n\t\t\t\tmaps.forEach(map => {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tuse(\n\t\t\t\t\t\t\tmap.key,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tmap?.data?.viewport?.width,\n\t\t\t\t\t\t\tmap?.data?.viewport?.height\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tdispatch(\n\t\t\t\tcommonActions.actionGeneralError(`No set exists for setKey ${setKey}`)\n\t\t\t);\n\t\t}\n\t};\n}\n\n/**\n * @param setKey {string}\n */\nfunction refreshMapSetUse(setKey) {\n\treturn (dispatch, getState) => {\n\t\tconst maps = Select.maps.getMapSetMaps(getState(), setKey);\n\t\tif (maps) {\n\t\t\tmaps.forEach(map => {\n\t\t\t\t// TODO is viewport always defined?\n\t\t\t\tdispatch(\n\t\t\t\t\tuse(\n\t\t\t\t\t\tmap.key,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tmap?.data?.viewport?.width,\n\t\t\t\t\t\tmap?.data?.viewport?.height\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t};\n}\n\n/**\n * @param setKey {string}\n * @param mapKey {string}\n */\nfunction removeMapFromSet(setKey, mapKey) {\n\treturn (dispatch, getState) => {\n\t\tconst state = getState();\n\t\tconst mapSetMapKeys = Select.maps.getMapSetMapKeys(state, setKey);\n\t\tif (mapSetMapKeys && mapSetMapKeys.includes(mapKey)) {\n\t\t\tconst activeMapKey = Select.maps.getMapSetActiveMapKey(state, setKey);\n\t\t\tdispatch(actionRemoveMapFromSet(setKey, mapKey));\n\n\t\t\t// if map to remove is active at the same time\n\t\t\tif (activeMapKey === mapKey) {\n\t\t\t\t// check map set map keys again & set first map as active\n\t\t\t\tconst mapSetMapKeys = Select.maps.getMapSetMapKeys(getState(), setKey);\n\t\t\t\tif (!_isEmpty(mapSetMapKeys)) {\n\t\t\t\t\tdispatch(actionSetMapSetActiveMapKey(setKey, mapSetMapKeys[0]));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param mapKey {string}\n * @param update {Object} map view fragment\n */\nfunction updateMapAndSetView(mapKey, update) {\n\treturn (dispatch, getState) => {\n\t\tconst set = Select.maps.getMapSetByMapKey(getState(), mapKey);\n\t\tlet forSet, forMap;\n\t\tconst map = Select.maps.getMapByKey(getState(), mapKey);\n\t\tif (set && set.sync && map) {\n\t\t\t// pick key-value pairs that are synced for set\n\t\t\tforSet = _pickBy(update, (updateVal, updateKey) => {\n\t\t\t\treturn set.sync[updateKey];\n\t\t\t});\n\n\t\t\tforMap = _omitBy(update, (updateVal, updateKey) => {\n\t\t\t\treturn set.sync[updateKey];\n\t\t\t});\n\t\t} else if (map) {\n\t\t\tforMap = update;\n\t\t}\n\n\t\tif (forSet && !_isEmpty(forSet)) {\n\t\t\t//check data integrity\n\t\t\tforSet = mapUtils.view.ensureViewIntegrity(forSet); //TODO test\n\t\t\tdispatch(actionUpdateSetView(set.key, forSet));\n\t\t}\n\n\t\tif (forMap && !_isEmpty(forMap)) {\n\t\t\t//check data integrity\n\t\t\tforMap = mapUtils.view.ensureViewIntegrity(forMap); //TODO test\n\t\t\tdispatch(actionUpdateMapView(mapKey, forMap));\n\t\t}\n\t};\n}\n\n/**\n * @param setKey {string}\n * @param update {Object} map view fragment\n */\nfunction updateSetView(setKey, update) {\n\treturn (dispatch, getState) => {\n\t\tlet activeMapKey = Select.maps.getMapSetActiveMapKey(getState(), setKey);\n\t\tif (activeMapKey) {\n\t\t\tdispatch(updateMapAndSetView(activeMapKey, update));\n\t\t}\n\t};\n}\n\n/**\n * Update whole maps state from view definition\n * @param data {Object}\n */\nfunction updateStateFromView(data) {\n\treturn dispatch => {\n\t\tif (data) {\n\t\t\tdispatch(actionUpdate(data));\n\t\t}\n\t};\n}\n\nfunction setMapViewport(mapKey, width, height) {\n\treturn (dispatch, getState) => {\n\t\tif (mapKey && _isNumber(width) && _isNumber(height)) {\n\t\t\tconst state = getState();\n\t\t\tconst existingMap = Select.maps.getMapByKey(state, mapKey);\n\t\t\tconst currentViewport = Select.maps.getViewportByMapKey(state, mapKey);\n\t\t\tif (\n\t\t\t\texistingMap &&\n\t\t\t\t(!currentViewport ||\n\t\t\t\t\tcurrentViewport?.width !== width ||\n\t\t\t\t\tcurrentViewport?.height !== height)\n\t\t\t) {\n\t\t\t\tdispatch(actionSetMapViewport(mapKey, width, height));\n\t\t\t}\n\t\t}\n\t};\n}\n\n/* ==================================================\n * ACTIONS\n * ================================================== */\n\nconst actionAddMapLayers = (mapKey, layerStates) => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.MAP.LAYERS.ADD,\n\t\tmapKey,\n\t\tlayerStates,\n\t};\n};\n\nconst actionAddMapLayerToIndex = (mapKey, layerState, index) => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.MAP.LAYERS.ADD_TO_INDEX,\n\t\tmapKey,\n\t\tlayerState,\n\t\tindex,\n\t};\n};\n\nconst actionRemoveMapLayer = (mapKey, layerKey) => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.MAP.LAYERS.REMOVE_LAYER,\n\t\tmapKey,\n\t\tlayerKey,\n\t};\n};\n\nconst actionRemoveMapFromSet = (setKey, mapKey) => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.SET.REMOVE_MAP,\n\t\tsetKey,\n\t\tmapKey,\n\t};\n};\n\nconst actionSetActiveMapKey = mapKey => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.SET_ACTIVE_MAP_KEY,\n\t\tmapKey,\n\t};\n};\n\nconst actionSetMapLayerOption = (mapKey, layerKey, optionKey, optionValue) => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.MAP.LAYERS.SET_OPTION,\n\t\tmapKey,\n\t\tlayerKey,\n\t\toptionKey,\n\t\toptionValue,\n\t};\n};\n\nconst actionSetMapLayerStyleKey = (mapKey, layerKey, styleKey) => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.MAP.LAYERS.SET_STYLE_KEY,\n\t\tmapKey,\n\t\tlayerKey,\n\t\tstyleKey,\n\t};\n};\n\nconst actionSetMapSetActiveMapKey = (setKey, mapKey) => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.SET.SET_ACTIVE_MAP_KEY,\n\t\tmapKey,\n\t\tsetKey,\n\t};\n};\n\nconst actionSetMapSetBackgroundLayer = (setKey, backgroundLayer) => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.SET.SET_BACKGROUND_LAYER,\n\t\tsetKey,\n\t\tbackgroundLayer,\n\t};\n};\n\nconst actionSetMapBackgroundLayer = (mapKey, backgroundLayer) => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.MAP.SET_BACKGROUND_LAYER,\n\t\tmapKey,\n\t\tbackgroundLayer,\n\t};\n};\n\nconst actionSetMapSetLayers = (setKey, layers) => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.SET.SET_LAYERS,\n\t\tsetKey,\n\t\tlayers,\n\t};\n};\n\nconst actionSetMapViewport = (mapKey, width, height) => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.MAP.VIEWPORT.SET,\n\t\tmapKey,\n\t\twidth,\n\t\theight,\n\t};\n};\n\nconst actionUpdate = data => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.UPDATE,\n\t\tdata,\n\t};\n};\n\nconst actionUpdateMapView = (mapKey, update) => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.MAP.VIEW.UPDATE,\n\t\tmapKey,\n\t\tupdate,\n\t};\n};\n\nconst actionUpdateSetView = (setKey, update) => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.SET.VIEW.UPDATE,\n\t\tsetKey,\n\t\tupdate,\n\t};\n};\n\nconst actionMapSetUseClear = mapSetKey => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.SET.USE.CLEAR,\n\t\tmapSetKey,\n\t};\n};\n\nconst actionMapSetUseRegister = mapSetKey => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.SET.USE.REGISTER,\n\t\tmapSetKey,\n\t};\n};\n\nconst actionMapUseClear = mapKey => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.MAP.USE.CLEAR,\n\t\tmapKey,\n\t};\n};\n\nconst actionMapUseRegister = mapKey => {\n\treturn {\n\t\ttype: ActionTypes.MAPS.MAP.USE.REGISTER,\n\t\tmapKey,\n\t};\n};\n\n// ============ export ===========\nexport default {\n\taddMapLayers,\n\taddMapLayerToIndex,\n\tensureWithFilterByActive,\n\tlayerUse,\n\tmapSetUseClear,\n\tmapSetUseRegister,\n\tmapUseClear,\n\tmapUseRegister,\n\trefreshMapSetUse,\n\tremoveMapFromSet,\n\tremoveMapLayer,\n\tsetActiveMapKey: actionSetActiveMapKey,\n\tsetLayerSelectedFeatureKeys,\n\tsetMapLayerOption,\n\tsetMapLayerStyleKey,\n\tsetMapSetActiveMapKey,\n\tsetMapBackgroundLayer,\n\tsetMapSetBackgroundLayer,\n\tsetMapSetLayers,\n\tsetMapViewport,\n\tupdateMapAndSetView,\n\tupdateSetView,\n\tupdateStateFromView,\n\tuse,\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common from '../_common/actions';\nimport Select from '../Select';\n\n// ============ creators ===========\n\nconst add = common.add(ActionTypes.PERIODS);\nconst create = common.create(\n\tSelect.periods.getSubstate,\n\t'periods',\n\tActionTypes.PERIODS\n);\nconst deleteItem = common.delete(\n\tSelect.periods.getSubstate,\n\t'periods',\n\tActionTypes.PERIODS\n);\nconst saveEdited = common.saveEdited(\n\tSelect.periods.getSubstate,\n\t'periods',\n\tActionTypes.PERIODS\n);\nconst setActiveKey = common.setActiveKey(ActionTypes.PERIODS);\nconst setActiveKeys = common.setActiveKeys(ActionTypes.PERIODS);\nconst updateEdited = common.updateEdited(\n\tSelect.periods.getSubstate,\n\tActionTypes.PERIODS\n);\nconst updateStateFromView = common.updateSubstateFromView(ActionTypes.PERIODS);\nconst useKeys = common.useKeys(\n\tSelect.periods.getSubstate,\n\t'periods',\n\tActionTypes.PERIODS\n);\nconst useKeysClear = common.useKeysClear(ActionTypes.PERIODS);\nconst useIndexed = common.useIndexed(\n\tSelect.periods.getSubstate,\n\t'periods',\n\tActionTypes.PERIODS\n);\nconst useIndexedClear = common.useIndexedClear(ActionTypes.PERIODS);\nconst refreshUses = common.refreshUses(\n\tSelect.periods.getSubstate,\n\t`periods`,\n\tActionTypes.PERIODS\n);\nconst setActiveKeyAndEnsureDependencies = key => {\n\treturn (dispatch, getState, options) => {\n\t\tdispatch(setActiveKey(key));\n\t\tdispatch(options.ensureDependenciesOfActiveMetadataType('period'));\n\t};\n};\n\nconst setActiveKeysAndEnsureDependencies = keys => {\n\treturn (dispatch, getState, options) => {\n\t\tdispatch(setActiveKeys(keys));\n\t\tdispatch(options.ensureDependenciesOfActiveMetadataType('period'));\n\t};\n};\n\n// ============ actions ===========\n\n// ============ export ===========\n\nexport default {\n\tadd,\n\tcreate,\n\tdelete: deleteItem,\n\n\trefreshUses,\n\n\tsaveEdited,\n\tsetActiveKey: setActiveKeyAndEnsureDependencies,\n\tsetActiveKeys: setActiveKeysAndEnsureDependencies,\n\n\tupdateEdited,\n\tupdateStateFromView,\n\tuseIndexed,\n\tuseIndexedClear,\n\tuseKeys,\n\tuseKeysClear,\n};\n","import ActionTypes from '../../constants/ActionTypes';\n\nimport common from '../_common/actions';\nimport Select from '../Select';\n\n// ============ creators ===========\n\nconst add = common.add(ActionTypes.PLACES);\nconst create = common.create(\n\tSelect.places.getSubstate,\n\t'places',\n\tActionTypes.PLACES\n);\nconst deleteItem = common.delete(\n\tSelect.places.getSubstate,\n\t'places',\n\tActionTypes.PLACES\n);\nconst saveEdited = common.saveEdited(\n\tSelect.places.getSubstate,\n\t'places',\n\tActionTypes.PLACES\n);\nconst setActiveKey = common.setActiveKey(ActionTypes.PLACES);\nconst setActiveKeys = common.setActiveKeys(ActionTypes.PLACES);\nconst updateEdited = common.updateEdited(\n\tSelect.places.getSubstate,\n\tActionTypes.PLACES\n);\nconst updateStateFromView = common.updateSubstateFromView(ActionTypes.PLACES);\nconst useIndexed = common.useIndexed(\n\tSelect.places.getSubstate,\n\t'places',\n\tActionTypes.PLACES\n);\nconst useIndexedClear = common.useIndexedClear(ActionTypes.PLACES);\nconst useKeys = common.useKeys(\n\tSelect.places.getSubstate,\n\t'places',\n\tActionTypes.PLACES\n);\nconst useKeysClear = common.useKeysClear(ActionTypes.PLACES);\nconst refreshUses = common.refreshUses(\n\tSelect.places.getSubstate,\n\t`places`,\n\tActionTypes.PLACES\n);\nconst setActiveKeyAndEnsureDependencies = key => {\n\treturn (dispatch, getState, options) => {\n\t\tdispatch(setActiveKey(key));\n\t\tdispatch(options.ensureDependenciesOfActiveMetadataType('place'));\n\t};\n};\n\nconst setActiveKeysAndEnsureDependencies = keys => {\n\treturn (dispatch, getState, options) => {\n\t\tdispatch(setActiveKeys(keys));\n\t\tdispatch(options.ensureDependenciesOfActiveMetadataType('place'));\n\t};\n};\n\n// ============ export ===========\n\nexport default {\n\tadd,\n\tcreate,\n\tdelete: deleteItem,\n\trefreshUses,\n\n\tsaveEdited,\n\tsetActiveKey: setActiveKeyAndEnsureDependencies,\n\tsetActiveKeys: setActiveKeysAndEnsureDependencies,\n\n\tupdateEdited,\n\tupdateStateFromView,\n\tuseIndexed,\n\tuseIndexedClear,\n\tuseKeys,\n\tuseKeysClear,\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common from '../_common/actions';\n\n// ============ creators ===========\n\nconst add = common.add(ActionTypes.SCENARIOS);\nconst setActiveKey = common.setActiveKey(ActionTypes.SCENARIOS);\nconst setActiveKeys = common.setActiveKeys(ActionTypes.SCENARIOS);\nconst updateStateFromView = common.updateSubstateFromView(\n\tActionTypes.SCENARIOS\n);\n\nconst setActiveKeyAndEnsureDependencies = key => {\n\treturn (dispatch, getState, options) => {\n\t\tdispatch(setActiveKey(key));\n\t\tdispatch(options.ensureDependenciesOfActiveMetadataType('scenario'));\n\t};\n};\n\nconst setActiveKeysAndEnsureDependencies = keys => {\n\treturn (dispatch, getState, options) => {\n\t\tdispatch(setActiveKeys(keys));\n\t\tdispatch(options.ensureDependenciesOfActiveMetadataType('scenario'));\n\t};\n};\n\n// ============ export ===========\n\nexport default {\n\tadd,\n\tsetActiveKey: setActiveKeyAndEnsureDependencies,\n\tsetActiveKeys: setActiveKeysAndEnsureDependencies,\n\tupdateStateFromView,\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport Select from '../Select';\nimport common from '../_common/actions';\nimport _ from 'lodash';\n\n// ============ creators ===========\n\nconst add = common.add(ActionTypes.SCOPES);\nconst create = common.create(\n\tSelect.scopes.getSubstate,\n\t'scopes',\n\tActionTypes.SCOPES\n);\nconst deleteItem = common.delete(\n\tSelect.scopes.getSubstate,\n\t'scopes',\n\tActionTypes.SCOPES\n);\nconst saveEdited = common.saveEdited(\n\tSelect.scopes.getSubstate,\n\t'scopes',\n\tActionTypes.SCOPES\n);\nconst setActiveKey = common.setActiveKey(ActionTypes.SCOPES);\n\nconst updateEdited = common.updateEdited(\n\tSelect.scopes.getSubstate,\n\tActionTypes.SCOPES\n);\nconst useKeys = common.useKeys(\n\tSelect.scopes.getSubstate,\n\t'scopes',\n\tActionTypes.SCOPES\n);\nconst useKeysClear = common.useKeysClear(ActionTypes.SCOPES);\nconst useIndexedClear = common.useIndexedClear(ActionTypes.SCOPES);\nconst useIndexed = common.useIndexed(\n\tSelect.scopes.getSubstate,\n\t'scopes',\n\tActionTypes.SCOPES\n);\nconst refreshUses = common.refreshUses(\n\tSelect.scopes.getSubstate,\n\t`scopes`,\n\tActionTypes.SCOPES\n);\n\nconst setActiveKeyAndEnsureDependencies = key => {\n\treturn (dispatch, getState, options) => {\n\t\tdispatch(setActiveKey(key));\n\t\tdispatch(options.ensureDependenciesOfActiveMetadataType('scope'));\n\t};\n};\n\nfunction updateStateFromView(data) {\n\treturn dispatch => {\n\t\tif (data) {\n\t\t\tif (data && data.byKey) {\n\t\t\t\tdispatch(add(_.values(data.byKey)));\n\t\t\t}\n\n\t\t\tif (data && data.activeKey) {\n\t\t\t\tdispatch(setActiveKeyAndEnsureDependencies(data.activeKey));\n\t\t\t}\n\t\t}\n\t};\n}\n\n// ============ actions ===========\n\n// ============ export ===========\n\nexport default {\n\tadd,\n\tcreate,\n\tdelete: deleteItem,\n\n\trefreshUses,\n\n\tsaveEdited,\n\tsetActiveKey: setActiveKeyAndEnsureDependencies,\n\n\tupdateEdited,\n\tupdateStateFromView,\n\tuseIndexed,\n\tuseIndexedClear,\n\tuseKeys,\n\tuseKeysClear,\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport Select from '../Select';\n\nlet timeouts = {};\n\n// ============ creators ===========\nfunction addOrUpdate(setKey, lineage, width, minActiveWidth, component, props) {\n\treturn (dispatch, getState) => {\n\t\tlet existingScreen = Select.screens.getScreenByLineage(getState(), lineage);\n\n\t\tif (existingScreen) {\n\t\t\tif (timeouts[lineage]) {\n\t\t\t\tclearTimeout(timeouts[lineage]);\n\t\t\t}\n\t\t\tdispatch(\n\t\t\t\tactionUpdate(setKey, lineage, {\n\t\t\t\t\twidth,\n\t\t\t\t\tminActiveWidth,\n\t\t\t\t\tdesiredState: 'opening',\n\t\t\t\t\tcomponent,\n\t\t\t\t\tprops,\n\t\t\t\t})\n\t\t\t);\n\t\t} else {\n\t\t\tdispatch(\n\t\t\t\tactionAdd(setKey, lineage, {\n\t\t\t\t\twidth,\n\t\t\t\t\tminActiveWidth,\n\t\t\t\t\tdesiredState: 'opening',\n\t\t\t\t\tcomponent,\n\t\t\t\t\tprops,\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t\t// TODO timeout is necessary to actually trigger associated selectors twice\n\t\tsetTimeout(() => {\n\t\t\tdispatch(open(setKey, lineage));\n\t\t}, 1);\n\t};\n}\n\nfunction ensureSet(setKey) {\n\treturn (dispatch, getState) => {\n\t\tlet existingSet = Select.screens.getSetByKey(getState(), setKey);\n\t\tif (!existingSet) {\n\t\t\tdispatch(actionAddSet(setKey));\n\t\t}\n\t};\n}\n\nfunction open(setKey, screenLineage) {\n\treturn (dispatch, getState) => {\n\t\tif (screenLineage !== 'base') {\n\t\t\tdispatch(actionOpen(setKey, screenLineage));\n\t\t}\n\t\tdispatch(actionTopHistory(setKey, screenLineage));\n\t};\n}\n\nfunction close(setKey, screenLineage) {\n\treturn (dispatch, getState) => {\n\t\tdispatch(actionClose(setKey, screenLineage));\n\t\tdispatch(actionTopHistory(setKey, screenLineage));\n\n\t\ttimeouts[screenLineage] = setTimeout(() => {\n\t\t\tdispatch(actionRemove(setKey, screenLineage));\n\t\t}, 550);\n\t};\n}\n\nfunction removeAllScreensFromSet(setKey) {\n\treturn dispatch => {\n\t\tdispatch(actionRemoveAllScreensFromSet(setKey));\n\t};\n}\n\nfunction retract(setKey, screenLineage) {\n\treturn (dispatch, getState) => {\n\t\tdispatch(actionRetract(setKey, screenLineage));\n\t\tdispatch(actionTopHistory(setKey, screenLineage));\n\t};\n}\n\nfunction topHistory(setKey, screenLineage) {\n\treturn dispatch => {\n\t\tdispatch(ensureSet(setKey));\n\t\tdispatch(actionTopHistory(setKey, screenLineage));\n\t};\n}\n\n// ============ actions ===========\nconst actionAdd = (setKey, lineage, data) => {\n\treturn {\n\t\ttype: ActionTypes.SCREENS.ADD,\n\t\tsetKey,\n\t\tlineage,\n\t\tdata,\n\t};\n};\n\nconst actionAddSet = setKey => {\n\treturn {\n\t\ttype: ActionTypes.SCREENS.SETS.ADD,\n\t\tsetKey,\n\t};\n};\n\nconst actionOpen = (setKey, lineage) => {\n\treturn {\n\t\ttype: ActionTypes.SCREENS.OPEN,\n\t\tsetKey,\n\t\tlineage,\n\t};\n};\n\nconst actionClose = (setKey, lineage) => {\n\treturn {\n\t\ttype: ActionTypes.SCREENS.CLOSE,\n\t\tsetKey,\n\t\tlineage,\n\t};\n};\n\nconst actionRemove = (setKey, lineage) => {\n\treturn {\n\t\ttype: ActionTypes.SCREENS.REMOVE,\n\t\tsetKey,\n\t\tlineage,\n\t};\n};\n\nconst actionRemoveAllScreensFromSet = setKey => {\n\treturn {\n\t\ttype: ActionTypes.SCREENS.REMOVE_ALL,\n\t\tsetKey,\n\t};\n};\n\nconst actionRetract = (setKey, lineage) => {\n\treturn {\n\t\ttype: ActionTypes.SCREENS.RETRACT,\n\t\tsetKey,\n\t\tlineage,\n\t};\n};\n\nconst actionTopHistory = (setKey, lineage) => {\n\treturn {\n\t\ttype: ActionTypes.SCREENS.TOP_HISTORY,\n\t\tsetKey,\n\t\tlineage,\n\t};\n};\n\nconst actionUpdate = (setKey, lineage, data) => {\n\treturn {\n\t\ttype: ActionTypes.SCREENS.UPDATE,\n\t\tsetKey,\n\t\tlineage,\n\t\tdata,\n\t};\n};\n\n// ============ export ===========\n\nexport default {\n\taddOrUpdate,\n\taddSet: actionAddSet,\n\tclose,\n\topen,\n\tremoveAllScreensFromSet,\n\tretract,\n\ttopHistory,\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport Select from '../Select';\n\nimport common from '../_common/actions';\n\n// ============ creators ===========\n\nconst create = common.create(Select.tags.getSubstate, 'tags', ActionTypes.TAGS);\nconst deleteItem = common.delete(\n\tSelect.tags.getSubstate,\n\t'tags',\n\tActionTypes.TAGS\n);\nconst saveEdited = common.saveEdited(\n\tSelect.tags.getSubstate,\n\t'tags',\n\tActionTypes.TAGS\n);\nconst updateEdited = common.updateEdited(\n\tSelect.tags.getSubstate,\n\tActionTypes.TAGS\n);\nconst useKeys = common.useKeys(\n\tSelect.tags.getSubstate,\n\t'tags',\n\tActionTypes.TAGS\n);\nconst useKeysClear = common.useKeysClear(ActionTypes.TAGS);\nconst useIndexedClear = common.useIndexedClear(ActionTypes.TAGS);\nconst useIndexed = common.useIndexed(\n\tSelect.tags.getSubstate,\n\t'tags',\n\tActionTypes.TAGS\n);\nconst refreshUses = common.refreshUses(\n\tSelect.tags.getSubstate,\n\t`tags`,\n\tActionTypes.TAGS\n);\n\n// ============ actions ===========\n\n// ============ export ===========\n\nexport default {\n\tcreate,\n\tdelete: deleteItem,\n\tsaveEdited,\n\tupdateEdited,\n\tuseKeys,\n\tuseKeysClear,\n\trefreshUses,\n\tuseIndexed,\n\tuseIndexedClear,\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport _ from 'lodash';\nimport path from 'path';\nimport fetch from 'isomorphic-fetch';\n\nimport request from '../_common/request';\n\nimport common from '../_common/actions';\nimport Select from '../Select';\n\nimport ScopesAction from '../Scopes/actions';\nimport PlacesAction from '../Places/actions';\nimport PeriodsAction from '../Periods/actions';\n\nconst TTL = 5;\n\n// ============ creators ===========\n\nconst add = common.add(ActionTypes.USERS);\nconst setActiveKey = common.setActiveKey(ActionTypes.USERS);\nconst refreshUses = () => dispatch => {\n\tdispatch(\n\t\tcommon.refreshUses(\n\t\t\tSelect.users.getSubstate,\n\t\t\t'users',\n\t\t\tActionTypes.USERS,\n\t\t\t'user'\n\t\t)()\n\t);\n\tdispatch(\n\t\tcommon.refreshUses(\n\t\t\tSelect.users.getGroupsSubstate,\n\t\t\t'groups',\n\t\t\tActionTypes.USERS.GROUPS,\n\t\t\t'user'\n\t\t)()\n\t);\n};\nconst useKeys = common.useKeys(\n\tSelect.users.getSubstate,\n\t'users',\n\tActionTypes.USERS,\n\t'user'\n);\nconst useKeysClear = common.useKeysClear(ActionTypes.USERS);\nconst useIndexedUsers = common.useIndexed(\n\tSelect.users.getSubstate,\n\t'users',\n\tActionTypes.USERS,\n\t'user'\n);\nconst useIndexedGroups = common.useIndexed(\n\tSelect.users.getGroupsSubstate,\n\t'groups',\n\tActionTypes.USERS.GROUPS,\n\t'user'\n);\n\nfunction onLogin() {\n\treturn dispatch => {\n\t\tdispatch(common.actionDataSetOutdated());\n\t\tdispatch(apiLoadCurrentUser());\n\n\t\tdispatch(ScopesAction.refreshUses());\n\t\tdispatch(PlacesAction.refreshUses());\n\t\tdispatch(PeriodsAction.refreshUses());\n\t\tdispatch(refreshUses());\n\t};\n}\n\nfunction onLogout() {\n\treturn dispatch => {\n\t\tdispatch(actionLogout());\n\t\tdispatch(setActiveKey(null));\n\n\t\tdispatch(ScopesAction.refreshUses());\n\t\tdispatch(PlacesAction.refreshUses());\n\t\tdispatch(PeriodsAction.refreshUses());\n\t\tdispatch(refreshUses());\n\t};\n}\n\nfunction apiLoginUser(email, password) {\n\treturn (dispatch, getState) => {\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(getState());\n\t\tdispatch(actionApiLoginRequest());\n\n\t\tlet payload = {\n\t\t\tusername: email,\n\t\t\tpassword: password,\n\t\t};\n\n\t\treturn request(localConfig, 'api/login/login', 'POST', null, payload)\n\t\t\t.then(result => {\n\t\t\t\tif (result.data.status === 'ok') {\n\t\t\t\t\tdispatch(onLogin());\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tdispatch(common.actionGeneralError(error));\n\t\t\t\treturn error;\n\t\t\t});\n\t};\n}\n\n// function apiLoad(ttl) {\n// \tif (_.isUndefined(ttl)) ttl = TTL;\n// \treturn (dispatch, getState) => {\n// \t\tlet state = getState();\n// \t\tif (state.users.loading) {\n// \t\t\t// already loading, do nothing\n// \t\t} else {\n// \t\t\tdispatch(actionApiLoadRequest());\n//\n// \t\t\tlet url = config.apiBackendProtocol + '://' + path.join(config.apiBackendHost, 'backend/rest/user');\n//\n// \t\t\treturn fetch(url, {\n// \t\t\t\tmethod: 'GET',\n// \t\t\t\tcredentials: 'include',\n// \t\t\t\theaders: {\n// \t\t\t\t\t'Content-Type': 'application/json',\n// \t\t\t\t\t'Accept': 'application/json'\n// \t\t\t\t}\n// \t\t\t}).then(\n// \t\t\t\tresponse => {\n// \t\t\t\t\tlet contentType = response.headers.get('Content-type');\n// \t\t\t\t\tif (response.ok && contentType && (contentType.indexOf('application/json') !== -1)) {\n// \t\t\t\t\t\treturn response.json().then(data => {\n// \t\t\t\t\t\t\tPromise.all(data.data.map(user => {\n// \t\t\t\t\t\t\t\treturn new User({data: user}).then(user => {\n// \t\t\t\t\t\t\t\t\tuser.key = user.id;\n// \t\t\t\t\t\t\t\t\treturn user;\n// \t\t\t\t\t\t\t\t});\n// \t\t\t\t\t\t\t})).then(users => {\n// \t\t\t\t\t\t\t\tdispatch(actionAdd(users));\n// \t\t\t\t\t\t\t});\n// \t\t\t\t\t\t});\n// \t\t\t\t\t} else {\n// \t\t\t\t\t\tdispatch(actionApiLoadRequestError('scopes#action Problem with loading scopes.'));\n// \t\t\t\t\t}\n// \t\t\t\t},\n// \t\t\t\terror => {\n// \t\t\t\t\tif (ttl - 1) {\n// \t\t\t\t\t\tdispatch(apiLoad(ttl - 1));\n// \t\t\t\t\t} else {\n// \t\t\t\t\t\tdispatch(actionApiLoadRequestError('scopes#action Problem with loading scopes.'));\n// \t\t\t\t\t}\n// \t\t\t\t}\n// \t\t\t);\n// \t\t}\n// \t};\n// }\n\nfunction apiLoadCurrentUser() {\n\treturn (dispatch, getState) => {\n\t\tconst localConfig = Select.app.getCompleteLocalConfiguration(getState());\n\t\tdispatch(actionApiLoadCurrentUserRequest());\n\n\t\treturn request(localConfig, 'rest/user/current', 'GET', null, null)\n\t\t\t.then(result => {\n\t\t\t\tif (result.errors) {\n\t\t\t\t\t//todo how do we return errors here?\n\t\t\t\t\tthrow new Error(result.errors);\n\t\t\t\t} else {\n\t\t\t\t\tif (result.key === 0) {\n\t\t\t\t\t\t// no logged in user = guest\n\t\t\t\t\t\tdispatch(actionAddGroups(transformGroups(result.groups)));\n\t\t\t\t\t} else if (result.key) {\n\t\t\t\t\t\t// logged in user\n\t\t\t\t\t\tdispatch(setActiveKey(result.key));\n\t\t\t\t\t\tdispatch(add(transformUser(result)));\n\t\t\t\t\t\tdispatch(actionAddGroups(transformGroups(result.groups)));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tdispatch(common.actionGeneralError(error));\n\t\t\t\treturn error;\n\t\t\t});\n\t};\n}\n\nfunction apiLogoutUser(ttl) {\n\tif (_.isUndefined(ttl)) ttl = TTL;\n\treturn (dispatch, getState) => {\n\t\tconst apiBackendProtocol = Select.app.getLocalConfiguration(\n\t\t\tgetState(),\n\t\t\t'apiBackendProtocol'\n\t\t);\n\t\tconst apiBackendHost = Select.app.getLocalConfiguration(\n\t\t\tgetState(),\n\t\t\t'apiBackendHost'\n\t\t);\n\t\tdispatch(actionApiLogoutRequest());\n\n\t\tlet url =\n\t\t\tapiBackendProtocol +\n\t\t\t'://' +\n\t\t\tpath.join(apiBackendHost, 'api/login/logout');\n\n\t\treturn fetch(url, {\n\t\t\tmethod: 'POST',\n\t\t\tcredentials: 'include',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\tAccept: 'application/json',\n\t\t\t},\n\t\t}).then(\n\t\t\tresponse => {\n\t\t\t\tconsole.log('#### logout user response', response);\n\t\t\t\tif (response.ok) {\n\t\t\t\t\t// window.location.reload();\n\t\t\t\t\tdispatch(onLogout());\n\t\t\t\t} else {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tactionApiLogoutRequestError(\n\t\t\t\t\t\t\t'user#action logout Problem with logging out the User, please try later.'\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t},\n\t\t\terror => {\n\t\t\t\tconsole.log('#### logout user error', error);\n\t\t\t\tif (ttl - 1) {\n\t\t\t\t\tdispatch(apiLogoutUser(ttl - 1));\n\t\t\t\t} else {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tactionApiLogoutRequestError(\n\t\t\t\t\t\t\t'user#action logout Problem with logging out the User, please try later.'\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t};\n}\n\n// ============ helpers ===========\n\nfunction transformUser(user) {\n\treturn {\n\t\t...user,\n\t\t//TODO remove -> workaround with permissions.guest.get\n\t\tpermissions: {...user.permissions, guest: {get: false}},\n\t\tgroups: _.map(user.groups, 'key'),\n\t};\n}\n//TODO remove -> workaround with permissions.guest.get\nfunction transformGroups(groups) {\n\treturn groups.map(group => ({...group, permissions: {guest: {get: false}}}));\n}\n\n// ============ actions ===========\n\nfunction actionClearUsersUseIndexed(componentId) {\n\treturn {\n\t\ttype: ActionTypes.USERS.USE.INDEXED.CLEAR,\n\t\tcomponentId,\n\t};\n}\n\nfunction actionClearGroupsUseIndexed(componentId) {\n\treturn {\n\t\ttype: ActionTypes.USERS.GROUPS.USE.INDEXED.CLEAR,\n\t\tcomponentId,\n\t};\n}\n\nfunction actionAddGroups(groups) {\n\treturn {\n\t\ttype: ActionTypes.USERS.GROUPS.ADD,\n\t\tdata: groups,\n\t};\n}\n\nfunction actionApiLogoutRequest() {\n\treturn {\n\t\ttype: ActionTypes.USERS_LOGOUT_REQUEST,\n\t};\n}\n\nfunction actionApiLogoutRequestError(error) {\n\treturn {\n\t\ttype: ActionTypes.USERS_LOGOUT_REQUEST_ERROR,\n\t\terror: error,\n\t};\n}\n\nfunction actionApiLoadRequest() {\n\treturn {\n\t\ttype: ActionTypes.USERS_LOAD_REQUEST,\n\t};\n}\n\nfunction actionApiLoadRequestError(error) {\n\treturn {\n\t\ttype: ActionTypes.USERS_LOAD_REQUEST_ERROR,\n\t\terror: error,\n\t};\n}\n\nfunction actionApiLoginRequest() {\n\treturn {\n\t\ttype: ActionTypes.USERS.LOGIN.REQUEST,\n\t};\n}\n\nfunction actionApiLoadCurrentUserRequest() {\n\treturn {\n\t\ttype: ActionTypes.USERS.CURRENT.REQUEST,\n\t};\n}\n\nfunction actionLogout() {\n\treturn {\n\t\ttype: ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT,\n\t};\n}\n\n// ============ export ===========\n\nexport default {\n\tadd,\n\t// apiLoad: apiLoad,\n\tapiLoadCurrentUser: apiLoadCurrentUser,\n\tapiLoginUser: apiLoginUser,\n\tapiLogoutUser: apiLogoutUser,\n\trefreshUses,\n\tuseKeys,\n\tuseKeysClear,\n\tuseIndexedUsers,\n\tuseIndexedGroups,\n\tuseIndexedUsersClear: actionClearUsersUseIndexed,\n\tuseIndexedGroupsClear: actionClearGroupsUseIndexed,\n\t// update: update\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport Select from '../Select';\n\nimport common from '../_common/actions';\nimport _ from 'lodash';\n\n// ============ creators ===========\n\nconst add = common.add(ActionTypes.VIEWS);\nconst setActiveKey = common.setActiveKey(ActionTypes.VIEWS);\nconst setActiveKeys = common.setActiveKeys(ActionTypes.VIEWS);\nconst create = common.create(\n\tSelect.views.getSubstate,\n\t'views',\n\tActionTypes.VIEWS,\n\t'views'\n);\nconst deleteItem = common.delete(\n\tSelect.views.getSubstate,\n\t'views',\n\tActionTypes.VIEWS,\n\t'views'\n);\nconst saveEdited = common.saveEdited(\n\tSelect.views.getSubstate,\n\t'views',\n\tActionTypes.VIEWS,\n\t'views'\n);\nconst updateEdited = common.updateEdited(\n\tSelect.views.getSubstate,\n\tActionTypes.VIEWS,\n\t'views'\n);\nconst useKeys = common.useKeys(\n\tSelect.views.getSubstate,\n\t'views',\n\tActionTypes.VIEWS,\n\t'views'\n);\nconst useKeysClear = common.useKeysClear(ActionTypes.VIEWS);\nconst useIndexedClear = common.useIndexedClear(ActionTypes.VIEWS);\nconst useIndexed = common.useIndexed(\n\tSelect.views.getSubstate,\n\t'views',\n\tActionTypes.VIEWS,\n\t'views'\n);\nconst refreshUses = common.refreshUses(\n\tSelect.views.getSubstate,\n\t`views`,\n\tActionTypes.VIEWS,\n\t'views'\n);\n\n// ============ actions ===========\nconst apply = (key, actions) => {\n\treturn (dispatch, getState) => {\n\t\treturn dispatch(\n\t\t\tcommon.ensureKeys(\n\t\t\t\tSelect.views.getSubstate,\n\t\t\t\t'views',\n\t\t\t\tActionTypes.VIEWS,\n\t\t\t\t[key],\n\t\t\t\t'views'\n\t\t\t)\n\t\t)\n\t\t\t.then(() => {\n\t\t\t\tlet data = Select.views.getDataByKey(getState(), key);\n\t\t\t\tif (data && data.state) {\n\t\t\t\t\tlet actionCreators = [];\n\t\t\t\t\t_.each(actions, (storeActions, key) => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tstoreActions.hasOwnProperty('updateStateFromView') &&\n\t\t\t\t\t\t\tdata.state[key]\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tactionCreators.push(\n\t\t\t\t\t\t\t\tstoreActions.updateStateFromView(data.state[key])\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif (actions.data.components && data.state.data?.components) {\n\t\t\t\t\t\tactionCreators.push(\n\t\t\t\t\t\t\tactions.data.components.addComponentsFromView(\n\t\t\t\t\t\t\t\tdata.state.data.components\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (actions.specific) {\n\t\t\t\t\t\t_.each(actions.specific, (storeActions, key) => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tstoreActions.hasOwnProperty('updateStateFromView') &&\n\t\t\t\t\t\t\t\tdata.state[key]\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tactionCreators.push(\n\t\t\t\t\t\t\t\t\tstoreActions.updateStateFromView(data.state[key])\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tdispatch(actionCreators);\n\t\t\t\t} else {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tcommon.actionGeneralError(\n\t\t\t\t\t\t\t\"Views#apply: View or state of view doesn't exist! View key: \" +\n\t\t\t\t\t\t\t\tkey\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tdispatch(common.actionGeneralError('Views#apply: ' + err));\n\t\t\t});\n\t};\n};\n\nconst applyAndSetActive = (key, actions) => {\n\treturn dispatch => {\n\t\treturn dispatch(apply(key, actions)).then(() => {\n\t\t\tdispatch(setActiveKey(key));\n\t\t});\n\t};\n};\n\n// ============ export ===========\n\nexport default {\n\tadd,\n\tapply,\n\tapplyAndSetActive,\n\tsetActiveKey,\n\tsetActiveKeys,\n\tcreate,\n\tdelete: deleteItem,\n\tsaveEdited,\n\tupdateEdited,\n\tuseKeys,\n\tuseKeysClear,\n\trefreshUses,\n\tuseIndexed,\n\tuseIndexedClear,\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport Select from '../Select';\n\n// ============ creators ===========\n\n// TODO add or update\nfunction addOrOpen(setKey, windowKey, settings, component, props) {\n\treturn (dispatch, getState) => {\n\t\tlet existingWindow = Select.windows.getWindow(getState(), windowKey);\n\t\tif (existingWindow) {\n\t\t\tdispatch(actionOpen(setKey, windowKey));\n\t\t} else {\n\t\t\tdispatch(\n\t\t\t\tactionAdd(setKey, windowKey, 'open', settings, component, props)\n\t\t\t);\n\t\t}\n\t};\n}\n\nfunction updateSettings(windowKey, settings) {\n\treturn (dispatch, getState) => {\n\t\tlet window = Select.windows.getWindow(getState(), windowKey);\n\t\tlet updatedData = {\n\t\t\t...window.data,\n\t\t\tsettings: {...window.data.settings, ...settings},\n\t\t};\n\t\tdispatch(actionUpdate(windowKey, updatedData));\n\t};\n}\n\n// ============ actions ===========\nconst actionAdd = (setKey, windowKey, state, settings, component, props) => {\n\treturn {\n\t\ttype: ActionTypes.WINDOWS.ADD,\n\t\tsetKey,\n\t\twindowKey,\n\t\tstate,\n\t\tsettings,\n\t\tcomponent,\n\t\tprops,\n\t};\n};\n\nconst actionOpen = (setKey, windowKey) => {\n\treturn {\n\t\ttype: ActionTypes.WINDOWS.OPEN,\n\t\tsetKey,\n\t\twindowKey,\n\t};\n};\n\nconst actionRemove = (setKey, windowKey) => {\n\treturn {\n\t\ttype: ActionTypes.WINDOWS.REMOVE,\n\t\tsetKey,\n\t\twindowKey,\n\t};\n};\n\nconst actionTopWindow = (setKey, windowKey) => {\n\treturn {\n\t\ttype: ActionTypes.WINDOWS.TOP,\n\t\tsetKey,\n\t\twindowKey,\n\t};\n};\n\nconst actionUpdate = (windowKey, data) => {\n\treturn {\n\t\ttype: ActionTypes.WINDOWS.UPDATE,\n\t\twindowKey,\n\t\tdata,\n\t};\n};\n\n// ============ export ===========\n\nexport default {\n\taddOrOpen,\n\tremove: actionRemove,\n\ttopWindow: actionTopWindow,\n\tupdateSettings,\n};\n","import App from './App/actions';\nimport Areas from './Areas/actions';\nimport AreaRelations from './AreaRelations/actions';\nimport Attributes from './Attributes/actions';\nimport AttributeSets from './AttributeSets/actions';\nimport Cases from './Cases/actions';\nimport Components from './Components/actions';\nimport Data from './Data/actions';\nimport LayerTemplates from './LayerTemplates/actions';\nimport LayerTrees from './LayerTrees/actions';\nimport Maps from './Maps/actions';\nimport Periods from './Periods/actions';\nimport Places from './Places/actions';\nimport Scenarios from './Scenarios/actions';\nimport Scopes from './Scopes/actions';\nimport Screens from './Screens/actions';\nimport Selections from './Selections/actions';\nimport Styles from './Styles/actions';\nimport Tags from './Tags/actions';\nimport Users from './Users/actions';\nimport Views from './Views/actions';\nimport Windows from './Windows/actions';\n\nexport default {\n\tapp: App,\n\tareas: Areas,\n\tareaRelations: AreaRelations,\n\tattributes: Attributes,\n\tattributeSets: AttributeSets,\n\tcases: Cases,\n\tcomponents: Components,\n\tdata: Data,\n\tlayerTemplates: LayerTemplates,\n\tlayerTrees: LayerTrees,\n\tmaps: Maps,\n\tperiods: Periods,\n\tplaces: Places,\n\tscenarios: Scenarios,\n\tscopes: Scopes,\n\tscreens: Screens,\n\tselections: Selections,\n\tstyles: Styles,\n\ttags: Tags,\n\tusers: Users,\n\tviews: Views,\n\twindows: Windows,\n};\n","import {connect} from 'react-redux';\nimport Action from '../state/Action';\nimport Select from '../state/Select';\n\nconst mapStateToProps = (state, props) => {\n\treturn {\n\t\tactiveUser: Select.users.getActive(state),\n\t\tloginOverlayOpen: Select.components.get(\n\t\t\tstate,\n\t\t\t'App_Container',\n\t\t\t'loginOverlayOpen'\n\t\t),\n\t};\n};\n\nconst mapDispatchToProps = dispatch => {\n\treturn {\n\t\tonLogIn: (email, password) => {\n\t\t\tdispatch(Action.users.apiLoginUser(email, password));\n\t\t},\n\t\tonLoginOverlayClose: () => {\n\t\t\tdispatch(\n\t\t\t\tAction.components.set('App_Container', 'loginOverlayOpen', false)\n\t\t\t);\n\t\t},\n\t};\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps);\n","import React from 'react';\nimport {connect} from 'react-redux';\nimport {setState} from '@jvitela/recompute';\nimport Select from '../../state/Select';\nimport Action from '../../state/Action';\n\nconst mapStateToProps = (state, ownProps) => {\n\tsetState(state);\n\treturn Select.data.components.getDataForCartesianChart(ownProps);\n};\n\nconst mapDispatchToPropsFactory = () => {\n\treturn (dispatch, ownProps) => {\n\t\treturn {\n\t\t\tonMount: () => {\n\t\t\t\tdispatch(Action.data.components.use(ownProps.stateComponentKey));\n\t\t\t},\n\t\t\tonUnmount: () => {\n\t\t\t\tdispatch(\n\t\t\t\t\tAction.data.components.componentUseClear(ownProps.stateComponentKey)\n\t\t\t\t);\n\t\t\t},\n\t\t};\n\t};\n};\n\nexport default connect(mapStateToProps, mapDispatchToPropsFactory);\n","import {connect} from 'react-redux';\nimport {setState} from '@jvitela/recompute';\nimport Action from '../../state/Action';\nimport Select from '../../state/Select';\nimport {utils} from '@gisatcz/ptr-utils';\n\nconst mapStateToProps = (state, ownProps) => {\n\tsetState(state);\n\n\tif (ownProps.stateMapKey) {\n\t\treturn {\n\t\t\tbackgroundLayer: Select.maps.getMapBackgroundLayer(ownProps.stateMapKey),\n\t\t\tlayers: Select.maps.getMapLayers(ownProps.stateMapKey),\n\t\t\tviewport: Select.maps.getViewportByMapKey(state, ownProps.stateMapKey),\n\t\t\tview: Select.maps.getViewByMapKey(state, ownProps.stateMapKey),\n\t\t\tviewLimits: Select.maps.getViewLimitsByMapKey(\n\t\t\t\tstate,\n\t\t\t\townProps.stateMapKey\n\t\t\t),\n\t\t\tmapKey: ownProps.stateMapKey,\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tbackgroundLayer: Select.maps.getMapBackgroundLayer(\n\t\t\t\townProps.mapKey,\n\t\t\t\townProps.backgroundLayer\n\t\t\t),\n\t\t\tlayers: Select.maps.getMapLayers(ownProps.mapKey, ownProps.layers),\n\t\t};\n\t}\n};\n\nconst mapDispatchToPropsFactory = () => {\n\tconst componentId = 'Map_' + utils.randomString(6);\n\n\treturn (dispatch, ownProps) => {\n\t\tif (ownProps.stateMapKey) {\n\t\t\treturn {\n\t\t\t\tonMount: (mapWidth, mapHeight) => {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tAction.maps.setMapViewport(\n\t\t\t\t\t\t\townProps.stateMapKey,\n\t\t\t\t\t\t\tmapWidth,\n\t\t\t\t\t\t\tmapHeight\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tAction.maps.use(\n\t\t\t\t\t\t\townProps.stateMapKey,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tmapWidth,\n\t\t\t\t\t\t\tmapHeight\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t},\n\n\t\t\t\tonResize: (mapWidth, mapHeight) => {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tAction.maps.setMapViewport(\n\t\t\t\t\t\t\townProps.stateMapKey,\n\t\t\t\t\t\t\tmapWidth,\n\t\t\t\t\t\t\tmapHeight\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tAction.maps.use(\n\t\t\t\t\t\t\townProps.stateMapKey,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tmapWidth,\n\t\t\t\t\t\t\tmapHeight\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t},\n\n\t\t\t\tonUnmount: () => {\n\t\t\t\t\tdispatch(Action.maps.mapUseClear(ownProps.stateMapKey));\n\t\t\t\t},\n\n\t\t\t\trefreshUse: () => {},\n\n\t\t\t\tonViewChange: update => {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tAction.maps.updateMapAndSetView(ownProps.stateMapKey, update)\n\t\t\t\t\t);\n\t\t\t\t},\n\n\t\t\t\tonPropViewChange: (update, mapWidth, mapHeight) => {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tAction.maps.setMapViewport(\n\t\t\t\t\t\t\townProps.stateMapKey,\n\t\t\t\t\t\t\tmapWidth,\n\t\t\t\t\t\t\tmapHeight\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tAction.maps.use(\n\t\t\t\t\t\t\townProps.stateMapKey,\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\tmapWidth,\n\t\t\t\t\t\t\tmapHeight\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t},\n\n\t\t\t\tresetHeading: () => {},\n\n\t\t\t\tonClick: view => {\n\t\t\t\t\tdispatch(Action.maps.setMapSetActiveMapKey(ownProps.stateMapKey));\n\t\t\t\t},\n\t\t\t\tonLayerClick: (mapKey, layerKey, selectedFeatureKeys) => {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tAction.maps.setLayerSelectedFeatureKeys(\n\t\t\t\t\t\t\townProps.stateMapKey,\n\t\t\t\t\t\t\tlayerKey,\n\t\t\t\t\t\t\tselectedFeatureKeys\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\tlet mapKey = ownProps.mapKey || componentId;\n\n\t\t\treturn {\n\t\t\t\tonMount: () => {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tAction.maps.use(mapKey, ownProps.backgroundLayer, ownProps.layers)\n\t\t\t\t\t);\n\t\t\t\t},\n\n\t\t\t\tonUnmount: () => {},\n\n\t\t\t\trefreshUse: () => {},\n\n\t\t\t\tonViewChange: ownProps.onViewChange || (update => {}),\n\n\t\t\t\tonClick: ownProps.onClick || (view => {}),\n\t\t\t};\n\t\t}\n\t};\n};\n\nexport default connect(mapStateToProps, mapDispatchToPropsFactory);\n","import {connect} from 'react-redux';\nimport Action from '../../state/Action';\nimport Select from '../../state/Select';\nimport {utils} from '@gisatcz/ptr-utils';\n\nconst mapStateToProps = (state, ownProps) => {\n\tif (ownProps.stateMapSetKey) {\n\t\tconst activeMapKey = Select.maps.getMapSetActiveMapKey(\n\t\t\tstate,\n\t\t\townProps.stateMapSetKey\n\t\t);\n\t\treturn {\n\t\t\tactiveMapKey,\n\t\t\tactiveMapView: Select.maps.getMapSetActiveMapView(\n\t\t\t\tstate,\n\t\t\t\townProps.stateMapSetKey\n\t\t\t),\n\t\t\tmaps: Select.maps.getMapSetMapKeys(state, ownProps.stateMapSetKey),\n\t\t\tview: Select.maps.getMapSetView(state, ownProps.stateMapSetKey),\n\t\t\tactiveMapViewport: Select.maps.getViewportByMapKey(state, activeMapKey),\n\t\t\tviewLimits: Select.maps.getMapSetViewLimits(\n\t\t\t\tstate,\n\t\t\t\townProps.stateMapSetKey\n\t\t\t),\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tbackgroundLayer: null,\n\t\t\tlayers: null,\n\t\t};\n\t}\n};\n\nconst mapDispatchToPropsFactory = () => {\n\tconst componentId = 'MapSet_' + utils.randomString(6);\n\n\treturn (dispatch, ownProps) => {\n\t\tif (ownProps.stateMapSetKey) {\n\t\t\treturn {\n\t\t\t\tonMount: () => {\n\t\t\t\t\tdispatch(Action.maps.mapSetUseRegister(ownProps.stateMapSetKey));\n\t\t\t\t},\n\t\t\t\tonUnmount: () => {\n\t\t\t\t\tdispatch(Action.maps.mapSetUseClear(ownProps.stateMapSetKey));\n\t\t\t\t},\n\t\t\t\tupdateView: (update, mapKey) => {\n\t\t\t\t\tdispatch(Action.maps.updateMapAndSetView(mapKey, update));\n\t\t\t\t},\n\t\t\t\tresetHeading: mapKey => {},\n\t\t\t\tonMapRemove: mapKey => {\n\t\t\t\t\tdispatch(\n\t\t\t\t\t\tAction.maps.removeMapFromSet(ownProps.stateMapSetKey, mapKey)\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\tlet setKey = ownProps.setKey || componentId;\n\t\t\treturn {\n\t\t\t\tonMount: () => {},\n\n\t\t\t\tonUnmount: () => {},\n\n\t\t\t\trefreshUse: () => {},\n\t\t\t};\n\t\t}\n\t};\n};\n\nexport default connect(mapStateToProps, mapDispatchToPropsFactory);\n","import {connect} from 'react-redux';\nimport Action from '../state/Action';\nimport Select from '../state/Select';\n\nconst mapStateToProps = (state, props) => {\n\treturn {\n\t\tscreens: Select.screens.getScreensBySetKey(state, props.setKey),\n\t\tset: Select.screens.getSetByKey(state, props.setKey),\n\t};\n};\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n\treturn {\n\t\tonFocusScreen: screenLineage => {\n\t\t\tdispatch(Action.screens.topHistory(ownProps.setKey, screenLineage));\n\t\t},\n\t\tonCloseScreen: screenLineage => {\n\t\t\tdispatch(Action.screens.close(ownProps.setKey, screenLineage));\n\t\t},\n\t\tonOpenScreen: screenLineage => {\n\t\t\tdispatch(Action.screens.open(ownProps.setKey, screenLineage));\n\t\t},\n\t\tonRetractScreen: screenLineage => {\n\t\t\tdispatch(Action.screens.retract(ownProps.setKey, screenLineage));\n\t\t},\n\t};\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps);\n","import {connect} from 'react-redux';\nimport Action from '../state/Action';\nimport Select from '../state/Select';\n\nconst mapStateToProps = (state, props) => {\n\treturn {\n\t\tuser: Select.users.getActiveUser(state),\n\t};\n};\n\nconst mapDispatchToProps = dispatch => {\n\treturn {\n\t\tlogin: () => {\n\t\t\tdispatch(\n\t\t\t\tAction.components.set('App_Container', 'loginOverlayOpen', true)\n\t\t\t);\n\t\t},\n\t\tlogout: () => {\n\t\t\tdispatch(Action.users.apiLogoutUser());\n\t\t},\n\t};\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps);\n","import {connect} from 'react-redux';\nimport Action from '../state/Action';\nimport Select from '../state/Select';\n\nconst mapStateToProps = (state, ownProps) => {\n\treturn {\n\t\tset: Select.windows.getSetByKey(state, ownProps.setKey),\n\t\twindows: Select.windows.getWindowsBySetKeyAsObject(state, ownProps.setKey),\n\t};\n};\n\nconst mapDispatchToProps = (dispatch, ownProps) => {\n\treturn {\n\t\tonWindowClick: windowKey => {\n\t\t\tdispatch(Action.windows.topWindow(ownProps.setKey, windowKey));\n\t\t},\n\t\tonWindowClose: windowKey => {\n\t\t\tdispatch(Action.windows.remove(ownProps.setKey, windowKey));\n\t\t},\n\t\tonWindowDragStart: windowKey => {\n\t\t\tdispatch(Action.windows.topWindow(ownProps.setKey, windowKey));\n\t\t},\n\t\tonWindowDragStop: (windowKey, position) => {\n\t\t\tdispatch(Action.windows.updateSettings(windowKey, {position}));\n\t\t},\n\t\tonWindowResize: (windowKey, width, height, position) => {\n\t\t\tdispatch(\n\t\t\t\tAction.windows.updateSettings(windowKey, {width, height, position})\n\t\t\t);\n\t\t},\n\t};\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps);\n","import AppContainer from './AppContainer';\nimport CartesianChart from './dataComponents/CartesianChart';\nimport Map from './maps/Map';\nimport MapSet from './maps/MapSet';\nimport Screens from './Screens';\nimport User from './User';\nimport WindowsContainer from './WindowsContainer';\n\nexport default {\n\tAppContainer,\n\tCartesianChart,\n\tMap,\n\tMapSet,\n\tScreens,\n\tUser,\n\tWindowsContainer,\n};\n","import React from 'react';\n\nexport default function mountWrapper(Component) {\n\treturn class extends React.PureComponent {\n\t\tcomponentDidMount() {\n\t\t\tthis.props.onMount();\n\t\t}\n\n\t\tcomponentWillUnmount() {\n\t\t\tthis.props.onUnmount();\n\t\t}\n\n\t\trender() {\n\t\t\treturn <Component {...this.props} />;\n\t\t}\n\t};\n}\n","import {\n\tdifference as _difference,\n\teach as _each,\n\tfind as _find,\n\tfindIndex as _findIndex,\n\tforIn as _forIn,\n\tincludes as _includes,\n\tisEmpty as _isEmpty,\n\tisEqual as _isEqual,\n\tmap as _map,\n\tomit as _omit,\n\tunion as _union,\n} from 'lodash';\nimport commonHelpers from './helpers';\n\nexport const DEFAULT_INITIAL_STATE = {\n\tactiveKey: null,\n\tbyKey: null,\n\tcount: null,\n\teditedByKey: null,\n\tindexes: null,\n\tinUse: {\n\t\tindexes: null,\n\t\tkeys: null,\n\t},\n\tlastChangedOn: null,\n\tloading: false,\n\tloadingKeys: null,\n};\n\nexport default {\n\t/**\n\t * Add models to store or update them\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.data {Array} A collection of models to add\n\t * @return {Object} updated state\n\t */\n\tadd: (state, action) => {\n\t\tif (action?.data?.length) {\n\t\t\tlet newData = {...state.byKey};\n\t\t\taction.data.forEach(model => {\n\t\t\t\tnewData[model.key] = {...newData[model.key], ...model};\n\t\t\t\tdelete newData[model.key].outdated;\n\t\t\t\tdelete newData[model.key].unreceived;\n\t\t\t});\n\n\t\t\treturn {...state, byKey: newData};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Add just keys and mark as unreceived for unreceived models\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.keys {Array} A list of unreceived keys\n\t * @return {Object} updated state\n\t */\n\taddUnreceivedKeys: (state, action) => {\n\t\tif (action?.keys?.length) {\n\t\t\tlet newData = {...state.byKey};\n\t\t\taction.keys.forEach(key => {\n\t\t\t\tnewData[key] = {key, unreceived: true};\n\t\t\t});\n\t\t\treturn {...state, byKey: newData};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Add new or updated existing index\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.data {Array} A collection of models to add\n\t * @param action.filter {Object}\n\t * @param action.order {Array}\n\t * @param action.start {number}\n\t * @param action.length {number}\n\t * @param action.count {number}\n\t * @param action.changedOn {string}\n\t * @return {Object} updated state\n\t */\n\taddIndex: (state, action) => {\n\t\tif (action?.data) {\n\t\t\tconst updatedIndexes = state.indexes ? [...state.indexes] : [];\n\t\t\tconst indexOfIndex = updatedIndexes.length\n\t\t\t\t? _findIndex(state.indexes, index => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t_isEqual(index.filter, action.filter) &&\n\t\t\t\t\t\t\t_isEqual(index.order, action.order)\n\t\t\t\t\t\t);\n\t\t\t\t  })\n\t\t\t\t: -1;\n\n\t\t\t// update existing index\n\t\t\tif (indexOfIndex > -1) {\n\t\t\t\tconst updatedIndex = {...updatedIndexes[indexOfIndex]};\n\n\t\t\t\t// register models to index\n\t\t\t\tconst updatedIndexIndex = commonHelpers.registerModelsToIndex(\n\t\t\t\t\t{...updatedIndex.index},\n\t\t\t\t\taction.data,\n\t\t\t\t\taction.start\n\t\t\t\t);\n\n\t\t\t\t// Remove loading indicator if data on this position doesn't exist\n\t\t\t\t// It happens when we ask for some set of data defined by offset and length, but BE returns results only for part of length.\n\t\t\t\tif (action.length) {\n\t\t\t\t\tfor (let i = action.start; i < action.start + action.length; i++) {\n\t\t\t\t\t\tif (updatedIndexIndex[i] === true) {\n\t\t\t\t\t\t\tdelete updatedIndexIndex[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tupdatedIndexes[indexOfIndex] = {\n\t\t\t\t\t...updatedIndex,\n\t\t\t\t\tcount: action.count || updatedIndex.count || null,\n\t\t\t\t\tchangedOn: action.changedOn || updatedIndex.changedOn || null,\n\t\t\t\t\tindex: updatedIndexIndex,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// add new index\n\t\t\telse {\n\t\t\t\tupdatedIndexes.push({\n\t\t\t\t\tfilter: action.filter || null,\n\t\t\t\t\torder: action.order || null,\n\t\t\t\t\tcount: action.count || null,\n\t\t\t\t\tchangedOn: action.changedOn || null,\n\t\t\t\t\tindex: commonHelpers.registerModelsToIndex(\n\t\t\t\t\t\t{},\n\t\t\t\t\t\taction.data,\n\t\t\t\t\t\taction.start\n\t\t\t\t\t),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn {...state, indexes: updatedIndexes};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Register usage of indexed data\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.data {Array} A collection of models to add\n\t * @param action.componentId {string}\n\t * @param action.filterByActive {Object}\n\t * @param action.filter {Object}\n\t * @param action.order {Array}\n\t * @param action.start {number}\n\t * @param action.length {number}\n\t * @return {Object} updated state\n\t */\n\tregisterUseIndexed: (state, action) => {\n\t\tlet newUse = {\n\t\t\tfilterByActive: action.filterByActive,\n\t\t\tfilter: action.filter,\n\t\t\torder: action.order,\n\t\t\tstart: action.start,\n\t\t\tlength: action.length,\n\t\t};\n\n\t\tlet existingUse = false;\n\t\tif (state.inUse.indexes && state.inUse.indexes[action.componentId]) {\n\t\t\texistingUse = _find(state.inUse.indexes[action.componentId], newUse);\n\t\t}\n\n\t\t// add use if it doesn't already exist\n\t\tif (!existingUse) {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tinUse: {\n\t\t\t\t\t...state.inUse,\n\t\t\t\t\tindexes: {\n\t\t\t\t\t\t...state.inUse.indexes,\n\t\t\t\t\t\t[action.componentId]:\n\t\t\t\t\t\t\tstate.inUse.indexes && state.inUse.indexes[action.componentId]\n\t\t\t\t\t\t\t\t? [...state.inUse.indexes[action.componentId], newUse]\n\t\t\t\t\t\t\t\t: [newUse],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Clear the usage of indexed data\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.componentId {string}\n\t * @return {Object} updated state\n\t */\n\tuseIndexedClear: (state, action) => {\n\t\tif (\n\t\t\taction.componentId &&\n\t\t\tstate.inUse?.indexes?.hasOwnProperty(action.componentId)\n\t\t) {\n\t\t\tlet indexes = {...state.inUse.indexes};\n\t\t\tdelete indexes[action.componentId];\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tinUse: {...state.inUse, indexes: _isEmpty(indexes) ? null : indexes},\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Clear all usages of indexed data\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @return {Object} updated state\n\t */\n\tuseIndexedClearAll: (state, action) => {\n\t\tif (state.inUse && state.inUse?.indexes) {\n\t\t\treturn {...state, inUse: {...state.inUse, indexes: null}};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Register the usage of a model with key\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.componentId {Object} string\n\t * @param action.keys {Array} list of keys\n\t * @return {Object} updated state\n\t */\n\tuseKeysRegister: (state, action) => {\n\t\tif (action.componentId && action.keys?.length) {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tinUse: {\n\t\t\t\t\t...state.inUse,\n\t\t\t\t\tkeys: {\n\t\t\t\t\t\t...state.inUse.keys,\n\t\t\t\t\t\t[action.componentId]: state.inUse.keys?.[action.componentId]\n\t\t\t\t\t\t\t? _union(state.inUse.keys[action.componentId], action.keys)\n\t\t\t\t\t\t\t: action.keys,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Clear the usage of models for component\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.componentId {string}\n\t * @return {Object} updated state\n\t */\n\tuseKeysClear: (state, action) => {\n\t\tif (action.componentId) {\n\t\t\tlet keys = {...state.inUse.keys};\n\t\t\tdelete keys[action.componentId];\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tinUse: {\n\t\t\t\t\t...state.inUse,\n\t\t\t\t\tkeys: _isEmpty(keys) ? null : keys,\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Mark model as deleted\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.key {string}\n\t * @return {Object} updated state\n\t */\n\tmarkDeleted: (state, action) => {\n\t\tif (action.key && state.byKey?.[action.key]) {\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tbyKey: {\n\t\t\t\t\t...state.byKey,\n\t\t\t\t\t[action.key]: {\n\t\t\t\t\t\t...state.byKey[action.key],\n\t\t\t\t\t\tremoved: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Remove models from byKey\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.keys {Array} list of model keys to remove\n\t * @return {Object} updated state\n\t */\n\tremove: (state, action) => {\n\t\tif (action.keys?.length && state.byKey) {\n\t\t\tconst updatedByKey = _omit(state.byKey, action.keys);\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tbyKey: _isEmpty(updatedByKey) ? null : updatedByKey,\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Remove edited models\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.keys {Array} list of model keys to remove\n\t * @return {Object} updated state\n\t */\n\tremoveEdited: (state, action) => {\n\t\tif (action.keys?.length && state.editedByKey) {\n\t\t\tconst updatedEditedByKey = _omit(state.editedByKey, action.keys);\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\teditedByKey: _isEmpty(updatedEditedByKey) ? null : updatedEditedByKey,\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Remove edited active model\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @return {Object} updated state\n\t */\n\tremoveEditedActive: (state, action) => {\n\t\tif (state.activeKey && state.editedByKey) {\n\t\t\tconst updatedEditedByKey = _omit(state.editedByKey, state.activeKey);\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\teditedByKey: _isEmpty(updatedEditedByKey) ? null : updatedEditedByKey,\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Remove edited model property\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.key {Array} edited model key\n\t * @param action.property {Array} edited model property\n\t * @return {Object} updated state\n\t */\n\tremoveEditedProperty: (state, action) => {\n\t\tif (action.key && state.editedByKey) {\n\t\t\tconst editedModel = state.editedByKey[action.key];\n\t\t\tconst editedModelData = editedModel?.data;\n\t\t\tif (editedModelData?.hasOwnProperty(action.property)) {\n\t\t\t\tconst {\n\t\t\t\t\t[action.property]: propertyToRemove,\n\t\t\t\t\t...restProps\n\t\t\t\t} = editedModelData;\n\n\t\t\t\tif (_isEmpty(restProps)) {\n\t\t\t\t\tlet editedModels = {...state.editedByKey};\n\t\t\t\t\tdelete editedModels[action.key];\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...state,\n\t\t\t\t\t\teditedByKey: _isEmpty(editedModels) ? null : editedModels,\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...state,\n\t\t\t\t\t\teditedByKey: {\n\t\t\t\t\t\t\t...state.editedByKey,\n\t\t\t\t\t\t\t[action.key]: {\n\t\t\t\t\t\t\t\t...state.editedByKey[action.key],\n\t\t\t\t\t\t\t\tdata: restProps,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn state;\n\t\t\t}\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Set active key\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.key {string|null} key\n\t * @return {Object} state\n\t */\n\tsetActive: (state, action) => {\n\t\treturn {...state, activeKey: action.key, activeKeys: null};\n\t},\n\n\t/**\n\t * Set active keys\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.keys {array|null} keys\n\t * @return {Object} state\n\t */\n\tsetActiveMultiple: (state, action) => {\n\t\treturn {...state, activeKeys: action.keys, activeKey: null};\n\t},\n\n\t/**\n\t * Add or update edited models\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.data {Object} update\n\t * @return {Object} updated state\n\t */\n\tupdateEdited: (state, action) => {\n\t\tif (action.data?.length) {\n\t\t\tlet newEditedData = {...state.editedByKey};\n\t\t\taction.data.forEach(model => {\n\t\t\t\tif (newEditedData[model.key]) {\n\t\t\t\t\tnewEditedData[model.key] = {\n\t\t\t\t\t\t...newEditedData[model.key],\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t...newEditedData[model.key].data,\n\t\t\t\t\t\t\t...model.data,\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tnewEditedData[model.key] = model;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn {...state, editedByKey: newEditedData};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Set indexes as outdated\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @return {Object} updated state\n\t */\n\tclearIndexes: (state, action) => {\n\t\tif (state.indexes?.length) {\n\t\t\tlet indexes = _map(state.indexes, index => {\n\t\t\t\treturn {\n\t\t\t\t\t...index,\n\t\t\t\t\tindex: null,\n\t\t\t\t\tcount: null,\n\t\t\t\t\tchangedOn: null,\n\t\t\t\t\toutdated: index.index,\n\t\t\t\t\toutdatedCount: index.count,\n\t\t\t\t};\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tindexes,\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Useful for invalidate data before refresh indexes\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @param action.filter {Object}\n\t * @param action.order {Array}\n\t * @return {Object} updated state\n\t * */\n\tclearIndex: (state, action) => {\n\t\tif (state.indexes?.length) {\n\t\t\tconst indexes = [...state.indexes].map(index => {\n\t\t\t\tconst correspondIndex = commonHelpers.isCorrespondingIndex(\n\t\t\t\t\tindex,\n\t\t\t\t\taction.filter,\n\t\t\t\t\taction.order\n\t\t\t\t);\n\t\t\t\tif (correspondIndex) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...index,\n\t\t\t\t\t\toutdated: index.index,\n\t\t\t\t\t\toutdatedCount: index.count,\n\t\t\t\t\t\tindex: null,\n\t\t\t\t\t\tcount: null,\n\t\t\t\t\t\tchangedOn: null,\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\treturn index;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tindexes,\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Mark all models as outdated\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @return {Object}\n\t */\n\tdataSetOutdated: (state, action) => {\n\t\tif (state.byKey) {\n\t\t\tlet byKey = {};\n\t\t\t_each(state.byKey, (model, key) => {\n\t\t\t\tbyKey[key] = {\n\t\t\t\t\t...model,\n\t\t\t\t\toutdated: true,\n\t\t\t\t};\n\t\t\t});\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tbyKey,\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Cleanup on logout\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @return {Object}\n\t */\n\tcleanupOnLogout: (state, action) => {\n\t\tif (state.byKey) {\n\t\t\tlet byKey = {};\n\t\t\t_each(state.byKey, (model, key) => {\n\t\t\t\tif (model.permissions?.guest?.get) {\n\t\t\t\t\tbyKey[key] = {\n\t\t\t\t\t\t...model,\n\t\t\t\t\t\tpermissions: {\n\t\t\t\t\t\t\tguest: model.permissions.guest,\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn {...state, byKey};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n\n\t/**\n\t * Update whole state\n\t * @param state {Object}\n\t * @param action {Object}\n\t * @return {Object}\n\t */\n\tupdateStore: (state, action) => {\n\t\tif (action) {\n\t\t\tconst {type, ...data} = action;\n\t\t\treturn {...state, ...data};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t},\n};\n","import Select from '../Select';\nimport ActionTypes from '../../constants/ActionTypes';\n\n/**\n * A list of stores where indexes should be checked, if they depend on given filter by active.\n * The collection item has following structure: {storeKey: [getSubstate, data type, action types, category path ('metadata' by default)]}\n */\nexport const STORES_TO_ENSURE_WITH_FILTER_BY_ACTIVE = {\n\tareaRelations: [\n\t\tSelect.areaRelations.getSubstate,\n\t\t'area',\n\t\tActionTypes.AREA_RELATIONS,\n\t\t'relations',\n\t],\n\tareaTrees: [\n\t\tSelect.areas.areaTrees.getSubstate,\n\t\t'areaTrees',\n\t\tActionTypes.AREAS.AREA_TREES,\n\t],\n\tareaTreeLevels: [\n\t\tSelect.areas.areaTrees.getSubstate,\n\t\t'areaTreeLevels',\n\t\tActionTypes.AREAS.AREA_TREE_LEVELS,\n\t],\n\tattributes: [\n\t\tSelect.attributes.getSubstate,\n\t\t'attributes',\n\t\tActionTypes.ATTRIBUTES,\n\t],\n\tattributeSets: [\n\t\tSelect.attributeSets.getSubstate,\n\t\t'attributes',\n\t\tActionTypes.ATTRIBUTE_SETS,\n\t],\n\tcases: [Select.cases.getSubstate, 'cases', ActionTypes.CASES],\n\tlayerTemplates: [\n\t\tSelect.layerTemplates.getSubstate,\n\t\t'layerTemplates',\n\t\tActionTypes.LAYER_TEMPLATES,\n\t],\n\tperiods: [Select.periods.getSubstate, 'periods', ActionTypes.PERIODS],\n\tplaces: [Select.places.getSubstate, 'places', ActionTypes.PLACES],\n\tscenarios: [Select.scenarios.getSubstate, 'scenarios', ActionTypes.SCENARIOS],\n\tscopes: [Select.scopes.getSubstate, 'scopes', ActionTypes.SCOPES],\n\ttags: [Select.tags.getSubstate, 'tags', ActionTypes.TAGS],\n\tviews: [Select.views.getSubstate, 'views', ActionTypes.VIEWS, 'views'],\n};\n","import _ from 'lodash';\nimport common from '../_common/actions';\nimport DataComponentsActions from '../Data/Components/actions';\nimport MapsActions from '../Maps/actions';\nimport {STORES_TO_ENSURE_WITH_FILTER_BY_ACTIVE} from './constants';\n\n/**\n * Ensure indexes with filter by active for each store from the list (above) & for data-based components\n *\n * @param filterKey {string} active metadata type key (e.g. scope, place, ..)\n */\nfunction ensureDependenciesOfActiveMetadataType(filterKey) {\n\treturn dispatch => {\n\t\tlet filterByActive = {\n\t\t\t[filterKey]: true,\n\t\t};\n\n\t\t_.forIn(STORES_TO_ENSURE_WITH_FILTER_BY_ACTIVE, params => {\n\t\t\tdispatch(\n\t\t\t\tcommon.ensureIndexesWithFilterByActive(...params)(filterByActive)\n\t\t\t);\n\t\t});\n\n\t\tdispatch(DataComponentsActions.ensureWithFilterByActive(filterByActive));\n\t\tdispatch(MapsActions.ensureWithFilterByActive(filterByActive));\n\t};\n}\n\nexport default {\n\tensureDependenciesOfActiveMetadataType,\n};\n","import ActionTypes from '../../constants/ActionTypes';\n\nconst INITIAL_STATE = {\n\tkey: null,\n};\n\n/**\n * @param state\n * @param action\n * @param action.key {string}\n * @return {Object}\n */\nconst setKey = (state, action) => {\n\treturn {\n\t\t...state,\n\t\tkey: action.key,\n\t};\n};\n\nconst setBaseUrl = (state, action) => {\n\treturn {\n\t\t...state,\n\t\tbaseUrl: action.url,\n\t};\n};\n\nconst setLocalConfiguration = (state, action) => {\n\tlet path = action.path.split('.');\n\treturn {\n\t\t...state,\n\t\tlocalConfiguration: setHelper(state.localConfiguration, path, action.value),\n\t};\n};\n\nconst updateLocalConfiguration = (state, action) => {\n\treturn {\n\t\t...state,\n\t\tlocalConfiguration: state.localConfiguration\n\t\t\t? {...state.localConfiguration, ...action.update}\n\t\t\t: action.update,\n\t};\n};\n\nfunction setHelper(state, path, value) {\n\tlet remainingPath = [...path];\n\tlet currentKey = remainingPath.shift();\n\tif (remainingPath.length) {\n\t\treturn {\n\t\t\t...state,\n\t\t\t[currentKey]: setHelper(state[currentKey], remainingPath, value),\n\t\t};\n\t} else {\n\t\treturn {...state, [currentKey]: value};\n\t}\n}\n\nconst receiveConfiguration = (state, action) => {\n\treturn {...state, configuration: action.configuration};\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.APP.SET_BASE_URL:\n\t\t\treturn setBaseUrl(state, action);\n\t\tcase ActionTypes.APP.SET_KEY:\n\t\t\treturn setKey(state, action);\n\t\tcase ActionTypes.APP.SET_LOCAL_CONFIGURATION:\n\t\t\treturn setLocalConfiguration(state, action);\n\t\tcase ActionTypes.APP.UPDATE_LOCAL_CONFIGURATION:\n\t\t\treturn updateLocalConfiguration(state, action);\n\t\tcase ActionTypes.APP.RECEIVE_CONFIGURATION:\n\t\t\treturn receiveConfiguration(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../../constants/ActionTypes';\nimport common, {DEFAULT_INITIAL_STATE} from '../../_common/reducers';\n\nconst INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.AREAS.AREA_TREE_LEVELS.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREE_LEVELS.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREE_LEVELS.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREE_LEVELS.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREE_LEVELS.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREE_LEVELS.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREE_LEVELS.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREE_LEVELS.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREE_LEVELS.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\treturn common.dataSetOutdated(state, action);\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\treturn common.cleanupOnLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../../constants/ActionTypes';\nimport common, {DEFAULT_INITIAL_STATE} from '../../_common/reducers';\n\nconst INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.AREAS.AREA_TREES.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREES.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREES.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREES.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREES.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREES.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREES.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREES.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\t\tcase ActionTypes.AREAS.AREA_TREES.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\treturn common.dataSetOutdated(state, action);\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\treturn common.cleanupOnLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import {combineReducers} from 'redux';\n\nimport areaTreeLevels from './AreaTreeLevels/reducers';\nimport areaTrees from './AreaTrees/reducers';\n\nexport default combineReducers({\n\tareaTreeLevels,\n\tareaTrees,\n});\n","import ActionTypes from '../../constants/ActionTypes';\nimport common from '../_common/reducers';\n\nimport {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nconst INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.AREA_RELATIONS.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.AREA_RELATIONS.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.AREA_RELATIONS.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.AREA_RELATIONS.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.AREA_RELATIONS.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.AREA_RELATIONS.USE.INDEXED.CLEAR_ALL:\n\t\t\treturn common.useIndexedClearAll(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common from '../_common/reducers';\n\nimport {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.ATTRIBUTES.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.DELETE:\n\t\t\treturn common.remove(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.EDITED.REMOVE:\n\t\t\treturn common.removeEdited(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.EDITED.REMOVE_ACTIVE:\n\t\t\treturn common.removeEditedActive(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.EDITED.REMOVE_PROPERTY:\n\t\t\treturn common.removeEditedProperty(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.EDITED.UPDATE:\n\t\t\treturn common.updateEdited(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.INDEX.CLEAR_INDEX:\n\t\t\treturn common.clearIndex(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.MARK_DELETED:\n\t\t\treturn common.markDeleted(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.SET_ACTIVE_KEYS:\n\t\t\treturn common.setActiveMultiple(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.USE.INDEXED.CLEAR_ALL:\n\t\t\treturn common.useIndexedClearAll(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.ATTRIBUTES.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\treturn common.dataSetOutdated(state, action);\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\treturn common.cleanupOnLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common from '../_common/reducers';\n\nimport {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n\tactiveKeys: null,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.ATTRIBUTE_SETS.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.DELETE:\n\t\t\treturn common.remove(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.EDITED.REMOVE:\n\t\t\treturn common.removeEdited(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.EDITED.REMOVE_ACTIVE:\n\t\t\treturn common.removeEditedActive(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.EDITED.REMOVE_PROPERTY:\n\t\t\treturn common.removeEditedProperty(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.EDITED.UPDATE:\n\t\t\treturn common.updateEdited(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.INDEX.CLEAR_INDEX:\n\t\t\treturn common.clearIndex(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.MARK_DELETED:\n\t\t\treturn common.markDeleted(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.SET_ACTIVE_KEYS:\n\t\t\treturn common.setActiveMultiple(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.USE.INDEXED.CLEAR_ALL:\n\t\t\treturn common.useIndexedClearAll(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.ATTRIBUTE_SETS.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\treturn common.dataSetOutdated(state, action);\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\treturn common.cleanupOnLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common from '../_common/reducers';\n\nimport {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.CASES.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.CASES.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.CASES.DELETE:\n\t\t\treturn common.remove(state, action);\n\t\tcase ActionTypes.CASES.EDITED.REMOVE:\n\t\t\treturn common.removeEdited(state, action);\n\t\tcase ActionTypes.CASES.EDITED.REMOVE_ACTIVE:\n\t\t\treturn common.removeEditedActive(state, action);\n\t\tcase ActionTypes.CASES.EDITED.REMOVE_PROPERTY:\n\t\t\treturn common.removeEditedProperty(state, action);\n\t\tcase ActionTypes.CASES.EDITED.UPDATE:\n\t\t\treturn common.updateEdited(state, action);\n\t\tcase ActionTypes.CASES.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.CASES.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.CASES.INDEX.CLEAR_INDEX:\n\t\t\treturn common.clearIndex(state, action);\n\t\tcase ActionTypes.CASES.MARK_DELETED:\n\t\t\treturn common.markDeleted(state, action);\n\t\tcase ActionTypes.CASES.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.CASES.SET_ACTIVE_KEYS:\n\t\t\treturn common.setActiveMultiple(state, action);\n\t\tcase ActionTypes.CASES.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action);\n\t\tcase ActionTypes.CASES.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.CASES.USE.INDEXED.CLEAR_ALL:\n\t\t\treturn common.useIndexedClearAll(state, action);\n\t\tcase ActionTypes.CASES.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.CASES.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.CASES.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\treturn common.dataSetOutdated(state, action);\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\treturn common.cleanupOnLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import {isEmpty as _isEmpty} from 'lodash';\nimport ActionTypes from '../../constants/ActionTypes';\nimport common from '../_common/reducers';\n\nexport const INITIAL_STATE = {};\n\n/**\n * Update component\n * @param state {Object}\n * @param componentKey {string}\n * @param update {Object}\n * @return {Object} state\n */\nfunction update(state, componentKey, update) {\n\tif (!_isEmpty(update)) {\n\t\treturn {\n\t\t\t...state,\n\t\t\t[componentKey]: state[componentKey]\n\t\t\t\t? {...state[componentKey], ...update}\n\t\t\t\t: update,\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n}\n\n/**\n * Set value in given path\n * @param state {Object}\n * @param component {string}\n * @param path {string} data.property.something\n * @param value {*}\n * @return {Object} state\n */\nfunction set(state, component, path, value) {\n\tif (component && path) {\n\t\tconst pathParams = path.split('.');\n\t\treturn {\n\t\t\t...state,\n\t\t\t[component]: setHelper(state[component], pathParams, value),\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n}\n\n// helpers ---------------------------------------------------------------------\n\n/**\n *\n * @param state {Object}\n * @param path {string}\n * @param value {*}\n * @return {Object}\n */\nfunction setHelper(state, path, value) {\n\tlet remainingPath = [...path];\n\tlet currentKey = remainingPath.shift();\n\tif (remainingPath.length) {\n\t\treturn {\n\t\t\t...state,\n\t\t\t[currentKey]: setHelper(state[currentKey], remainingPath, value),\n\t\t};\n\t} else {\n\t\treturn {...state, [currentKey]: value};\n\t}\n}\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.COMPONENTS.UPDATE:\n\t\t\treturn update(state, action.component, action.update);\n\t\tcase ActionTypes.COMPONENTS.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action);\n\t\tcase ActionTypes.COMPONENTS.SET:\n\t\t\treturn set(state, action.component, action.path, action.value);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../../constants/ActionTypes';\nimport common, {DEFAULT_INITIAL_STATE} from '../../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.DATA.ATTRIBUTE_RELATIONS.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.DATA.ATTRIBUTE_RELATIONS.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.DATA.ATTRIBUTE_RELATIONS.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action.data);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../../constants/ActionTypes';\nimport common, {DEFAULT_INITIAL_STATE} from '../../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.DATA.ATTRIBUTE_DATA_SOURCES.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.DATA.ATTRIBUTE_DATA_SOURCES.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.DATA.ATTRIBUTE_DATA_SOURCES.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action.data);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../../constants/ActionTypes';\nimport common, {DEFAULT_INITIAL_STATE} from '../../_common/reducers';\nimport commonHelpers from '../../_common/helpers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n\tbyDataSourceKey: {},\n};\n\n/**\n * Add attribute data\n * @param state {Object}\n * @param attributeDataSourceKey {string} attribute data source key\n * @param data {Object} feature key - attribute value pairs\n * @return {Object}\n */\nconst add = (state, attributeDataSourceKey, data) => {\n\tif (attributeDataSourceKey && data) {\n\t\treturn {\n\t\t\t...state,\n\t\t\tbyDataSourceKey: {\n\t\t\t\t...state.byDataSourceKey,\n\t\t\t\t[attributeDataSourceKey]: data,\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Update attribute data for given data source\n * @param state {Object}\n * @param attributeDataSourceKey {string} attribute data source key\n * @param data {Object} feature key - attribute value pairs\n * @return {Object}\n */\nconst update = (state, attributeDataSourceKey, data) => {\n\tif (attributeDataSourceKey && data) {\n\t\treturn {\n\t\t\t...state,\n\t\t\tbyDataSourceKey: {\n\t\t\t\t...state.byDataSourceKey,\n\t\t\t\t[attributeDataSourceKey]: state.byDataSourceKey[attributeDataSourceKey]\n\t\t\t\t\t? {...state.byDataSourceKey[attributeDataSourceKey], ...data}\n\t\t\t\t\t: data,\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * @param state {Object}\n * @param attributeDataSourceKey {string} uuid\n * @param data {Object} attribute data\n * @param filter {Object}\n * @param order {Array}\n * @param indexData {Array}\n * @param changedOn {string}\n * @return {Object}\n */\nconst addWithSpatialIndex = (\n\tstate,\n\tattributeDataSourceKey,\n\tdata,\n\tfilter,\n\torder,\n\tindexData,\n\tchangedOn\n) => {\n\tconst byDataSourceKey = {\n\t\t...state.byDataSourceKey,\n\t\t[attributeDataSourceKey]: state.byDataSourceKey[attributeDataSourceKey]\n\t\t\t? {\n\t\t\t\t\t...state.byDataSourceKey[attributeDataSourceKey],\n\t\t\t\t\t...data,\n\t\t\t  }\n\t\t\t: data,\n\t};\n\n\tconst updatedIndexes = commonHelpers.getUpdatedIndexes(\n\t\tstate,\n\t\tfilter,\n\t\torder,\n\t\tindexData,\n\t\tchangedOn,\n\t\t'spatialIndexes'\n\t);\n\n\treturn {...state, byDataSourceKey, spatialIndexes: updatedIndexes};\n};\n\n/**\n * Add data and index in one step to save more mutating state\n * @param state {Object}\n * @param index {Array} ordered index\n * @param data {Object} Object with data\n * @param filter {Array}\n * @param order {Array}\n * @param start {Array}\n * @param total {Array}\n * @param changedOn {string}\n * @return {Object}\n */\nconst addWithIndex = (\n\tstate,\n\tindex,\n\tdata,\n\tfilter,\n\torder,\n\tstart,\n\ttotal,\n\tchangedOn\n) => {\n\t// TODO test commonHelpers.getUpdatedByDataSourceKey properly\n\tconst byDataSourceKey = commonHelpers.getUpdatedByDataSourceKey(\n\t\tstate.byDataSourceKey,\n\t\tdata\n\t);\n\n\t// Fake new data object for common action\n\t// Action \"common.addIndex\" needs array of data objects with key to create new index.\n\t// \"newData\" is a Array of the minimal data for construct index in common actoin.\n\tconst newData = index.map(val => ({key: val}));\n\n\tconst addIndexAction = {\n\t\tfilter,\n\t\torder,\n\t\tdata: newData,\n\t\tstart,\n\t\tcount: total,\n\t\tchangedOn,\n\t};\n\n\tconst stateWithUpdatedIndexes = common.addIndex(state, addIndexAction);\n\n\treturn {...state, byDataSourceKey, indexes: stateWithUpdatedIndexes.indexes};\n};\n\n/**\n * Add spatial index\n * @param state {Object}\n * @param filter {Object}\n * @param order {Array}\n * @param indexData {Array}\n * @param changedOn {string}\n * @return {*&{spatialIndexes: []}}\n */\nconst addSpatialIndex = (state, filter, order, indexData, changedOn) => {\n\tconst updatedIndexes = commonHelpers.getUpdatedIndexes(\n\t\tstate,\n\t\tfilter,\n\t\torder,\n\t\tindexData,\n\t\tchangedOn,\n\t\t'spatialIndexes'\n\t);\n\n\treturn {\n\t\t...state,\n\t\tspatialIndexes: updatedIndexes,\n\t};\n};\n\n/**\n * Remove spatial index that fit to filter and order from state.\n * @param {Object} state\n * @param {Object} filter\n * @param {Object} order\n * @return {Object}\n */\nconst removeSpatialIndex = (state, filter, order) => {\n\tconst updatedIndexes = commonHelpers.removeIndex(\n\t\tstate.spatialIndexes,\n\t\tfilter,\n\t\torder\n\t);\n\n\treturn {\n\t\t...state,\n\t\tspatialIndexes: updatedIndexes,\n\t};\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.DATA.ATTRIBUTE_DATA.ADD:\n\t\t\treturn add(state, action.key, action.data);\n\t\tcase ActionTypes.DATA.ATTRIBUTE_DATA.ADD_WITH_SPATIAL_INDEX:\n\t\t\treturn addWithSpatialIndex(\n\t\t\t\tstate,\n\t\t\t\taction.attributeDataSourceKey,\n\t\t\t\taction.data,\n\t\t\t\taction.filter,\n\t\t\t\taction.order,\n\t\t\t\taction.indexData,\n\t\t\t\taction.changedOn\n\t\t\t);\n\t\tcase ActionTypes.DATA.ATTRIBUTE_DATA.ADD_WITH_INDEX:\n\t\t\treturn addWithIndex(\n\t\t\t\tstate,\n\t\t\t\taction.index,\n\t\t\t\taction.data,\n\t\t\t\taction.filter,\n\t\t\t\taction.order,\n\t\t\t\taction.start,\n\t\t\t\taction.total,\n\t\t\t\taction.changedOn\n\t\t\t);\n\t\tcase ActionTypes.DATA.ATTRIBUTE_DATA.UPDATE:\n\t\t\treturn update(state, action.key, action.data);\n\t\tcase ActionTypes.DATA.ATTRIBUTE_DATA.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.DATA.ATTRIBUTE_DATA.SPATIAL_INDEX.ADD:\n\t\t\treturn addSpatialIndex(\n\t\t\t\tstate,\n\t\t\t\taction.filter,\n\t\t\t\taction.order,\n\t\t\t\taction.indexData,\n\t\t\t\taction.changedOn\n\t\t\t);\n\t\tcase ActionTypes.DATA.ATTRIBUTE_DATA.SPATIAL_INDEX.REMOVE:\n\t\t\treturn removeSpatialIndex(state, action.filter, action.order);\n\t\tcase ActionTypes.DATA.ATTRIBUTE_DATA.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action.data);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import {indexOf as _indexOf, isEmpty as _isEmpty} from 'lodash';\nimport ActionTypes from '../../../constants/ActionTypes';\nimport {stateManagement} from '@gisatcz/ptr-utils';\n\nexport const INITIAL_STATE = {\n\tcomponents: {\n\t\tbyKey: {},\n\t\tinUse: [],\n\t},\n\tsets: {},\n};\n\n/**\n * Remove component key from the list of usages\n * @param state {Object}\n * @param componentKey {string}\n * @return {Object} updated state\n */\nconst componentUseClear = (state, componentKey) => {\n\tif (componentKey && !_isEmpty(state.components.inUse)) {\n\t\tconst index = _indexOf(state.components.inUse, componentKey);\n\t\tif (index > -1) {\n\t\t\tlet updatedInUse = stateManagement.removeItemByIndex(\n\t\t\t\tstate.components.inUse,\n\t\t\t\tindex\n\t\t\t);\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tcomponents: {\n\t\t\t\t\t...state.components,\n\t\t\t\t\tinUse: updatedInUse,\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Add component key to the list of usages\n * @param state {Object}\n * @param componentKey {string}\n * @return {Object} updated state\n */\nconst componentUseRegister = (state, componentKey) => {\n\tif (componentKey) {\n\t\treturn {\n\t\t\t...state,\n\t\t\tcomponents: {\n\t\t\t\t...state.components,\n\t\t\t\tinUse: [...state.components.inUse, componentKey],\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Set attribute keys for given component\n * @param state {Object}\n * @param componentKey {string}\n * @param attributeKeys {Array}\n * @return {Object} updated state\n */\nconst setComponentAttributeKeys = (state, componentKey, attributeKeys) => {\n\tif (componentKey && attributeKeys?.length) {\n\t\treturn {\n\t\t\t...state,\n\t\t\tcomponents: {\n\t\t\t\t...state.components,\n\t\t\t\tbyKey: {\n\t\t\t\t\t...state.components.byKey,\n\t\t\t\t\t[componentKey]: state.components.byKey[componentKey]\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t...state.components.byKey[componentKey],\n\t\t\t\t\t\t\t\tattributeKeys,\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\tattributeKeys,\n\t\t\t\t\t\t  },\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Add or replace components\n * @param state {Object}\n * @param componentsByKey {Object}\n * @return {Object}\n */\nconst addOrReplaceComponents = (state, componentsByKey) => {\n\tif (componentsByKey) {\n\t\treturn {\n\t\t\t...state,\n\t\t\tcomponents: {\n\t\t\t\t...state.components,\n\t\t\t\tbyKey: {\n\t\t\t\t\t...state.components.byKey,\n\t\t\t\t\t...componentsByKey,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.DATA.COMPONENTS.COMPONENT.SET.ATTRIBUTE_KEYS:\n\t\t\treturn setComponentAttributeKeys(\n\t\t\t\tstate,\n\t\t\t\taction.componentKey,\n\t\t\t\taction.attributeKeys\n\t\t\t);\n\t\tcase ActionTypes.DATA.COMPONENTS.COMPONENT.USE.CLEAR:\n\t\t\treturn componentUseClear(state, action.componentKey);\n\t\tcase ActionTypes.DATA.COMPONENTS.COMPONENT.USE.REGISTER:\n\t\t\treturn componentUseRegister(state, action.componentKey);\n\t\tcase ActionTypes.DATA.COMPONENTS.ADD_COMPONENTS:\n\t\t\treturn addOrReplaceComponents(state, action.components);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../../constants/ActionTypes';\nimport common, {DEFAULT_INITIAL_STATE} from '../../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.DATA.SPATIAL_RELATIONS.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.DATA.SPATIAL_RELATIONS.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../../constants/ActionTypes';\nimport common, {DEFAULT_INITIAL_STATE} from '../../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.DATA.SPATIAL_DATA_SOURCES.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.DATA.SPATIAL_DATA_SOURCES.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../../constants/ActionTypes';\nimport {DEFAULT_INITIAL_STATE} from '../../_common/reducers';\nimport {forIn as _forIn} from 'lodash';\nimport commonHelpers from '../../_common/helpers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n\tbyDataSourceKey: {},\n};\n\nconst getEmptyFeature = () => {\n\treturn {\n\t\tgeometries: {},\n\t};\n};\n\n/**\n * Add spatial data\n * @param state {Object}\n * @param action {Object}\n * @param action.key {String} Data source key\n * @param action.level {number} Zoom level\n * @param action.data {Object} Features as object\n * @return {Object}\n */\n\nconst add = (state, action) => {\n\tconst dataSourceKey = action.key;\n\tconst updatedDataForDataSourceKey = getUpdatedDataForDataSourceKey(\n\t\tstate,\n\t\tdataSourceKey,\n\t\taction.data,\n\t\taction.level\n\t);\n\n\treturn {\n\t\t...state,\n\t\tbyDataSourceKey: {\n\t\t\t...state.byDataSourceKey,\n\t\t\t[dataSourceKey]: updatedDataForDataSourceKey,\n\t\t},\n\t};\n};\n\nconst addWithIndex = (state, action) => {\n\tconst updatedByDataSourceKey = getUpdatedByDataSourceKey(\n\t\tstate,\n\t\taction.dataByDataSourceKey,\n\t\taction.level\n\t);\n\tconst updatedIndexes = commonHelpers.getUpdatedIndexes(\n\t\tstate,\n\t\taction.filter,\n\t\taction.order,\n\t\taction.indexData,\n\t\taction.changedOn\n\t);\n\n\treturn {\n\t\t...state,\n\t\tbyDataSourceKey: updatedByDataSourceKey,\n\t\tindexes: updatedIndexes,\n\t};\n};\n\nconst addIndex = (state, action) => {\n\tconst updatedIndexes = commonHelpers.getUpdatedIndexes(\n\t\tstate,\n\t\taction.filter,\n\t\taction.order,\n\t\taction.indexData,\n\t\taction.changedOn\n\t);\n\n\treturn {\n\t\t...state,\n\t\tindexes: updatedIndexes,\n\t};\n};\n\n/**\n * Remove index that fit to filter and order from state.\n * @param {Object} state\n * @param {Object} action\n * @return {Object}\n */\nconst removeIndex = (state, action) => {\n\tconst updatedIndexes = commonHelpers.removeIndex(\n\t\tstate.indexes,\n\t\taction.filter,\n\t\taction.order\n\t);\n\treturn {\n\t\t...state,\n\t\tindexes: updatedIndexes,\n\t};\n};\n\n// helpers\n\n/**\n * @param state {Object}\n * @param dataSourceKey {string} uuid\n * @param featuresAsObject {Object}\n * @param level {number}\n * @return {Object}\n */\nfunction getUpdatedDataForDataSourceKey(\n\tstate,\n\tdataSourceKey,\n\tfeaturesAsObject,\n\tlevel\n) {\n\t// TODO what about features adding without level?\n\tconst dataFeaturesKeys = Object.keys(featuresAsObject);\n\tlet updatedData = state.byDataSourceKey[dataSourceKey]\n\t\t? {...state.byDataSourceKey[dataSourceKey]}\n\t\t: {};\n\n\tdataFeaturesKeys.forEach(featureKey => {\n\t\tif (updatedData.hasOwnProperty(featureKey)) {\n\t\t\t//add just level geometry to existing feature\n\t\t\tupdatedData[featureKey].geometries[level] = featuresAsObject[featureKey];\n\t\t} else {\n\t\t\t//create new feature with geometry and add to state\n\t\t\tconst newFeature = getEmptyFeature();\n\t\t\tnewFeature.geometries[level] = featuresAsObject[featureKey];\n\t\t\tupdatedData = {...updatedData, [featureKey]: {...newFeature}};\n\t\t}\n\t});\n\n\treturn updatedData;\n}\n\nfunction getUpdatedByDataSourceKey(state, dataByDataSourceKey, level) {\n\tlet updatedData = {...state.byDataSourceKey};\n\n\t_forIn(dataByDataSourceKey, (data, dataSourceKey) => {\n\t\tif (!updatedData.hasOwnProperty(dataSourceKey)) {\n\t\t\tupdatedData[dataSourceKey] = {};\n\t\t}\n\n\t\tconst newFeatures = {};\n\t\t_forIn(data, (geometry, featureKey) => {\n\t\t\tconst existingFeature = updatedData[dataSourceKey].hasOwnProperty(\n\t\t\t\tfeatureKey\n\t\t\t);\n\t\t\tif (existingFeature) {\n\t\t\t\t//add just level geometry to existing feature\n\t\t\t\tupdatedData[dataSourceKey][featureKey].geometries[level] = geometry;\n\t\t\t} else {\n\t\t\t\t//create new feature with geometry and add to state\n\t\t\t\tconst newFeature = getEmptyFeature();\n\t\t\t\tnewFeature.geometries[level] = geometry;\n\t\t\t\tnewFeatures[featureKey] = newFeature;\n\t\t\t}\n\t\t});\n\n\t\tupdatedData[dataSourceKey] = {\n\t\t\t...updatedData[dataSourceKey],\n\t\t\t...newFeatures,\n\t\t};\n\t});\n\n\treturn updatedData;\n}\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.DATA.SPATIAL_DATA.ADD:\n\t\t\treturn add(state, action);\n\t\tcase ActionTypes.DATA.SPATIAL_DATA.ADD_WITH_INDEX:\n\t\t\treturn addWithIndex(state, action);\n\t\tcase ActionTypes.DATA.SPATIAL_DATA.INDEX.ADD:\n\t\t\treturn addIndex(state, action);\n\t\tcase ActionTypes.DATA.SPATIAL_DATA.INDEX.REMOVE:\n\t\t\treturn removeIndex(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import {combineReducers} from 'redux';\n\nimport attributeRelations from './AttributeRelations/reducers';\nimport attributeDataSources from './AttributeDataSources/reducers';\nimport attributeData from './AttributeData/reducers';\nimport components from './Components/reducers';\nimport spatialRelations from './SpatialRelations/reducers';\nimport spatialDataSources from './SpatialDataSources/reducers';\nimport spatialData from './SpatialData/reducers';\n\nexport default combineReducers({\n\tattributeData,\n\tattributeDataSources,\n\tattributeRelations,\n\tcomponents,\n\tspatialData,\n\tspatialDataSources,\n\tspatialRelations,\n});\n","import ActionTypes from '../../constants/ActionTypes';\n\nimport common from '../_common/reducers';\n\nimport {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.LAYER_TEMPLATES.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.DELETE:\n\t\t\treturn common.remove(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.EDITED.REMOVE:\n\t\t\treturn common.removeEdited(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.EDITED.REMOVE_ACTIVE:\n\t\t\treturn common.removeEditedActive(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.EDITED.REMOVE_PROPERTY:\n\t\t\treturn common.removeEditedProperty(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.EDITED.UPDATE:\n\t\t\treturn common.updateEdited(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.INDEX.CLEAR_INDEX:\n\t\t\treturn common.clearIndex(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.MARK_DELETED:\n\t\t\treturn common.markDeleted(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.SET_ACTIVE_KEYS:\n\t\t\treturn common.setActiveMultiple(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.LAYER_TEMPLATES.USE.INDEXED.CLEAR_ALL:\n\t\t\treturn common.useIndexedClearAll(state, action);\n\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\treturn common.dataSetOutdated(state, action);\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\treturn common.cleanupOnLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common, {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.LAYER_TREES.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.LAYER_TREES.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.LAYER_TREES.DELETE:\n\t\t\treturn common.remove(state, action);\n\t\tcase ActionTypes.LAYER_TREES.EDITED.REMOVE:\n\t\t\treturn common.removeEdited(state, action);\n\t\tcase ActionTypes.LAYER_TREES.EDITED.REMOVE_PROPERTY:\n\t\t\treturn common.removeEditedProperty(state, action);\n\t\tcase ActionTypes.LAYER_TREES.EDITED.UPDATE:\n\t\t\treturn common.updateEdited(state, action);\n\t\tcase ActionTypes.LAYER_TREES.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.LAYER_TREES.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.LAYER_TREES.INDEX.CLEAR_INDEX:\n\t\t\treturn common.clearIndex(state, action);\n\t\tcase ActionTypes.LAYER_TREES.MARK_DELETED:\n\t\t\treturn common.markDeleted(state, action);\n\t\tcase ActionTypes.LAYER_TREES.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action);\n\t\tcase ActionTypes.LAYER_TREES.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\t\tcase ActionTypes.LAYER_TREES.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.LAYER_TREES.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.LAYER_TREES.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.LAYER_TREES.USE.INDEXED.CLEAR_ALL:\n\t\t\treturn common.useIndexedClearAll(state, action);\n\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\treturn common.dataSetOutdated(state, action);\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\treturn common.cleanupOnLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport {stateManagement} from '@gisatcz/ptr-utils';\nimport {\n\tfindIndex as _findIndex,\n\tindexOf as _indexOf,\n\tisEmpty as _isEmpty,\n} from 'lodash';\n\nexport const INITIAL_STATE = {\n\tactiveSetKey: null,\n\tactiveMapKey: null,\n\tinUse: {\n\t\tmaps: [],\n\t\tsets: [],\n\t},\n\tmaps: {},\n\tsets: {},\n};\n\n/**\n * Set active map key\n * @param state {Object}\n * @param mapKey {string}\n * @return {Object} updated state\n */\nconst setActiveMapKey = (state, mapKey) => {\n\tif (mapKey) {\n\t\treturn {...state, activeMapKey: mapKey};\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Remove map from map set\n * @param state {Object}\n * @param setKey {string}\n * @param mapKey {string}\n * @return {Object} updated state\n */\nconst removeMapFromSet = (state, setKey, mapKey) => {\n\tif (setKey && mapKey) {\n\t\tconst index = _indexOf(state.sets[setKey]?.maps, mapKey);\n\t\tif (index > -1) {\n\t\t\tlet updatedMaps = stateManagement.removeItemByIndex(\n\t\t\t\tstate.sets[setKey].maps,\n\t\t\t\tindex\n\t\t\t);\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tsets: {\n\t\t\t\t\t...state.sets,\n\t\t\t\t\t[setKey]: {\n\t\t\t\t\t\t...state.sets[setKey],\n\t\t\t\t\t\tmaps: updatedMaps,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Remove layer from map\n * @param state {Object}\n * @param mapKey {string}\n * @param layerKey {string}\n * @return {Object} Updated state\n */\nconst removeMapLayer = (state, mapKey, layerKey) => {\n\tif (layerKey && mapKey) {\n\t\tconst index = _findIndex(state.maps[mapKey]?.data.layers, {key: layerKey});\n\t\tif (index > -1) {\n\t\t\tlet updatedLayers = stateManagement.removeItemByIndex(\n\t\t\t\tstate.maps[mapKey]?.data.layers,\n\t\t\t\tindex\n\t\t\t);\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tmaps: {\n\t\t\t\t\t...state.maps,\n\t\t\t\t\t[mapKey]: {\n\t\t\t\t\t\t...state.maps[mapKey],\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t...state.maps[mapKey].data,\n\t\t\t\t\t\t\tlayers: updatedLayers,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Add layer states to map\n * @param state {Object}\n * @param mapKey {string}\n * @param layerStates {Array} A collection, where each object represents state of the layer\n * @return {Object} updated state\n */\nconst addMapLayers = (state, mapKey, layerStates) => {\n\tif (mapKey && layerStates && state.maps?.[mapKey]) {\n\t\treturn {\n\t\t\t...state,\n\t\t\tmaps: {\n\t\t\t\t...state.maps,\n\t\t\t\t[mapKey]: {\n\t\t\t\t\t...state.maps[mapKey],\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t...state.maps[mapKey].data,\n\t\t\t\t\t\tlayers: state.maps[mapKey].data.layers\n\t\t\t\t\t\t\t? [...state.maps[mapKey].data.layers, ...layerStates]\n\t\t\t\t\t\t\t: layerStates,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Add layer to the specific position\n * @param state {Object}\n * @param mapKey {string}\n * @param layerState {Object}\n * @param index {number}\n * @return {Object} updated state\n */\nconst addMapLayerToIndex = (state, mapKey, layerState, index) => {\n\tif (mapKey && layerState && state.maps?.[mapKey]) {\n\t\tlet updatedLayers;\n\t\tconst currentLayers = state.maps[mapKey].data?.layers;\n\t\tif (currentLayers) {\n\t\t\tif (index > -1 && index < currentLayers.length) {\n\t\t\t\tupdatedLayers = stateManagement.addItemToIndex(\n\t\t\t\t\tcurrentLayers,\n\t\t\t\t\tindex,\n\t\t\t\t\tlayerState\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tupdatedLayers = [...currentLayers, layerState];\n\t\t\t}\n\t\t} else {\n\t\t\tupdatedLayers = [layerState];\n\t\t}\n\n\t\treturn {\n\t\t\t...state,\n\t\t\tmaps: {\n\t\t\t\t...state.maps,\n\t\t\t\t[mapKey]: {\n\t\t\t\t\t...state.maps[mapKey],\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t...state.maps[mapKey].data,\n\t\t\t\t\t\tlayers: updatedLayers,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Set styleKey to the specific layer of the specific map\n * @param state {Object}\n * @param mapKey {string}\n * @param layerKey {string}\n * @param styleKey {string} uuid\n * @return {Object} state\n */\nconst setMapLayerStyleKey = (state, mapKey, layerKey, styleKey) => {\n\tconst layers = state.maps[mapKey]?.data?.layers;\n\n\tif (layers) {\n\t\tconst updatedLayers = layers.map(item => {\n\t\t\tif (item.key === layerKey) {\n\t\t\t\treturn {\n\t\t\t\t\t...item,\n\t\t\t\t\tstyleKey,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\t...state,\n\t\t\tmaps: {\n\t\t\t\t...state.maps,\n\t\t\t\t[mapKey]: {\n\t\t\t\t\t...state.maps[mapKey],\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t...state.maps[mapKey].data,\n\t\t\t\t\t\tlayers: updatedLayers,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Set map layer option\n * @param state {Object}\n * @param mapKey {string}\n * @param layerKey {string}\n * @param optionKey {string}\n * @param optionValue {*}\n * @return {Object} state\n */\nconst setMapLayerOption = (state, mapKey, layerKey, optionKey, optionValue) => {\n\tconst layers = state.maps[mapKey]?.data?.layers;\n\n\tif (layers) {\n\t\tconst updatedLayers = layers.map(item => {\n\t\t\tif (item.key === layerKey) {\n\t\t\t\treturn {\n\t\t\t\t\t...item,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\t...item.options,\n\t\t\t\t\t\t[optionKey]: optionValue,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\t...state,\n\t\t\tmaps: {\n\t\t\t\t...state.maps,\n\t\t\t\t[mapKey]: {\n\t\t\t\t\t...state.maps[mapKey],\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t...state.maps[mapKey].data,\n\t\t\t\t\t\tlayers: updatedLayers,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Set map width and height\n * @param state {Object}\n * @param mapKey {string}\n * @param width {number} map width in px\n * @param height {number} map height in px\n * @return {Object} state\n */\nconst setMapViewport = (state, mapKey, width, height) => {\n\tif (mapKey && width && height) {\n\t\treturn {\n\t\t\t...state,\n\t\t\tmaps: {\n\t\t\t\t...state.maps,\n\t\t\t\t[mapKey]: {\n\t\t\t\t\t...state.maps[mapKey],\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t...state.maps[mapKey].data,\n\t\t\t\t\t\tviewport: {\n\t\t\t\t\t\t\twidth,\n\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Set active map of the map set\n * @param state {Object}\n * @param setKey {string}\n * @param mapKey {string}\n * @return {Object} state\n */\nconst setSetActiveMapKey = (state, setKey, mapKey) => {\n\treturn {\n\t\t...state,\n\t\tsets: {\n\t\t\t...state.sets,\n\t\t\t[setKey]: {\n\t\t\t\t...state.sets[setKey],\n\t\t\t\tactiveMapKey: mapKey,\n\t\t\t},\n\t\t},\n\t};\n};\n\n/**\n * Set map set background layer state\n * @param state {Object}\n * @param setKey {string}\n * @param backgroundLayer {Object} background layer state\n * @return {Object} state\n */\nconst setSetBackgroundLayer = (state, setKey, backgroundLayer) => {\n\treturn {\n\t\t...state,\n\t\tsets: {\n\t\t\t...state.sets,\n\t\t\t[setKey]: {\n\t\t\t\t...state.sets[setKey],\n\t\t\t\tdata: {\n\t\t\t\t\t...state.sets[setKey].data,\n\t\t\t\t\tbackgroundLayer,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t};\n};\n\n/**\n * Set map background layer state\n * @param state {Object}\n * @param mapKey {string}\n * @param backgroundLayer {Object} background layer state\n * @return {Object} state\n */\nconst setMapBackgroundLayer = (state, mapKey, backgroundLayer) => {\n\treturn {\n\t\t...state,\n\t\tmaps: {\n\t\t\t...state.maps,\n\t\t\t[mapKey]: {\n\t\t\t\t...state.maps[mapKey],\n\t\t\t\tdata: {\n\t\t\t\t\t...state.maps[mapKey].data,\n\t\t\t\t\tbackgroundLayer,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t};\n};\n\n/**\n * Set map set layers state\n * @param state {Object}\n * @param setKey {string}\n * @param layers {Object} layers state\n * @return {Object} state\n */\nconst setSetLayers = (state, setKey, layers) => {\n\tif (setKey && layers && state.sets[setKey]) {\n\t\treturn {\n\t\t\t...state,\n\t\t\tsets: {\n\t\t\t\t...state.sets,\n\t\t\t\t[setKey]: {\n\t\t\t\t\t...state.sets[setKey],\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t...state.sets[setKey].data,\n\t\t\t\t\t\tlayers,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Update whole map state\n * @param state {Object}\n * @param data {Object}\n * @return {Object}\n */\nconst update = (state, data) => {\n\treturn {...state, ...data};\n};\n\n/**\n * Update map view\n * @param state {Object}\n * @param mapKey {string}\n * @param updates {Object} map view updates\n * @return {Object} state\n */\nconst updateMapView = (state, mapKey, updates) => {\n\tif (updates && !_isEmpty(updates)) {\n\t\treturn {\n\t\t\t...state,\n\t\t\tmaps: {\n\t\t\t\t...state.maps,\n\t\t\t\t[mapKey]: {\n\t\t\t\t\t...state.maps[mapKey],\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t...state.maps[mapKey].data,\n\t\t\t\t\t\tview: state.maps[mapKey].data.view\n\t\t\t\t\t\t\t? {...state.maps[mapKey].data.view, ...updates}\n\t\t\t\t\t\t\t: updates,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Update map set view\n * @param state {Object}\n * @param setKey {string}\n * @param updates {Object} map view updates\n * @return {Object} state\n */\nconst updateSetView = (state, setKey, updates) => {\n\tif (updates && !_isEmpty(updates)) {\n\t\treturn {\n\t\t\t...state,\n\t\t\tsets: {\n\t\t\t\t...state.sets,\n\t\t\t\t[setKey]: {\n\t\t\t\t\t...state.sets[setKey],\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t...state.sets[setKey].data,\n\t\t\t\t\t\tview: state.sets[setKey].data.view\n\t\t\t\t\t\t\t? {...state.sets[setKey].data.view, ...updates}\n\t\t\t\t\t\t\t: updates,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Remove map usage\n * @param state {Object}\n * @param mapKey {string}\n * @return {Object} state\n */\nconst mapUseClear = (state, mapKey) => {\n\tif (mapKey) {\n\t\tconst index = _indexOf(state.inUse.maps, mapKey);\n\t\tif (index > -1) {\n\t\t\tconst updatedInUse = stateManagement.removeItemByIndex(\n\t\t\t\tstate.inUse.maps,\n\t\t\t\tindex\n\t\t\t);\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tinUse: {\n\t\t\t\t\t...state.inUse,\n\t\t\t\t\tmaps: updatedInUse,\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Remove map set usage\n * @param state {Object}\n * @param mapSetKey {string}\n * @return {Object} state\n */\nconst mapSetUseClear = (state, mapSetKey) => {\n\tif (mapSetKey) {\n\t\tconst index = _indexOf(state.inUse.sets, mapSetKey);\n\t\tif (index > -1) {\n\t\t\tconst updatedInUse = stateManagement.removeItemByIndex(\n\t\t\t\tstate.inUse.sets,\n\t\t\t\tindex\n\t\t\t);\n\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tinUse: {\n\t\t\t\t\t...state.inUse,\n\t\t\t\t\tsets: updatedInUse,\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\treturn state;\n\t\t}\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Register map usage\n * @param state {Object}\n * @param mapKey {string}\n * @return {Object} state\n */\nconst mapUseRegister = (state, mapKey) => {\n\tif (mapKey) {\n\t\treturn {\n\t\t\t...state,\n\t\t\tinUse: {\n\t\t\t\t...state.inUse,\n\t\t\t\tmaps: [...state.inUse.maps, mapKey],\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\n/**\n * Register map set usage\n * @param state {Object}\n * @param mapSetKey {string}\n * @return {Object} state\n */\nconst mapSetUseRegister = (state, mapSetKey) => {\n\tif (mapSetKey) {\n\t\treturn {\n\t\t\t...state,\n\t\t\tinUse: {\n\t\t\t\t...state.inUse,\n\t\t\t\tsets: [...state.inUse.sets, mapSetKey],\n\t\t\t},\n\t\t};\n\t} else {\n\t\treturn state;\n\t}\n};\n\nexport default function tasksReducer(state = INITIAL_STATE, action) {\n\tswitch (action.type) {\n\t\tcase ActionTypes.MAPS.MAP.LAYERS.ADD:\n\t\t\treturn addMapLayers(state, action.mapKey, action.layerStates);\n\t\tcase ActionTypes.MAPS.MAP.LAYERS.ADD_TO_INDEX:\n\t\t\treturn addMapLayerToIndex(\n\t\t\t\tstate,\n\t\t\t\taction.mapKey,\n\t\t\t\taction.layerState,\n\t\t\t\taction.index\n\t\t\t);\n\t\tcase ActionTypes.MAPS.MAP.LAYERS.REMOVE_LAYER:\n\t\t\treturn removeMapLayer(state, action.mapKey, action.layerKey);\n\t\tcase ActionTypes.MAPS.MAP.LAYERS.SET_OPTION:\n\t\t\treturn setMapLayerOption(\n\t\t\t\tstate,\n\t\t\t\taction.mapKey,\n\t\t\t\taction.layerKey,\n\t\t\t\taction.optionKey,\n\t\t\t\taction.optionValue\n\t\t\t);\n\t\tcase ActionTypes.MAPS.MAP.LAYERS.SET_STYLE_KEY:\n\t\t\treturn setMapLayerStyleKey(\n\t\t\t\tstate,\n\t\t\t\taction.mapKey,\n\t\t\t\taction.layerKey,\n\t\t\t\taction.styleKey\n\t\t\t);\n\t\tcase ActionTypes.MAPS.MAP.USE.CLEAR:\n\t\t\treturn mapUseClear(state, action.mapKey);\n\t\tcase ActionTypes.MAPS.MAP.USE.REGISTER:\n\t\t\treturn mapUseRegister(state, action.mapKey);\n\t\tcase ActionTypes.MAPS.MAP.VIEW.UPDATE:\n\t\t\treturn updateMapView(state, action.mapKey, action.update);\n\t\tcase ActionTypes.MAPS.MAP.VIEWPORT.SET:\n\t\t\treturn setMapViewport(state, action.mapKey, action.width, action.height);\n\t\tcase ActionTypes.MAPS.MAP.SET_BACKGROUND_LAYER:\n\t\t\treturn setMapBackgroundLayer(\n\t\t\t\tstate,\n\t\t\t\taction.mapKey,\n\t\t\t\taction.backgroundLayer\n\t\t\t);\n\t\tcase ActionTypes.MAPS.SET.REMOVE_MAP:\n\t\t\treturn removeMapFromSet(state, action.setKey, action.mapKey);\n\t\tcase ActionTypes.MAPS.SET.SET_ACTIVE_MAP_KEY:\n\t\t\treturn setSetActiveMapKey(state, action.setKey, action.mapKey);\n\t\tcase ActionTypes.MAPS.SET.SET_BACKGROUND_LAYER:\n\t\t\treturn setSetBackgroundLayer(\n\t\t\t\tstate,\n\t\t\t\taction.setKey,\n\t\t\t\taction.backgroundLayer\n\t\t\t);\n\t\tcase ActionTypes.MAPS.SET.SET_LAYERS:\n\t\t\treturn setSetLayers(state, action.setKey, action.layers);\n\t\tcase ActionTypes.MAPS.SET.USE.CLEAR:\n\t\t\treturn mapSetUseClear(state, action.mapSetKey);\n\t\tcase ActionTypes.MAPS.SET.USE.REGISTER:\n\t\t\treturn mapSetUseRegister(state, action.mapSetKey);\n\t\tcase ActionTypes.MAPS.SET.VIEW.UPDATE:\n\t\t\treturn updateSetView(state, action.setKey, action.update);\n\t\tcase ActionTypes.MAPS.SET_ACTIVE_MAP_KEY:\n\t\t\treturn setActiveMapKey(state, action.mapKey);\n\t\tcase ActionTypes.MAPS.UPDATE:\n\t\t\treturn update(state, action.data);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n}\n","import ActionTypes from '../../constants/ActionTypes';\nimport common from '../_common/reducers';\n\nimport {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.PERIODS.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.PERIODS.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.PERIODS.DELETE:\n\t\t\treturn common.remove(state, action);\n\t\tcase ActionTypes.PERIODS.EDITED.REMOVE:\n\t\t\treturn common.removeEdited(state, action);\n\t\tcase ActionTypes.PERIODS.EDITED.REMOVE_ACTIVE:\n\t\t\treturn common.removeEditedActive(state, action);\n\t\tcase ActionTypes.PERIODS.EDITED.REMOVE_PROPERTY:\n\t\t\treturn common.removeEditedProperty(state, action);\n\t\tcase ActionTypes.PERIODS.EDITED.UPDATE:\n\t\t\treturn common.updateEdited(state, action);\n\t\tcase ActionTypes.PERIODS.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.PERIODS.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.PERIODS.INDEX.CLEAR_INDEX:\n\t\t\treturn common.clearIndex(state, action);\n\t\tcase ActionTypes.PERIODS.MARK_DELETED:\n\t\t\treturn common.markDeleted(state, action);\n\t\tcase ActionTypes.PERIODS.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.PERIODS.SET_ACTIVE_KEYS:\n\t\t\treturn common.setActiveMultiple(state, action);\n\t\tcase ActionTypes.PERIODS.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action);\n\t\tcase ActionTypes.PERIODS.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.PERIODS.USE.INDEXED.CLEAR_ALL:\n\t\t\treturn common.useIndexedClearAll(state, action);\n\t\tcase ActionTypes.PERIODS.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.PERIODS.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.PERIODS.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\treturn common.dataSetOutdated(state, action);\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\treturn common.cleanupOnLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common from '../_common/reducers';\n\nimport {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n\tactiveKeys: null,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.PLACES.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.PLACES.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.PLACES.DELETE:\n\t\t\treturn common.remove(state, action);\n\t\tcase ActionTypes.PLACES.EDITED.REMOVE:\n\t\t\treturn common.removeEdited(state, action);\n\t\tcase ActionTypes.PLACES.EDITED.REMOVE_ACTIVE:\n\t\t\treturn common.removeEditedActive(state, action);\n\t\tcase ActionTypes.PLACES.EDITED.REMOVE_PROPERTY:\n\t\t\treturn common.removeEditedProperty(state, action);\n\t\tcase ActionTypes.PLACES.EDITED.UPDATE:\n\t\t\treturn common.updateEdited(state, action);\n\t\tcase ActionTypes.PLACES.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.PLACES.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.PLACES.INDEX.CLEAR_INDEX:\n\t\t\treturn common.clearIndex(state, action);\n\t\tcase ActionTypes.PLACES.MARK_DELETED:\n\t\t\treturn common.markDeleted(state, action);\n\t\tcase ActionTypes.PLACES.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.PLACES.SET_ACTIVE_KEYS:\n\t\t\treturn common.setActiveMultiple(state, action);\n\t\tcase ActionTypes.PLACES.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action);\n\t\tcase ActionTypes.PLACES.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.PLACES.USE.INDEXED.CLEAR_ALL:\n\t\t\treturn common.useIndexedClearAll(state, action);\n\t\tcase ActionTypes.PLACES.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.PLACES.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.PLACES.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\treturn common.dataSetOutdated(state, action);\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\treturn common.cleanupOnLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common, {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.SCENARIOS.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.SCENARIOS.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.SCENARIOS.DELETE:\n\t\t\treturn common.remove(state, action);\n\t\tcase ActionTypes.SCENARIOS.EDITED.REMOVE:\n\t\t\treturn common.removeEdited(state, action);\n\t\tcase ActionTypes.SCENARIOS.EDITED.REMOVE_ACTIVE:\n\t\t\treturn common.removeEditedActive(state, action);\n\t\tcase ActionTypes.SCENARIOS.EDITED.REMOVE_PROPERTY:\n\t\t\treturn common.removeEditedProperty(state, action);\n\t\tcase ActionTypes.SCENARIOS.EDITED.UPDATE:\n\t\t\treturn common.updateEdited(state, action);\n\t\tcase ActionTypes.SCENARIOS.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.SCENARIOS.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.SCENARIOS.INDEX.CLEAR_INDEX:\n\t\t\treturn common.clearIndex(state, action);\n\t\tcase ActionTypes.SCENARIOS.MARK_DELETED:\n\t\t\treturn common.markDeleted(state, action);\n\t\tcase ActionTypes.SCENARIOS.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.SCENARIOS.SET_ACTIVE_KEYS:\n\t\t\treturn common.setActiveMultiple(state, action);\n\t\tcase ActionTypes.SCENARIOS.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action);\n\t\tcase ActionTypes.SCENARIOS.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\t\tcase ActionTypes.SCENARIOS.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.SCENARIOS.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.SCENARIOS.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.SCENARIOS.USE.INDEXED.CLEAR_ALL:\n\t\t\treturn common.useIndexedClearAll(state, action);\n\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\treturn common.dataSetOutdated(state, action);\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\treturn common.cleanupOnLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common, {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.SCOPES.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.SCOPES.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.SCOPES.DELETE:\n\t\t\treturn common.remove(state, action);\n\t\tcase ActionTypes.SCOPES.EDITED.REMOVE:\n\t\t\treturn common.removeEdited(state, action);\n\t\tcase ActionTypes.SCOPES.EDITED.REMOVE_ACTIVE:\n\t\t\treturn common.removeEditedActive(state, action);\n\t\tcase ActionTypes.SCOPES.EDITED.REMOVE_PROPERTY:\n\t\t\treturn common.removeEditedProperty(state, action);\n\t\tcase ActionTypes.SCOPES.EDITED.UPDATE:\n\t\t\treturn common.updateEdited(state, action);\n\t\tcase ActionTypes.SCOPES.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.SCOPES.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.SCOPES.INDEX.CLEAR_INDEX:\n\t\t\treturn common.clearIndex(state, action);\n\t\tcase ActionTypes.SCOPES.MARK_DELETED:\n\t\t\treturn common.markDeleted(state, action);\n\t\tcase ActionTypes.SCOPES.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.SCOPES.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action);\n\t\tcase ActionTypes.SCOPES.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.SCOPES.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.SCOPES.USE.INDEXED.CLEAR_ALL:\n\t\t\treturn common.useIndexedClearAll(state, action);\n\t\tcase ActionTypes.SCOPES.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.SCOPES.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\treturn common.dataSetOutdated(state, action);\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\treturn common.cleanupOnLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport _ from 'lodash';\n\nconst INITIAL_STATE = {\n\tscreens: {},\n\tsets: {},\n};\n\nconst INITIAL_SET_STATE = {\n\torderByHistory: [],\n\torderBySpace: [],\n};\n\nconst INITIAL_SCREEN_DATA = {\n\twidth: null,\n\tminActiveWidth: null,\n\tdesiredState: 'open', //open/retracted/closing\n};\n\nconst add = (state, action) => {\n\tlet screens = {...state.screens};\n\n\tscreens[action.lineage] = {\n\t\tlineage: action.lineage,\n\t\tdata: {...INITIAL_SCREEN_DATA, ...action.data},\n\t};\n\n\tlet sets = {...state.sets};\n\tsets[action.setKey] = {...INITIAL_SET_STATE, ...sets[action.setKey]};\n\tsets[action.setKey].orderBySpace = [\n\t\t...sets[action.setKey].orderBySpace,\n\t\taction.lineage,\n\t];\n\tsets[action.setKey].orderByHistory = [\n\t\t...sets[action.setKey].orderByHistory,\n\t\taction.lineage,\n\t];\n\n\treturn {...state, screens, sets};\n};\n\nconst addSet = (state, action) => {\n\tlet sets = {...state.sets};\n\tsets[action.setKey] = {...INITIAL_SET_STATE};\n\treturn {...state, sets};\n};\n\nconst close = (state, action) => {\n\tlet screens = {...state.screens};\n\n\tscreens[action.lineage] = {\n\t\tlineage: action.lineage,\n\t\tdata: {...screens[action.lineage].data, desiredState: 'closing'},\n\t};\n\n\treturn {...state, screens};\n};\n\nconst open = (state, action) => {\n\tlet screens = {...state.screens};\n\n\tscreens[action.lineage] = {\n\t\tlineage: action.lineage,\n\t\tdata: {...screens[action.lineage].data, desiredState: 'open'},\n\t};\n\n\treturn {...state, screens};\n};\n\nconst remove = (state, action) => {\n\tlet sets = {...state.sets};\n\tlet orderByHistory = _.without(\n\t\t[...sets[action.setKey].orderByHistory],\n\t\taction.lineage\n\t);\n\tlet orderBySpace = _.without(\n\t\t[...sets[action.setKey].orderBySpace],\n\t\taction.lineage\n\t);\n\n\treturn {\n\t\t...state,\n\t\tsets: {...sets, [action.setKey]: {orderByHistory, orderBySpace}},\n\t};\n};\n\nconst removeAllScreensFromSet = (state, action) => {\n\tlet sets = {...state.sets};\n\treturn {\n\t\t...state,\n\t\tsets: {...sets, [action.setKey]: {orderByHistory: [], orderBySpace: []}},\n\t};\n};\n\nconst retract = (state, action) => {\n\tlet screens = {...state.screens};\n\n\tscreens[action.lineage] = {\n\t\tlineage: action.lineage,\n\t\tdata: {...screens[action.lineage].data, desiredState: 'retracted'},\n\t};\n\n\treturn {...state, screens};\n};\n\nconst topHistory = (state, action) => {\n\tlet sets = {...state.sets};\n\tlet orderByHistory = _.without(\n\t\t[...sets[action.setKey].orderByHistory],\n\t\taction.lineage\n\t);\n\torderByHistory.push(action.lineage);\n\n\treturn {\n\t\t...state,\n\t\tsets: {\n\t\t\t...sets,\n\t\t\t[action.setKey]: {\n\t\t\t\t...sets[action.setKey],\n\t\t\t\torderByHistory,\n\t\t\t},\n\t\t},\n\t};\n};\n\n// TODO test properly!\nconst update = (state, action) => {\n\tlet screens = {...state.screens};\n\n\tscreens[action.lineage] = {\n\t\t...screens[action.lineage],\n\t\tdata: {...screens[action.lineage].data, ...action.data},\n\t};\n\n\tlet sets = {...state.sets};\n\tsets[action.setKey] = {...INITIAL_SET_STATE, ...sets[action.setKey]};\n\n\tlet orderByHistory = _.without(\n\t\tsets[action.setKey].orderByHistory,\n\t\taction.lineage\n\t);\n\torderByHistory.push(action.lineage);\n\tsets[action.setKey].orderByHistory = orderByHistory;\n\n\tlet alreadyInOrder = _.find(\n\t\tsets[action.setKey].orderBySpace,\n\t\tlineage => lineage === action.lineage\n\t);\n\tif (!alreadyInOrder) {\n\t\tlet orderBySpace = _.without(\n\t\t\tsets[action.setKey].orderBySpace,\n\t\t\taction.lineage\n\t\t);\n\t\torderBySpace.push(action.lineage);\n\t\tsets[action.setKey].orderBySpace = orderBySpace;\n\t}\n\n\treturn {...state, screens, sets};\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.SCREENS.ADD:\n\t\t\treturn add(state, action);\n\t\tcase ActionTypes.SCREENS.CLOSE:\n\t\t\treturn close(state, action);\n\t\tcase ActionTypes.SCREENS.OPEN:\n\t\t\treturn open(state, action);\n\t\tcase ActionTypes.SCREENS.REMOVE:\n\t\t\treturn remove(state, action);\n\t\tcase ActionTypes.SCREENS.REMOVE_ALL:\n\t\t\treturn removeAllScreensFromSet(state, action);\n\t\tcase ActionTypes.SCREENS.RETRACT:\n\t\t\treturn retract(state, action);\n\t\tcase ActionTypes.SCREENS.SETS.ADD:\n\t\t\treturn addSet(state, action);\n\t\tcase ActionTypes.SCREENS.TOP_HISTORY:\n\t\t\treturn topHistory(state, action);\n\t\tcase ActionTypes.SCREENS.UPDATE:\n\t\t\treturn update(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common, {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nconst INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nconst clearFeatureKeysFilter = (state, key) => {\n\tlet updatedByKey = {\n\t\t...state.byKey,\n\t\t[key]: {\n\t\t\t...state.byKey[key],\n\t\t\tdata: {\n\t\t\t\t...state.byKey[key].data,\n\t\t\t\tfeatureKeysFilter: null,\n\t\t\t},\n\t\t},\n\t};\n\n\treturn {...state, byKey: updatedByKey};\n};\n\nconst setFeatureKeysFilterKeys = (state, key, featureKeys) => {\n\tlet updatedByKey = {\n\t\t...state.byKey,\n\t\t[key]: {\n\t\t\t...state.byKey[key],\n\t\t\tdata: {\n\t\t\t\t...state.byKey[key].data,\n\t\t\t\tfeatureKeysFilter: {\n\t\t\t\t\t...state.byKey[key].data.featureKeysFilter,\n\t\t\t\t\tkeys: featureKeys,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t};\n\n\treturn {...state, byKey: updatedByKey};\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.SELECTIONS.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.SELECTIONS.CLEAR.FEATURE_KEYS_FILTER:\n\t\t\treturn clearFeatureKeysFilter(state, action.key);\n\t\tcase ActionTypes.SELECTIONS.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.SELECTIONS.SET.FEATURE_KEYS_FILTER.KEYS:\n\t\t\treturn setFeatureKeysFilterKeys(state, action.key, action.featureKeys);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\n\nimport common, {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.STYLES.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.STYLES.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.STYLES.DELETE:\n\t\t\treturn common.remove(state, action);\n\t\tcase ActionTypes.STYLES.EDITED.REMOVE:\n\t\t\treturn common.removeEdited(state, action);\n\t\tcase ActionTypes.STYLES.EDITED.REMOVE_ACTIVE:\n\t\t\treturn common.removeEditedActive(state, action);\n\t\tcase ActionTypes.STYLES.EDITED.REMOVE_PROPERTY:\n\t\t\treturn common.removeEditedProperty(state, action);\n\t\tcase ActionTypes.STYLES.EDITED.UPDATE:\n\t\t\treturn common.updateEdited(state, action);\n\t\tcase ActionTypes.STYLES.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.STYLES.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.STYLES.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action);\n\t\tcase ActionTypes.STYLES.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.STYLES.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\t\tcase ActionTypes.STYLES.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.STYLES.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.STYLES.USE.INDEXED.CLEAR_ALL:\n\t\t\treturn common.useIndexedClearAll(state, action);\n\t\tcase ActionTypes.STYLES.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.STYLES.INDEX.CLEAR_INDEX:\n\t\t\treturn common.clearIndex(state, action);\n\t\tcase ActionTypes.STYLES.MARK_DELETED:\n\t\t\treturn common.markDeleted(state, action);\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\treturn common.dataSetOutdated(state, action);\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\treturn common.cleanupOnLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common, {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.TAGS.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.TAGS.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.TAGS.DELETE:\n\t\t\treturn common.remove(state, action);\n\t\tcase ActionTypes.TAGS.EDITED.REMOVE:\n\t\t\treturn common.removeEdited(state, action);\n\t\tcase ActionTypes.TAGS.EDITED.REMOVE_ACTIVE:\n\t\t\treturn common.removeEditedActive(state, action);\n\t\tcase ActionTypes.TAGS.EDITED.REMOVE_PROPERTY:\n\t\t\treturn common.removeEditedProperty(state, action);\n\t\tcase ActionTypes.TAGS.EDITED.UPDATE:\n\t\t\treturn common.updateEdited(state, action);\n\t\tcase ActionTypes.TAGS.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.TAGS.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.TAGS.INDEX.CLEAR_INDEX:\n\t\t\treturn common.clearIndex(state, action);\n\t\tcase ActionTypes.TAGS.MARK_DELETED:\n\t\t\treturn common.markDeleted(state, action);\n\t\tcase ActionTypes.TAGS.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.TAGS.SET_ACTIVE_KEYS:\n\t\t\treturn common.setActiveMultiple(state, action);\n\t\tcase ActionTypes.TAGS.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action);\n\t\tcase ActionTypes.TAGS.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\t\tcase ActionTypes.TAGS.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.TAGS.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.TAGS.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.TAGS.USE.INDEXED.CLEAR_ALL:\n\t\t\treturn common.useIndexedClearAll(state, action);\n\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\treturn common.dataSetOutdated(state, action);\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\treturn common.cleanupOnLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport _ from 'lodash';\n\nimport common from '../_common/reducers';\n\nimport {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nconst INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n\tgroups: {...DEFAULT_INITIAL_STATE},\n};\n\nfunction update(state, action) {\n\tlet {userId, ...data} = action.data;\n\tdata.activeKey = action.data.userId;\n\n\treturn {...state, ...data};\n}\n\nfunction loadRequest(state, action) {\n\treturn {...state, loading: true};\n}\nfunction loadRequestError(state, action) {\n\treturn {...state, loading: false};\n}\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.USERS.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.USERS.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.USERS.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.USERS.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.USERS.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.USERS.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.USERS.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.USERS.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\t\tcase ActionTypes.USERS.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\t//set outdated for users and users.groups\n\t\t\treturn {\n\t\t\t\t...common.dataSetOutdated(state, action),\n\t\t\t\tgroups: common.dataSetOutdated(state.groups, action),\n\t\t\t};\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\t//clear users and users.groups\n\t\t\treturn {\n\t\t\t\t...common.cleanupOnLogout(state, action),\n\t\t\t\tgroups: common.cleanupOnLogout(state.groups, action),\n\t\t\t};\n\t\tcase ActionTypes.USERS_LOAD_REQUEST:\n\t\t\treturn loadRequest(state, action);\n\t\tcase ActionTypes.USERS_LOAD_REQUEST_ERROR:\n\t\t\treturn loadRequestError(state, action);\n\t\tcase ActionTypes.USERS_UPDATE:\n\t\t\treturn update(state, action);\n\t\tcase ActionTypes.USERS.GROUPS.ADD:\n\t\t\treturn {...state, groups: common.add(state.groups, action)};\n\t\tcase ActionTypes.USERS.GROUPS.INDEX.ADD:\n\t\t\treturn {...state, groups: common.addIndex(state.groups, action)};\n\t\tcase ActionTypes.USERS.GROUPS.INDEX.CLEAR_ALL:\n\t\t\treturn {...state, groups: common.clearIndexes(state.groups, action)};\n\t\tcase ActionTypes.USERS.GROUPS.ADD_UNRECEIVED:\n\t\t\treturn {...state, groups: common.addUnreceivedKeys(state.groups, action)};\n\t\tcase ActionTypes.USERS.GROUPS.USE.INDEXED.CLEAR:\n\t\t\treturn {...state, groups: common.useIndexedClear(state.groups, action)};\n\t\tcase ActionTypes.USERS.GROUPS.USE.KEYS.CLEAR:\n\t\t\treturn {...state, groups: common.useKeysClear(state.groups, action)};\n\t\tcase ActionTypes.USERS.GROUPS.USE.INDEXED.REGISTER:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tgroups: common.registerUseIndexed(state.groups, action),\n\t\t\t};\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport common, {DEFAULT_INITIAL_STATE} from '../_common/reducers';\n\nexport const INITIAL_STATE = {\n\t...DEFAULT_INITIAL_STATE,\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.VIEWS.ADD:\n\t\t\treturn common.add(state, action);\n\t\tcase ActionTypes.VIEWS.ADD_UNRECEIVED:\n\t\t\treturn common.addUnreceivedKeys(state, action);\n\t\tcase ActionTypes.VIEWS.DELETE:\n\t\t\treturn common.remove(state, action);\n\t\tcase ActionTypes.VIEWS.EDITED.REMOVE:\n\t\t\treturn common.removeEdited(state, action);\n\t\tcase ActionTypes.VIEWS.EDITED.REMOVE_ACTIVE:\n\t\t\treturn common.removeEditedActive(state, action);\n\t\tcase ActionTypes.VIEWS.EDITED.REMOVE_PROPERTY:\n\t\t\treturn common.removeEditedProperty(state, action);\n\t\tcase ActionTypes.VIEWS.EDITED.UPDATE:\n\t\t\treturn common.updateEdited(state, action);\n\t\tcase ActionTypes.VIEWS.INDEX.ADD:\n\t\t\treturn common.addIndex(state, action);\n\t\tcase ActionTypes.VIEWS.SET_ACTIVE_KEY:\n\t\t\treturn common.setActive(state, action);\n\t\tcase ActionTypes.VIEWS.UPDATE_STORE:\n\t\t\treturn common.updateStore(state, action);\n\t\tcase ActionTypes.VIEWS.USE.KEYS.REGISTER:\n\t\t\treturn common.useKeysRegister(state, action);\n\t\tcase ActionTypes.VIEWS.USE.KEYS.CLEAR:\n\t\t\treturn common.useKeysClear(state, action);\n\t\tcase ActionTypes.VIEWS.USE.INDEXED.REGISTER:\n\t\t\treturn common.registerUseIndexed(state, action);\n\t\tcase ActionTypes.VIEWS.USE.INDEXED.CLEAR:\n\t\t\treturn common.useIndexedClear(state, action);\n\t\tcase ActionTypes.VIEWS.USE.INDEXED.CLEAR_ALL:\n\t\t\treturn common.useIndexedClearAll(state, action);\n\t\tcase ActionTypes.VIEWS.INDEX.CLEAR_ALL:\n\t\t\treturn common.clearIndexes(state, action);\n\t\tcase ActionTypes.VIEWS.INDEX.CLEAR_INDEX:\n\t\t\treturn common.clearIndex(state, action);\n\t\tcase ActionTypes.VIEWS.MARK_DELETED:\n\t\t\treturn common.markDeleted(state, action);\n\t\tcase ActionTypes.COMMON.DATA.SET_OUTDATED:\n\t\t\treturn common.dataSetOutdated(state, action);\n\t\tcase ActionTypes.COMMON.DATA.CLEANUP_ON_LOGOUT:\n\t\t\treturn common.cleanupOnLogout(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import ActionTypes from '../../constants/ActionTypes';\nimport _ from 'lodash';\n\nconst INITIAL_STATE = {\n\twindows: {},\n\tsets: {},\n};\n\nconst INITIAL_SET_STATE = {\n\torderByHistory: [],\n};\n\nconst INITIAL_WINDOW_STATE = null; // opening/open/closing/closed\n\n// TODO handle sizes in rem\nconst INITIAL_WINDOW_SETTINGS = {\n\tminWidth: 100,\n\tminHeight: 200,\n\tmaxWidth: 500,\n\tmaxHeight: 500,\n\twidth: 200,\n\theight: 300,\n\tposition: {\n\t\ttop: 50,\n\t\tleft: 50,\n\t},\n};\n\nconst add = (state, action) => {\n\tlet windows = {...state.windows};\n\n\twindows[action.windowKey] = {\n\t\tkey: action.windowKey,\n\t\tdata: {\n\t\t\tstate: action.state ? action.state : INITIAL_WINDOW_STATE,\n\t\t\tsettings: {...INITIAL_WINDOW_SETTINGS, ...action.settings},\n\t\t\tcomponent: action.component,\n\t\t\tprops: action.props,\n\t\t},\n\t};\n\n\tlet sets = {...state.sets};\n\tsets[action.setKey] = {...INITIAL_SET_STATE, ...sets[action.setKey]};\n\tsets[action.setKey].orderByHistory = [\n\t\t...sets[action.setKey].orderByHistory,\n\t\taction.windowKey,\n\t];\n\n\treturn {...state, windows, sets};\n};\n\nconst open = (state, action) => {\n\tlet windows = {...state.windows};\n\n\twindows[action.windowKey] = {\n\t\tkey: action.windowKey,\n\t\tdata: {...windows[action.windowKey].data, state: 'open'},\n\t};\n\n\tlet sets = {...state.sets};\n\tsets[action.setKey] = {...INITIAL_SET_STATE, ...sets[action.setKey]};\n\tsets[action.setKey].orderByHistory = [\n\t\t...sets[action.setKey].orderByHistory,\n\t\taction.windowKey,\n\t];\n\n\treturn {...state, windows, sets};\n};\n\nconst remove = (state, action) => {\n\tlet sets = {...state.sets};\n\tif (_.isEmpty(sets) || _.isEmpty(sets[action.setKey]) || !action.windowKey) {\n\t\treturn state;\n\t}\n\tlet orderByHistory = _.without(\n\t\t[...sets[action.setKey].orderByHistory],\n\t\taction.windowKey\n\t);\n\n\tlet windows = {...state.windows};\n\tif (windows[action.windowKey]) {\n\t\twindows[action.windowKey] = {\n\t\t\tkey: action.windowKey,\n\t\t\tdata: {...windows[action.windowKey].data, state: 'close'},\n\t\t};\n\t}\n\n\treturn {\n\t\t...state,\n\t\twindows,\n\t\tsets: {...sets, [action.setKey]: {orderByHistory}},\n\t};\n};\n\nconst top = (state, action) => {\n\tlet sets = {...state.sets};\n\tlet orderByHistory = _.without(\n\t\t[...sets[action.setKey].orderByHistory],\n\t\taction.windowKey\n\t);\n\torderByHistory.push(action.windowKey);\n\n\treturn {\n\t\t...state,\n\t\tsets: {\n\t\t\t...sets,\n\t\t\t[action.setKey]: {\n\t\t\t\t...sets[action.setKey],\n\t\t\t\torderByHistory,\n\t\t\t},\n\t\t},\n\t};\n};\n\nconst update = (state, action) => {\n\tlet windows = {...state.windows};\n\twindows[action.windowKey] = {\n\t\tkey: action.windowKey,\n\t\tdata: {...windows[action.windowKey].data, ...action.data},\n\t};\n\n\treturn {...state, windows};\n};\n\nexport default (state = INITIAL_STATE, action) => {\n\tswitch (action.type) {\n\t\tcase ActionTypes.WINDOWS.ADD:\n\t\t\treturn add(state, action);\n\t\tcase ActionTypes.WINDOWS.OPEN:\n\t\t\treturn open(state, action);\n\t\tcase ActionTypes.WINDOWS.REMOVE:\n\t\t\treturn remove(state, action);\n\t\tcase ActionTypes.WINDOWS.SETS.ADD:\n\t\t// return addSet(state, action);\n\t\tcase ActionTypes.WINDOWS.TOP:\n\t\t\treturn top(state, action);\n\t\tcase ActionTypes.WINDOWS.UPDATE:\n\t\t\treturn update(state, action);\n\t\tdefault:\n\t\t\treturn state;\n\t}\n};\n","import {createStore, combineReducers, applyMiddleware, compose} from 'redux';\nimport thunk from 'redux-thunk';\nimport logger from 'redux-logger';\nimport {reduxBatch} from '@manaflair/redux-batch';\nimport {\n\tsetState as setRecomputeState,\n\tcreateSelector as createRecomputeSelector,\n\tcreateObserver as createRecomputeObserver,\n} from '@jvitela/recompute';\nimport {connect, Provider} from 'react-redux';\n\nimport connects from './components/connects';\nimport MountWrapper from './components/MountWrapper';\n\nimport commonActionTypes from './constants/ActionTypes';\nimport Action from './state/Action';\nimport Select from './state/Select';\n\nimport commonActions from './state/_common/actions';\nimport commonHelpers from './state/_common/helpers';\nimport commonReducers, {DEFAULT_INITIAL_STATE} from './state/_common/reducers';\nimport commonSelectors from './state/_common/selectors';\n\nimport activeMetadataActions from './state/_activeMetadata/actions';\nimport {STORES_TO_ENSURE_WITH_FILTER_BY_ACTIVE} from './state/_activeMetadata/constants';\n\nimport appReducers from './state/App/reducers';\nimport areasReducers from './state/Areas/reducers';\nimport areaRelationsReducers from './state/AreaRelations/reducers';\nimport attributesReducers from './state/Attributes/reducers';\nimport attributeSetsReducers from './state/AttributeSets/reducers';\nimport casesReducers from './state/Cases/reducers';\nimport componentsReducers from './state/Components/reducers';\nimport dataReducers from './state/Data/reducers';\nimport layerTemplatesReducers from './state/LayerTemplates/reducers';\nimport layerTreesReducers from './state/LayerTrees/reducers';\nimport mapsReducers from './state/Maps/reducers';\nimport periodsReducers from './state/Periods/reducers';\nimport placesReducers from './state/Places/reducers';\nimport scenariosReducers from './state/Scenarios/reducers';\nimport scopesReducers from './state/Scopes/reducers';\nimport screensReducers from './state/Screens/reducers';\nimport selectionsReducers from './state/Selections/reducers';\nimport stylesReducers from './state/Styles/reducers';\nimport tagsReducers from './state/Tags/reducers';\nimport usersReducers from './state/Users/reducers';\nimport viewsReducers from './state/Views/reducers';\nimport windowsReducers from './state/Windows/reducers';\n\nconst baseStores = {\n\tapp: appReducers,\n\tareas: areasReducers,\n\tareaRelations: areaRelationsReducers,\n\tattributes: attributesReducers,\n\tattributeSets: attributeSetsReducers,\n\tcases: casesReducers,\n\tcomponents: componentsReducers,\n\tdata: dataReducers,\n\tlayerTemplates: layerTemplatesReducers,\n\tlayerTrees: layerTreesReducers,\n\tmaps: mapsReducers,\n\tperiods: periodsReducers,\n\tplaces: placesReducers,\n\tscenarios: scenariosReducers,\n\tscopes: scopesReducers,\n\tscreens: screensReducers,\n\tselections: selectionsReducers,\n\tstyles: stylesReducers,\n\ttags: tagsReducers,\n\tusers: usersReducers,\n\tviews: viewsReducers,\n\twindows: windowsReducers,\n};\n\n/**\n * Helper function for creating redux store.\n * @param {Object} specificStores Object with speficic store/stores. Stores will by available in state under \"specific\" key.\n * @param {Array} rootStores Array of redux stores\n * @param {Array} middleware Array of redux middlewares.\n * @param {Object?} preloadedState Optional object used for store initialization as a default state.\n * @returns {Object} redux store instance\n */\nconst createBaseStore = (\n\tspecificStores,\n\trootStores = [],\n\tmiddleware = [],\n\tpreloadedState\n) => {\n\tconst enhancedThunk = thunk.withExtraArgument(activeMetadataActions);\n\n\tlet appliedMiddleware = applyMiddleware(enhancedThunk, ...middleware);\n\tif (process.env.NODE_ENV === 'development') {\n\t\tappliedMiddleware = applyMiddleware(enhancedThunk, logger, ...middleware);\n\t}\n\tlet stores = specificStores\n\t\t? {...baseStores, ...rootStores, specific: combineReducers(specificStores)}\n\t\t: {...baseStores, ...rootStores};\n\tif (preloadedState) {\n\t\treturn createStore(\n\t\t\tcombineReducers(stores),\n\t\t\tpreloadedState,\n\t\t\tcompose(reduxBatch, appliedMiddleware, reduxBatch)\n\t\t);\n\t} else {\n\t\treturn createStore(\n\t\t\tcombineReducers(stores),\n\t\t\tcompose(reduxBatch, appliedMiddleware, reduxBatch)\n\t\t);\n\t}\n};\n\nexport {\n\tcreateStore,\n\tcombineReducers,\n\tapplyMiddleware,\n\tcompose,\n\tconnect,\n\tProvider,\n\tMountWrapper,\n\tbaseStores,\n\tcreateBaseStore,\n\tconnects,\n\tcommonActionTypes,\n\tAction,\n\tSelect,\n\tcommonActions,\n\tcommonHelpers,\n\tcommonReducers,\n\tcommonSelectors,\n\tDEFAULT_INITIAL_STATE,\n\tactiveMetadataActions,\n\tSTORES_TO_ENSURE_WITH_FILTER_BY_ACTIVE,\n\tthunk,\n\tlogger,\n\treduxBatch,\n\tcreateRecomputeObserver,\n\tcreateRecomputeSelector,\n\tsetRecomputeState,\n};\n\n// TODO remove?\nexport default {\n\tcommonActionTypes,\n\tAction,\n\tSelect,\n\n\tcommonActions,\n\tcommonHelpers,\n\tcommonReducers,\n\tcommonSelectors,\n\n\tDEFAULT_INITIAL_STATE,\n};\n"],"names":["utils","deepKeyMirror","APP","SET_KEY","SET_BASE_URL","SET_LOCAL_CONFIGURATION","UPDATE_LOCAL_CONFIGURATION","RECEIVE_CONFIGURATION","AREAS","AREA_TREE_LEVELS","ADD","ADD_UNRECEIVED","ENSURE","ERROR","INDEX","CLEAR_ALL","LOAD","REQUEST","SET_ACTIVE_KEY","USE","INDEXED","CLEAR","REGISTER","KEYS","AREA_TREES","AREA_RELATIONS","ATTRIBUTES","DELETE","MARK_DELETED","EDITED","REMOVE","REMOVE_ACTIVE","REMOVE_PROPERTY","UPDATE","CLEAR_INDEX","SET_ACTIVE_KEYS","UPDATE_STORE","ATTRIBUTE_SETS","CASES","COMMON","DATA","CLEANUP_ON_LOGOUT","SET_OUTDATED","REMOVE_PROPERTY_VALUES","COMPONENTS","SET","ATTRIBUTE_DATA","ADD_WITH_INDEX","ADD_WITH_SPATIAL_INDEX","SPATIAL_INDEX","ATTRIBUTE_DATA_SOURCES","ATTRIBUTE_RELATIONS","COMPONENT","ATTRIBUTE_KEYS","ADD_COMPONENTS","SPATIAL_DATA","SPATIAL_DATA_SOURCES","SPATIAL_RELATIONS","LAYER_TEMPLATES","LAYER_TREES","MAPS","REMOVE_MAP","SET_ACTIVE_MAP_KEY","SET_BACKGROUND_LAYER","SET_LAYERS","VIEW","MAP","LAYERS","ADD_TO_INDEX","REMOVE_LAYER","SET_OPTION","SET_RENDER_AS","SET_STYLE","SET_STYLE_KEY","VIEWPORT","PERIODS","PLACES","SCENARIOS","SCOPES","SCREENS","CLOSE","OPEN","REMOVE_ALL","RETRACT","SETS","TOP_HISTORY","SELECTIONS","FEATURE_KEYS_FILTER","STYLES","TAGS","USERS","GROUPS","CURRENT","LOGIN","VIEWS","WINDOWS","TOP","TTL","DATAPATH","fetch","_fetch","request","localConfig","apiPath","method","query","payload","ttl","dataPath","_isUndefined","url","apiBackendProtocol","path","join","apiBackendHost","apiBackendPath","queryString","stringify","credentials","headers","Accept","body","JSON","then","response","contentType","get","ok","indexOf","json","_get","Error","error","getKey","state","app","key","getCompleteConfiguration","configuration","getCompleteLocalConfiguration","localConfiguration","getCompleteLocalConfigurationObserver","createRecomputeObserver","getConfiguration","createSelector","getLocalConfiguration","getIndex","createCachedSelector","indexes","filter","order","index","_find2","isCorrespondingIndex","getUniqueIndexes","_isEmpty2","reduce","uniqueIndexes","i","removeIndex","clearedIndexes","_reduce2","acc","indexToBeCleared","length","getUpdatedIndexes","indexUpdate","changedOn","indexesPath","selectedIndex","forEach","_isEqual2","push","model","Object","entries","level","dataByTiles","hasOwnProperty","getUpdatedByDataSourceKey","currentByDataSourceKey","update","updated","values","itemFitFilter","item","every","value","itemHasFilterKey","data","itemHasFilterLinkKey","_isObject2","includes","notin","mergeFilters","activeKeys","filterByActive","activeKeysFilter","application","activeApplicationKey","applicationKey","activeCaseKey","caseKey","activeCaseKeys","scope","activeScopeKey","scopeKey","scenario","activeScenarioKey","scenarioKey","activeScenarioKeys","place","activePlaceKey","placeKey","activePlaceKeys","period","activePeriodKey","periodKey","activePeriodKeys","attribute","activeAttributeKey","attributeKey","activeAttributeKeys","layerTemplate","activeLayerTemplateKey","layerTemplateKey","areaTreeLevel","activeAreaTreeLevelKey","areaTreeLevelKey","finalFilter","mergeMetadataKeys","definedKeys","convertModifiersToRequestFriendlyFormat","modifiers","modifiersForRequest","placeKeys","caseKeys","scenarioKeys","periodKeys","isNaturalNumber","input","_isNumber2","isInterval","interval","start","getValidIntervals","intervals","getSortedValidIntervals","_sortBy2","areIntervalsOverlappedOrSubsequent","earlier","later","mergeIntervals","sortedIntervals","_tail2","mergedIntervals","last","pop","end","Math","max","_head2","registerModelsToIndex","models","getActiveKey","getSubstate","activeKey","getActiveKeys","getAllByKey","byKey","getKeysInUse","inUse","keys","getIndexesInUse","getEditedAllAsObject","editedByKey","getIndexes","getIndexesByPath","indexPath","_get2","getAllNotRemovedAsObject","_pickBy2","getAllAsObject","getAll","getActive","getActiveModels","activeModels","map","getByKey","allData","getByKeysAsObject","_pick2","getByKeys","asObject","getDataByKey","getDeletePermissionByKey","permissions","activeUser","guest","getUpdatePermissionByKey","getEditedAll","editedAsObject","getEditedActive","getEditedByKey","getEditedDataByKey","getEditedKeys","edited","commonHelpers","getIndexByPath","getIndexChangedOn","getIndexPage","indexed","o","count","getIndexed","getAllActiveKeys","mergedFilter","indexedModels","min","modelKey","indexedModel","getIndexTotal","getIndexesByFilteredItem","getKeysToLoad","filteredKeys","outdated","getUsedKeysForComponent","componentKey","usedKeys","haveAllKeysRegisteredUse","notIncluded","_difference2","getUsedIndexPages","indexedDataUses","groupedUses","finalUsedIndexes","usedIndexes","usedIndex","existingIndex","use","groupedUse","uses","getUsedIndexPage","usedIndexPages","stringOrder","stringFilter","_map2","sort","getUsesWithActiveDependency","componentUsedIndexes","accumulator","getStateToSave","scopes","cases","scenarios","places","periods","attributes","layerTemplates","areas","areaTreeLevels","specific","apps","appKey","getActiveKeysByFilterByActive","attributeKeys","getActiveKeysByFilterByActiveObserver","getIndexesObserver","getIndex_recompute","createRecomputeSelector","getMergedModifiers_recompute","metadataModifiers","metadataDefinedByKey","activeMetadataKeys","getMergedModifiersInRequestFormat_recompute","mergedMetadataKeys","getCommmonDataRelationsFilterFromComponentState_recompute","componentState","relationsFilter","common","areaTrees","areaRelations","getAllData","relations","_map","relation","getFilteredData","_isEmpty","_filter","getFilteredDataSourceKeysGroupedByLayerKey","layers","filteredGroupedByLayerKey","layer","filteredRelations","spatialDataSourceKey","fidColumnName","attributeSets","components","getAllByKeyObserver","getByComponentKey","getByComponentKey_recompute","serialize","args","recomputeSelectorOptions","attributeRelations","getByKeyObserver","_filter2","getFilteredAttributeDataSourceKeyAttributeKeyPairs","pairs","attributeDataSourceKey","attributeDataSources","dataSources","dataSource","attributeData","getAllAsObjectObserver","byDataSourceKey","getSpatialIndexesObserver","spatialIndexes","getByDataSourceKeyObserver","getSpatialIndex_recompute","getDataByDataSourceKeys","dataSourceKeys","getAttributesByDataSourceKeysForFeatureKey","attributeDataSourceKeyAttributeKeyPairs","featureKey","dataByDataSourceKey","dataSourceData","dataSourceKey","getSpatiallyIndexedFeatureKeysByDataSourceKeys","tile","spatialIndex","featureKeysByDataSourceKeys","isTileLoading","tileIndex","getAllComponentsInUse","getComponentStateByKey","getComponentStateByKeyObserver","isComponentInUse","componentsInUse","_includes2","componentMatchesFilterByActive","_isMatch2","getAttributeDataFilterExtensionByComponentKey","attributeFilter","featureKeys","spatialFilter","undefined","getCommonFilterByComponentKey","commonSelectors","getIndexForAttributeDataByComponentKey","attributeOrder","attributeDataFilterExtension","commonFilter","attributeDataFilter","attributeDataIndex","attributeDataSelectors","getData","attributeRelationsSelectors","attributeDsKeyAttributeKeyPairs","indexedFeatureKeysAsObject","finalFeaturesAsObject","attributeDsKey","isNaN","Number","getDataForCartesianChart","props","componentSettings","componentsSelectors","stateComponentKey","chartSettings","spatialRelations","spatialDataSources","getIndexed_recompute","filteredDataSources","spatialData","getIndexedFeatureKeys","loading","precision","number","isFinite","e","p","round","getNumberInDecimalString","numberPrecision","toFixed","tileAsStringArray","_isArray2","arrTile","tileAsArray","tileAsString","stringTile","split","_isFinite2","parseFloat","getMissingTiles","tiles","loadedTilesInIndex","tileData","tileKey","missingTiles","getPageSize","PAGE_SIZE","requestPageSize","configDefaults","tilesCache","CacheFifo","getFeatures","attributesByDataSourceKey","feature","properties","features","attributeValue","type","geometry","getTile","spatialRelationsFilter","attributeRelationsFilter","styleKey","spatialDataForDataSource","tileString","cacheParams","indexedFeatureKeys","indexedFeatureKeysByAttributeDataSourceKeys","cacheKey","cache","findByKey","geometries","addOrUpdate","getTiles","populatedTiles","populatedTile","layerTrees","getBackgroundLayerAsLayer","backgroundLayer","mergeBackgroundLayerWithLayers","finalLayers","mergeModifiersAndFilterByActiveToLayerStructure","layerMetadataModifiers","layerFilterByActive","getView","set","mapView","view","sync","_omitBy","viewValue","viewKey","mapSetView","mapUtils","mergeViews","mapConstants","defaultMapView","getZoomLevel","mapWidth","mapHeight","boxRange","viewportRange","getMapViewportRange","levelBoxRange","getNearestZoomLevelBoxRange","grid","getLevelByViewport","center","tileGrid","getTileGrid","flat","lon","lat","styles","getDefinitionByKey","style","definition","selections","getAllAsObjectWithStyles","StyleSelectors","allStyles","selectionsWithStyles","selection","selectionStyle","rules","prepareSelectionByLayerStateSelected","layerStateSelected","populatedSelections","selectionData","hoveredStyle","color","hoveredColor","featureKeysFilter","outlineColor","outlineWidth","maps","getAllMapSetsInUse","sets","getAllMapsInUse","getActiveMapKey","activeMapKey","getMapsAsObject","getMapSetsAsObject","getActiveMap","isMapSetInUse","mapSetKey","mapSetsInUse","isMapInUse","mapKey","mapsInUse","getMapByKey","getMapSets","getAllMapSetsMaps","mapSets","_flatten2","mapSet","getMapSetByKey","getMapSetByMapKey","getMapSetActiveMapKey","mapKeyInSet","getMapSetActiveMapView","selectorHelpers","setKey","getViewByMapKey","getViewByMapKeyObserver","getViewportByMapKey","viewport","getViewportByMapKeyObserver","getViewLimitsByMapKey","mapViewLimits","viewLimits","mapSetViewLimits","getMapSetMapKeys","getMapSetMaps","mapKeys","getMapSetView","getMapSetViewLimits","getMapBackgroundLayerStateByMapKey","getMapLayersStateByMapKey","getMapLayerStateByMapKeyAndLayerKey","layerKey","find","getMapSetBackgroundLayerStateByMapKey","getMapSetLayersStateByMapKey","getMapMetadataModifiersByMapKey","getMapSetMetadataModifiersByMapKey","getMetadataModifiersByMapKey","mapModifiers","setModifiers","getMapFilterByActiveByMapKey","getMapSetFilterByActiveByMapKey","getFilterByActiveByMapKey","mapFilter","setFilter","getBackgroundLayerStateByMapKey","mapBackgroundLayer","setBackgroundLayer","getBackgroundLayerStateByMapKeyObserver","getMapSetLayersStateWithModifiersByMapKey","setLayers","mapSetFilterByActive","getMapLayersStateWithModifiersByMapKey","mapLayers","mapFilterByActive","getLayersStateByMapKey","getLayersStateByMapKeyObserver","getLayerStateByLayerKeyAndMapKey","getAllLayersStateByMapKey","getSpatialRelationsFilterFromLayerState","layerState","getVisibleTilesByMapKey","helpers","getAttributeDataFilterFromLayerState","options","getAttributeRelationsFilterFromLayerState","getFinalLayerByDataSourceAndLayerState","spatialDataSource","attribution","nameInternal","geometryColumnName","dataSourceOptions","name","opacity","crs","layerStateOptions","urls","params","rest","singleTile","charAt","AppSelectors","slice","DataSelectors","tileList","width","height","selected","SelectionsSelectors","StylesSelectors","getMapBackgroundLayer","_compact2","dataSourceType","getMapLayers","layersState","getAsObjectByFullPeriod","limitStart","limitEnd","selectedPeriods","periodStart","periodEnd","moment","isBetween","getActiveScopeConfiguration","getAllScreensAsObject","screens","getAllSetsAsObject","getSetByKey","getScreensBySetKey","setScreens","orderBySpace","lineage","getSetKeyByScreenLineage","screenLineage","_includes","orderByHistory","getScreenByLineage","tags","DEFAULT_CATEGORY","users","getGroupsSubstate","groups","getGroups","isLoggedIn","isAdmin","getById","userId","user","id","isAdminGroupMember","getActiveUserPermissions","isAdminOrAdminGroupMember","getGroupKeysForActiveUser","hasActiveUserPermissionToCreate","category","create","isDromasAdmin","currentUser","group","getActiveUserDromasLpisChangeReviewGroup","ScopeSelectors","activeUserGroupKeys","activeScopeConfiguration","dromasLpisChangeReview","gisatAdmins","szifAdmins","gisatUsers","szifUsers","getActiveUser","getGroupsForActiveUser","getUsers","views","attributesSelectors","attributeSetsSelectors","scopesSelectors","windows","getAllWindowsAsObject","getWindow","getWindowsBySetKeyAsObject","setWindows","isOpen","window","App","Areas","AreaRelations","Attributes","AttributeSets","Cases","Components","Data","LayerTemplates","LayerTrees","Maps","Periods","Places","Scenarios","Scopes","Screens","Selections","Styles","Tags","Users","Views","Windows","DEFAULT_CATEGORY_PATH","apiDelete","dataType","categoryPath","dispatch","getState","Select","result","errors","actionGeneralError","itemsDeleted","console","warn","apiUpdate","actionTypes","editedData","receiveUpdated","updateEdited","originalModel","_isEqual","actionRemovePropertyFromEdited","actionUpdateEdited","updateStore","actionUpdateStore","removePropertyFromEdited","deleteItem","deletedKeys","d","deleteDate","Date","toISOString","utc","format","actionMarkAsDeleted","actionRemovePropertyValuesFromAllEdited","actionClearIndex","refreshIndex","saveEdited","saved","useKeys","componentId","isRegistered","actionUseKeysRegister","ensureKeys","useIndexed","actionUseIndexedRegister","fullFilter","ensureIndexed","usesForIndex","receiveIndexed","actionAdd","actionAddIndex","total","changes","requestWrapper","successAction","errorAction","currentAppKey","getCreatePayload","items","concat","keysToLoad","promises","_chunk","keysToLoadPage","loadKeysPage","Promise","all","indexPage","pages","page","loadedKeys","v","completeFilter","loadIndexedPage","err","message","success","getAPIPath","receiveKeys","offset","limit","isAfter","originalData","original","_isObject","_isArray","_find","actionAddUnreceivedKeys","refreshUses","actionClearIndexes","_flatMap","usedIndexPage","ensureIndexesWithFilterByActive","updateSubstateFromView","actionSetActiveKey","actionSetActiveKeys","actionDataSetOutdated","ActionTypes","creator","action","pathSegment","date","property","actionUseIndexedClear","actionUseIndexedClearAll","actionUseKeysClear","datatype","uuid","add","addIndex","ensure","setActiveKey","setActiveKeys","useKeysClear","clearIndex","useIndexedRegister","useIndexedClear","useIndexedClearAll","loadConfiguration","selectors","configurations","commonActions","actionReceiveConfiguration","actionSetKey","actionSetBaseUrl","actionSetLocalConfiguration","actionUpdateLocalConfiguration","updateLocalConfiguration","setBaseUrl","setLocalConfiguration","setActiveKeyAndEnsureDependencies","ensureDependenciesOfActiveMetadataType","actionClearUseIndexed","updateStateFromView","setActiveKeysAndEnsureDependencies","component","actionUpdate","actionSet","addLoadingIndex","pagination","Array","fill","receiveIndexedWithSpatialIndex","spatialIndexData","addDataAndIndexBasedOnSpatialData","createAndAddIndexBasedOnSpatialData","actionAddDataAndIndex","actionAddDataAndIndexBasedOnSpatialData","actionAddIndexWithSpatialIndex","addLoadingSpatialIndex","loadingTiles","tileId","getIndexDataBySpatialData","indexByLevelByTileByDataSourceKey","datasource","attributeDataSource","toString","actionRemoveSpatialIndex","indexData","removeSpatialIndex","getRestPages","optStart","optLength","wanted","startIndex","endIndex","lastPageIndex","ceil","_","getPagination","pageIndex","pageSize","optCount","getNullishPagination","getLoadedPages","dataIndex","loadedPages","itemsOnPage","requestedDataIndexes","hasPage","getMissingPages","optDataIndex","restPages","missingPages","DEFAULT_PAGE_PAGINATION","addComponentsFromView","actionAddOrReplaceComponents","updateComponent","_merge2","ensureDataAndRelations","loadRelations","loadData","attributePagination","relationsPagination","setState","RELATIONS_PAGE_SIZE","attributeRelationsIndex","missingAttributesPages","missingRelationsPages","loadMissingRelationsAndData","remainingRelationsPages","remainingAttributeDataPages","attributeCount","ensureWithFilterByActive","fitsFilterByActive","componentUseRegister","componentUseClear","registered","actionComponentUseClear","alreadyRegistered","actionComponentUseRegister","getPayload","attributeDataPagination","processResult","relationsOrder","relationsLimit","attributeRelationsDataSources","usedRelationsPagination","usedAttributeDataPagination","actionSetAttributeKeys","setAttributeKeys","addDataAndIndex","spatialDataAndIndexByDataSourceKey","getIndexData","spatialDataByDataSourceKey","dsKey","actionRemoveIndex","TILED_VECTOR_LAYER_TYPES","DEFAULT_RELATIONS_PAGE","getRestRelationsPages","attributeRelationsCount","spatialRelationsCount","maxCountValue","remainingPageCount","loadGeometry","preloadedSpatialDataSources","remainingRelationsPageCount","tilesPagination","loadAttributeRelations","loadSpatialRelations","remainingTilesPageCount","loadRestTilesRelations","spatialDataSourcesTypes","_flattenDeep2","r","spatialAttributeRelationsDataSources","sds","spatialDataSourcesPairs","allSourcesAreUnsupported","ds","resolve","loadMissingAttributeData","missingAttributeDataTiles","loadAttributeRelationsAndDS","spatialFilterWithMissingTiles","preloadSpatialDataSources","loadMissingSpatialData","spatialDataIndex","missingSpatialDataTiles","setLoading","restRelationsPages","hasMissingAttributesData","hasMissingSpatialData","hasSpatialOrAreaRelations","spatialRelationsIndex","areaRelationsIndex","commonRelationsFilter","missingAttributesData","missingSpatialData","filterHasSpatialOrAreaRelations","loadRelationsAndData","modifiedSpatialFilterForAttributes","modifiedSpatialFilterForSpatial","missingAttributeDataTilesToLoad","missingSpatialAndAttributeDataTiles","_intersection2","composeDataEndpointPayload","spatial","loadingTilesGeometry","spatialTilesInNotLoadingState","attributesTilesInNotLoadingState","usedRelations","ensureData","updateStateFromViewWithData","setActiveSelectionFeatureKeysFilterKeys","selectionKeys","activeSelectionKey","setFeatureKeysFilterKeys","clearFeatureKeysFilter","addMapLayers","layerStates","actionAddMapLayers","addMapLayerToIndex","actionAddMapLayerToIndex","removeMapLayer","actionRemoveMapLayer","mapSetUseClear","actionMapSetUseClear","mapSetUseRegister","actionMapSetUseRegister","mapUseClear","actionMapUseClear","mapUseRegister","actionMapUseRegister","setTimeout","layerUse","sdsContainsVector","some","StylesActions","DataActions","mapViewport","setLayerSelectedFeatureKeys","selectedFeatureKeys","selectable","SelectionsAction","setMapLayerStyleKey","actionSetMapLayerStyleKey","setMapLayerOption","optionKey","optionValue","actionSetMapLayerOption","setMapSetActiveMapKey","actionSetMapSetActiveMapKey","setMapSetBackgroundLayer","actionSetMapSetBackgroundLayer","setMapBackgroundLayer","actionSetMapBackgroundLayer","backgroundLayerState","setMapSetLayers","actionSetMapSetLayers","refreshMapSetUse","removeMapFromSet","mapSetMapKeys","actionRemoveMapFromSet","updateMapAndSetView","forSet","forMap","updateVal","updateKey","_omitBy2","ensureViewIntegrity","actionUpdateSetView","actionUpdateMapView","updateSetView","setMapViewport","existingMap","currentViewport","actionSetMapViewport","actionSetActiveMapKey","setActiveMapKey","_values","timeouts","minActiveWidth","existingScreen","clearTimeout","desiredState","open","ensureSet","existingSet","actionAddSet","actionOpen","actionTopHistory","close","actionClose","actionRemove","removeAllScreensFromSet","actionRemoveAllScreensFromSet","retract","actionRetract","topHistory","addSet","useIndexedUsers","useIndexedGroups","onLogin","apiLoadCurrentUser","ScopesAction","PlacesAction","PeriodsAction","onLogout","actionLogout","apiLoginUser","email","password","actionApiLoginRequest","username","status","actionApiLoadCurrentUserRequest","actionAddGroups","transformGroups","transformUser","apiLogoutUser","actionApiLogoutRequest","log","actionApiLogoutRequestError","actionClearUsersUseIndexed","actionClearGroupsUseIndexed","USERS_LOGOUT_REQUEST","USERS_LOGOUT_REQUEST_ERROR","useIndexedUsersClear","useIndexedGroupsClear","apply","actions","actionCreators","storeActions","applyAndSetActive","addOrOpen","windowKey","settings","existingWindow","updateSettings","updatedData","actionTopWindow","remove","topWindow","mapStateToProps","loginOverlayOpen","mapDispatchToProps","onLogIn","Action","onLoginOverlayClose","connect","ownProps","mapDispatchToPropsFactory","onMount","onUnmount","stateMapKey","randomString","onResize","refreshUse","onViewChange","onPropViewChange","resetHeading","onClick","onLayerClick","stateMapSetKey","activeMapView","activeMapViewport","updateView","onMapRemove","onFocusScreen","onCloseScreen","onOpenScreen","onRetractScreen","login","logout","onWindowClick","onWindowClose","onWindowDragStart","onWindowDragStop","position","onWindowResize","AppContainer","CartesianChart","Map","MapSet","User","WindowsContainer","mountWrapper","Component","React","PureComponent","DEFAULT_INITIAL_STATE","lastChangedOn","loadingKeys","newData","unreceived","addUnreceivedKeys","updatedIndexes","indexOfIndex","_findIndex2","updatedIndex","updatedIndexIndex","registerUseIndexed","newUse","existingUse","useKeysRegister","_union2","markDeleted","removed","updatedByKey","_omit2","removeEdited","updatedEditedByKey","removeEditedActive","removeEditedProperty","editedModel","editedModelData","restProps","editedModels","setActive","setActiveMultiple","newEditedData","clearIndexes","outdatedCount","correspondIndex","dataSetOutdated","cleanupOnLogout","STORES_TO_ENSURE_WITH_FILTER_BY_ACTIVE","filterKey","DataComponentsActions","MapsActions","INITIAL_STATE","baseUrl","setHelper","remainingPath","currentKey","shift","receiveConfiguration","combineReducers","pathParams","addWithSpatialIndex","addWithIndex","val","addIndexAction","stateWithUpdatedIndexes","addSpatialIndex","_indexOf2","updatedInUse","stateManagement","removeItemByIndex","setComponentAttributeKeys","addOrReplaceComponents","componentsByKey","getEmptyFeature","updatedDataForDataSourceKey","getUpdatedDataForDataSourceKey","updatedByDataSourceKey","featuresAsObject","dataFeaturesKeys","newFeature","newFeatures","existingFeature","activeSetKey","updatedMaps","updatedLayers","currentLayers","addItemToIndex","setSetActiveMapKey","setSetBackgroundLayer","setSetLayers","updateMapView","updates","tasksReducer","INITIAL_SET_STATE","INITIAL_SCREEN_DATA","_without","alreadyInOrder","loadRequest","loadRequestError","USERS_LOAD_REQUEST","USERS_LOAD_REQUEST_ERROR","USERS_UPDATE","INITIAL_WINDOW_STATE","INITIAL_WINDOW_SETTINGS","minWidth","minHeight","maxWidth","maxHeight","top","left","baseStores","appReducers","areasReducers","areaRelationsReducers","attributesReducers","attributeSetsReducers","casesReducers","componentsReducers","dataReducers","layerTemplatesReducers","layerTreesReducers","mapsReducers","periodsReducers","placesReducers","scenariosReducers","scopesReducers","screensReducers","selectionsReducers","stylesReducers","tagsReducers","usersReducers","viewsReducers","windowsReducers","createBaseStore","specificStores","rootStores","middleware","preloadedState","enhancedThunk","thunk","withExtraArgument","activeMetadataActions","appliedMiddleware","applyMiddleware","process","env","NODE_ENV","logger","stores","createStore","compose","reduxBatch","commonActionTypes","commonReducers"],"mappings":"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"}